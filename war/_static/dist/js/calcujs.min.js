/*!jQuery Knob*/
(function(d){var b={},a=Math.max,c=Math.min;b.c={};b.c.d=d(document);b.c.t=function(f){return f.originalEvent.touches.length-1};b.o=function(){var e=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.w=0;this.h=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.scale=1;this.relative=false;this.relativeWidth=false;this.relativeHeight=false;this.$div=null;this.run=function(){var f=function(j,h){var g;for(g in h){e.o[g]=h[g]}e.init();e._configure()._draw()};if(this.$.data("kontroled")){return}this.$.data("kontroled",true);this.extend();this.o=d.extend({min:this.$.data("min")||0,max:this.$.data("max")||100,stopper:true,readOnly:this.$.data("readonly")||(this.$.attr("readonly")=="readonly"),cursor:(this.$.data("cursor")===true&&30)||this.$.data("cursor")||0,thickness:(this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),0.01))||0.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:false,step:this.$.data("step")||1,draw:null,change:null,cancel:null,release:null,error:null},this.o);if(!this.o.inputColor){this.o.inputColor=this.o.fgColor}if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(g){var h=d(this);e.i[g]=h;e.v[g]=h.val();h.bind("change keyup",function(){var j={};j[g]=h.val();e.val(j)})});this.$.find("legend").remove()}else{this.i=this.$;this.v=this.$.val();(this.v=="")&&(this.v=this.o.min);this.$.bind("change keyup",function(){e.val(e._validate(e.$.val()))})}(!this.o.displayInput)&&this.$.hide();this.$c=d(document.createElement("canvas"));if(typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(this.$c[0])}this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c){this.o.error&&this.o.error();return}this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=((this.o.width%1!==0)&&this.o.width.indexOf("%"));this.relativeHeight=((this.o.height%1!==0)&&this.o.height.indexOf("%"));this.relative=(this.relativeWidth||this.relativeHeight);this.$div=d('<div style="'+(this.o.inline?"display:inline;":"")+'"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();this._carve();if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind("configure",f).parent().bind("configure",f);this._listen()._configure()._xy().init();this.isInit=true;this._draw();return this};this._carve=function(){if(this.relative){var f=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),g=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(f,g)}else{this.w=this.o.width;this.h=this.o.height}this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});if(this.scale!==1){this.$c[0].width=this.$c[0].width*this.scale;this.$c[0].height=this.$c[0].height*this.scale;this.$c.width(this.w);this.$c.height(this.h)}return this};this._draw=function(){var f=true;e.g=e.c;e.clear();e.dH&&(f=e.dH());(f!==false)&&e.draw()};this._touch=function(f){var g=function(j){var h=e.xy2val(j.originalEvent.touches[e.t].pageX,j.originalEvent.touches[e.t].pageY);e.change(e._validate(h));e._draw()};this.t=b.c.t(f);g(f);b.c.d.bind("touchmove.k",g).bind("touchend.k",function(){b.c.d.unbind("touchmove.k touchend.k");if(e.rH&&(e.rH(e.cv)===false)){return}e.val(e.cv)});return this};this._mouse=function(g){var f=function(j){var h=e.xy2val(j.pageX,j.pageY);e.change(e._validate(h));e._draw()};f(g);b.c.d.bind("mousemove.k",f).bind("keyup.k",function(h){if(h.keyCode===27){b.c.d.unbind("mouseup.k mousemove.k keyup.k");if(e.eH&&(e.eH()===false)){return}e.cancel()}}).bind("mouseup.k",function(h){b.c.d.unbind("mousemove.k mouseup.k keyup.k");if(e.rH&&(e.rH(e.cv)===false)){return}e.val(e.cv)});return this};this._xy=function(){var f=this.$c.offset();this.x=f.left;this.y=f.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(f){f.preventDefault();e._xy()._mouse(f)}).bind("touchstart",function(f){f.preventDefault();e._xy()._touch(f)});this.listen()}else{this.$.attr("readonly","readonly")}if(this.relative){d(window).resize(function(){e._carve().init();e._draw()})}return this};this._configure=function(){if(this.o.draw){this.dH=this.o.draw}if(this.o.change){this.cH=this.o.change}if(this.o.cancel){this.eH=this.o.cancel}if(this.o.release){this.rH=this.o.release}if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(f){return(~~(((f<0)?-0.5:0.5)+(f/this.o.step)))*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(f){};this.val=function(f){};this.xy2val=function(f,g){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(j,f){var g;j=j.substring(1,7);g=[parseInt(j.substring(0,2),16),parseInt(j.substring(2,4),16),parseInt(j.substring(4,6),16)];return"rgba("+g[0]+","+g[1]+","+g[2]+","+f+")"};this.copy=function(j,h){for(var g in j){h[g]=j[g]}}};b.Dial=function(){b.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=d.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:true},this.o)};this.val=function(e){if(null!=e){this.cv=this.o.stopper?a(c(e,this.o.max),this.o.min):e;this.v=this.cv;this.$.val(this.v);this._draw()}else{return this.v}};this.xy2val=function(e,h){var f,g;f=Math.atan2(e-(this.x+this.w2),-(h-this.y-this.w2))-this.angleOffset;if(this.angleArc!=this.PI2&&(f<0)&&(f>-0.5)){f=0}else{if(f<0){f+=this.PI2}}g=~~(0.5+(f*(this.o.max-this.o.min)/this.angleArc))+this.o.min;this.o.stopper&&(g=a(c(g,this.o.max),this.o.min));return g};this.listen=function(){var h=this,g,f,n=function(r){r.preventDefault();var q=r.originalEvent,o=q.detail||q.wheelDeltaX,m=q.detail||q.wheelDeltaY,p=h._validate(h.$.val())+(o>0||m>0?h.o.step:o<0||m<0?-h.o.step:0);p=a(c(p,h.o.max),h.o.min);h.val(p);if(h.rH){clearTimeout(g);g=setTimeout(function(){h.rH(p);g=null},100);if(!f){f=setTimeout(function(){if(g){h.rH(p)}f=null},200)}}},k,l,e=1,j={37:-h.o.step,38:h.o.step,39:h.o.step,40:-h.o.step};this.$.bind("keydown",function(p){var o=p.keyCode;if(o>=96&&o<=105){o=p.keyCode=o-48}k=parseInt(String.fromCharCode(o));if(isNaN(k)){(o!==13)&&(o!==8)&&(o!==9)&&(o!==189)&&p.preventDefault();if(d.inArray(o,[37,38,39,40])>-1){p.preventDefault();var m=parseInt(h.$.val())+j[o]*e;h.o.stopper&&(m=a(c(m,h.o.max),h.o.min));h.change(m);h._draw();l=window.setTimeout(function(){e*=2},30)}}}).bind("keyup",function(m){if(isNaN(k)){if(l){window.clearTimeout(l);l=null;e=1;h.val(h.$.val())}}else{(h.$.val()>h.o.max&&h.$.val(h.o.max))||(h.$.val()<h.o.min&&h.$.val(h.o.min))}});this.$c.bind("mousewheel DOMMouseScroll",n);this.$.bind("mousewheel DOMMouseScroll",n)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max){this.v=this.o.min}this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=a(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:((this.w/2+4)>>0)+"px",height:((this.w/3)>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":((this.w/3)>>0)+"px","margin-left":"-"+((this.w*3/4+2)>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+((this.w/e)>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(e){if(e==this.cv){return}this.cv=e;if(this.cH&&(this.cH(e)===false)){return}};this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.draw=function(){var l=this.g,f=this.angle(this.cv),g=this.startAngle,h=g+f,e,j,k=1;l.lineWidth=this.lineWidth;l.lineCap=this.lineCap;this.o.cursor&&(g=h-this.cursorExt)&&(h=h+this.cursorExt);l.beginPath();l.strokeStyle=this.o.bgColor;l.arc(this.xy,this.xy,this.radius,this.endAngle-0.00001,this.startAngle+0.00001,true);l.stroke();if(this.o.displayPrevious){j=this.startAngle+this.angle(this.v);e=this.startAngle;this.o.cursor&&(e=j-this.cursorExt)&&(j=j+this.cursorExt);l.beginPath();l.strokeStyle=this.pColor;l.arc(this.xy,this.xy,this.radius,e-0.00001,j+0.00001,false);l.stroke();k=(this.cv==this.v)}l.beginPath();l.strokeStyle=k?this.o.fgColor:this.fgColor;l.arc(this.xy,this.xy,this.radius,g-0.00001,h+0.00001,false);l.stroke()};this.cancel=function(){this.val(this.v)}};d.fn.dial=d.fn.knob=function(e){return this.each(function(){var f=new b.Dial();f.o=e;f.$=d(this);f.run()}).parent()}})(jQuery);(function(e){var d=new Array;var f=new Array;e.fn.doAutosize=function(w){var v=e(this).data("minwidth"),u=e(this).data("maxwidth"),s="",r=e(this),q=e("#"+e(this).data("tester_id"));if(s===(s=r.val())){return}var p=s.replace(/&/g,"&").replace(/\s/g," ").replace(/</g,"<").replace(/>/g,">");q.html(p);var o=q.width(),n=o+w.comfortZone>=v?o+w.comfortZone:v,m=r.width(),a=n<m&&n>=v||n>v&&n<u;if(a){r.width(n)}};e.fn.resetAutosize=function(a){var o=e(this).data("minwidth")||a.minInputWidth||e(this).width(),n=e(this).data("maxwidth")||a.maxInputWidth||e(this).closest(".tagsinput").width()-a.inputPadding,m="",l=e(this),k=e("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:l.css("fontSize"),fontFamily:l.css("fontFamily"),fontWeight:l.css("fontWeight"),letterSpacing:l.css("letterSpacing"),whiteSpace:"nowrap"}),j=e(this).attr("id")+"_autosize_tester";if(!e("#"+j).length>0){k.attr("id",j);k.appendTo("body")}l.data("minwidth",o);l.data("maxwidth",n);l.data("tester_id",j);l.css("width",o)};e.fn.addTag=function(b,a){a=jQuery.extend({focus:false,callback:true},a);this.each(function(){var n=e(this).attr("id");var m=e(this).val().split(d[n]);if(m[0]==""){m=new Array}b=jQuery.trim(b);if(a.unique){var l=e(m).tagExist(b);if(l==true){e("#"+n+"_tag").addClass("not_valid")}}else{var l=false}if(b!=""&&l!=true){e("<span>").addClass("tag").append(e("<span>").text(b).append("  "),e("<a>",{href:"#",title:"Removing tag",text:""}).click(function(){return e("#"+n).removeTag(escape(b))})).insertBefore("#"+n+"_addTag");m.push(b);e("#"+n+"_tag").val("");if(a.focus){e("#"+n+"_tag").focus()}else{e("#"+n+"_tag").blur()}e.fn.tagsInput.updateTagsField(this,m);if(a.callback&&f[n]&&f[n]["onAddTag"]){var k=f[n]["onAddTag"];k.call(this,b)}if(f[n]&&f[n]["onChange"]){var c=m.length;var k=f[n]["onChange"];k.call(this,e(this),m[c-1])}}});return false};e.fn.removeTag=function(a){a=unescape(a);this.each(function(){var h=e(this).attr("id");var c=e(this).val().split(d[h]);e("#"+h+"_tagsinput .tag").remove();str="";for(i=0;i<c.length;i++){if(c[i]!=a){str=str+d[h]+c[i]}}e.fn.tagsInput.importTags(this,str);if(f[h]&&f[h]["onRemoveTag"]){var b=f[h]["onRemoveTag"];b.call(this,a)}});return false};e.fn.tagExist=function(a){return jQuery.inArray(a,e(this))>=0};e.fn.importTags=function(a){id=e(this).attr("id");e("#"+id+"_tagsinput .tag").remove();e.fn.tagsInput.importTags(this,a)};e.fn.tagsInput=function(b){var a=jQuery.extend({interactive:true,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2},b);this.each(function(){if(a.hide){e(this).hide()}var j=e(this).attr("id");if(!j||d[e(this).attr("id")]){j=e(this).attr("id","tags"+(new Date).getTime()).attr("id")}var h=jQuery.extend({pid:j,real_input:"#"+j,holder:"#"+j+"_tagsinput",input_wrapper:"#"+j+"_addTag",fake_input:"#"+j+"_tag"},a);d[j]=h.delimiter;if(a.onAddTag||a.onRemoveTag||a.onChange){f[j]=new Array;f[j]["onAddTag"]=a.onAddTag;f[j]["onRemoveTag"]=a.onRemoveTag;f[j]["onChange"]=a.onChange}var c='<div id="'+j+'_tagsinput" class="tagsinput"><div id="'+j+'_addTag">';if(a.interactive){c=c+'<input id="'+j+'_tag" value="" data-default="'+a.defaultText+'" />'}c=c+'</div><div class="tags_clear"></div></div>';e(c).insertAfter(this);e(h.holder).css("width",a.width);e(h.holder).css("height",a.height);if(e(h.real_input).val()!=""){e.fn.tagsInput.importTags(e(h.real_input),e(h.real_input).val())}if(a.interactive){e(h.fake_input).val(e(h.fake_input).attr("data-default"));e(h.fake_input).css("color",a.placeholderColor);e(h.fake_input).resetAutosize(a);e(h.holder).bind("click",h,function(g){e(g.data.fake_input).focus()});e(h.fake_input).bind("focus",h,function(g){if(e(g.data.fake_input).val()==e(g.data.fake_input).attr("data-default")){e(g.data.fake_input).val("")}e(g.data.fake_input).css("color","#000000")});if(a.autocomplete_url!=undefined){autocomplete_options={source:a.autocomplete_url};for(attrname in a.autocomplete){autocomplete_options[attrname]=a.autocomplete[attrname]}if(jQuery.Autocompleter!==undefined){e(h.fake_input).autocomplete(a.autocomplete_url,a.autocomplete);e(h.fake_input).bind("result",h,function(g,l,k){if(l){e("#"+j).addTag(l[0]+"",{focus:true,unique:a.unique})}})}else{if(jQuery.ui.autocomplete!==undefined){e(h.fake_input).autocomplete(autocomplete_options);e(h.fake_input).bind("autocompleteselect",h,function(g,k){e(g.data.real_input).addTag(k.item.value,{focus:true,unique:a.unique});return false})}}}else{e(h.fake_input).bind("blur",h,function(g){var k=e(this).attr("data-default");if(e(g.data.fake_input).val()!=""&&e(g.data.fake_input).val()!=k){if(g.data.minChars<=e(g.data.fake_input).val().length&&(!g.data.maxChars||g.data.maxChars>=e(g.data.fake_input).val().length)){e(g.data.real_input).addTag(e(g.data.fake_input).val(),{focus:true,unique:a.unique})}}else{e(g.data.fake_input).val(e(g.data.fake_input).attr("data-default"));e(g.data.fake_input).css("color",a.placeholderColor)}return false})}e(h.fake_input).bind("keypress",h,function(g){if(g.which==g.data.delimiter.charCodeAt(0)||g.which==13){g.preventDefault();if(g.data.minChars<=e(g.data.fake_input).val().length&&(!g.data.maxChars||g.data.maxChars>=e(g.data.fake_input).val().length)){e(g.data.real_input).addTag(e(g.data.fake_input).val(),{focus:true,unique:a.unique})}e(g.data.fake_input).resetAutosize(a);return false}else{if(g.data.autosize){e(g.data.fake_input).doAutosize(a)}}});h.removeWithBackspace&&e(h.fake_input).bind("keydown",function(g){if(g.keyCode==8&&e(this).val()==""){g.preventDefault();var l=e(this).closest(".tagsinput").find(".tag:last").text();var k=e(this).attr("id").replace(/_tag$/,"");l=l.replace(/[\s]+x$/,"");e("#"+k).removeTag(escape(l));e(this).trigger("focus")}});e(h.fake_input).blur();if(h.unique){e(h.fake_input).keydown(function(g){if(g.keyCode==8||String.fromCharCode(g.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){e(this).removeClass("not_valid")}})}}});return this};e.fn.tagsInput.updateTagsField=function(g,b){var a=e(g).attr("id");e(g).val(b.join(d[a]))};e.fn.tagsInput.importTags=function(k,j){e(k).val("");var c=e(k).attr("id");var b=j.split(d[c]);for(i=0;i<b.length;i++){e(k).addTag(b[i],{focus:false,callback:false})}if(f[c]&&f[c]["onChange"]){var a=f[c]["onChange"];a.call(k,k,b[i])}}})(jQuery);
/*! bootstrap3-wysihtml5-bower 2013-11-22 */
;var wysihtml5={version:"0.3.0",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};window.rangy=function(){function T(e,d){var f=typeof e[d];return f==K||!(f!=L||!e[d])||"unknown"==f}function S(d,c){return !(typeof d[c]!=L||!d[c])}function R(d,c){return typeof d[c]!=J}function Q(b){return function(a,f){for(var e=f.length;e--;){if(!b(a,f[e])){return !1}}return !0}}function P(b){return b&&E(b,F)&&C(b,G)}function O(b){window.alert("Rangy not supported in your browser. Reason: "+b),B.initialized=!0,B.supported=!1}function N(){if(!B.initialized){var f,e=!1,b=!1;for(T(document,"createRange")&&(f=document.createRange(),E(f,H)&&C(f,I)&&(e=!0),f.detach()),(f=S(document,"body")?document.body:document.getElementsByTagName("body")[0])&&T(f,"createTextRange")&&(f=f.createTextRange(),P(f)&&(b=!0)),!e&&!b&&O("Neither Range nor TextRange are implemented"),B.initialized=!0,B.features={implementsDomRange:e,implementsTextRange:b},e=z.concat(A),b=0,f=e.length;f>b;++b){try{e[b](B)}catch(a){S(window,"console")&&T(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",a)}}}}function M(b){this.name=b,this.supported=this.initialized=!1}var L="object",K="function",J="undefined",I="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),H="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),G="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),F="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),E=Q(T),D=Q(S),C=Q(R),B={version:"1.2.2",initialized:!1,supported:!0,util:{isHostMethod:T,isHostObject:S,isHostProperty:R,areHostMethods:E,areHostObjects:D,areHostProperties:C,isTextRange:P},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};B.fail=O,B.warn=function(b){b="Rangy warning: "+b,B.config.alertOnWarn?window.alert(b):typeof window.console!=J&&typeof window.console.log!=J&&window.console.log(b)},{}.hasOwnProperty?B.util.extend=function(e,d){for(var f in d){d.hasOwnProperty(f)&&(e[f]=d[f])}}:O("hasOwnProperty not supported");var A=[],z=[];B.init=N,B.addInitListener=function(b){B.initialized?b(B):A.push(b)};var y=[];B.addCreateMissingNativeApiListener=function(b){y.push(b)},B.createMissingNativeApi=function(e){e=e||window,N();for(var d=0,f=y.length;f>d;++d){y[d](e)}},M.prototype.fail=function(b){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+b)},M.prototype.warn=function(b){B.warn("Module "+this.name+": "+b)},M.prototype.createError=function(b){return Error("Error in Rangy "+this.name+" module: "+b)},B.createModule=function(e,d){var f=new M(e);B.modules[e]=f,z.push(function(b){d(b,f),f.initialized=!0,f.supported=!0})},B.requireModules=function(g){for(var f,k,j=0,h=g.length;h>j;++j){if(k=g[j],f=B.modules[k],!(f&&f instanceof M)){throw Error("Module '"+k+"' not found")}if(!f.supported){throw Error("Module '"+k+"' not supported")}}};var x=!1,D=function(){x||(x=!0,B.initialized||N())};if(typeof window==J){O("No window found")}else{if(typeof document!=J){return T(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",D,!1),T(window,"addEventListener")?window.addEventListener("load",D,!1):T(window,"attachEvent")?window.attachEvent("onload",D):O("Window does not have required addEventListener or attachEvent method"),B}O("No document found")}}(),rangy.createModule("DomUtil",function(G,F){function E(d){for(var c=0;d=d.previousSibling;){c++}return c}function D(f,e){var h,g=[];for(h=f;h;h=h.parentNode){g.push(h)}for(h=e;h;h=h.parentNode){if(q(g,h)){return h}}return null}function C(e,d,f){for(f=f?e:e.parentNode;f;){if(e=f.parentNode,e===d){return f}f=e}return null}function B(b){return b=b.nodeType,3==b||4==b||8==b}function A(f,e){var h=e.nextSibling,g=e.parentNode;return h?g.insertBefore(f,h):g.appendChild(f),f}function z(b){if(9==b.nodeType){return b}if(typeof b.ownerDocument!=u){return b.ownerDocument}if(typeof b.document!=u){return b.document}if(b.parentNode){return z(b.parentNode)}throw Error("getDocument: no document found for node")}function y(b){return b?B(b)?'"'+b.data+'"':1==b.nodeType?"<"+b.nodeName+(b.id?' id="'+b.id+'"':"")+">["+b.childNodes.length+"]":b.nodeName:"[No node]"}function x(b){this._next=this.root=b}function w(d,c){this.node=d,this.offset=c}function v(b){this.code=this[b],this.codeName=b,this.message="DOMException: "+this.codeName}var u="undefined",s=G.util;s.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||F.fail("document missing a Node creation method"),s.isHostMethod(document,"getElementsByTagName")||F.fail("document missing getElementsByTagName method");var r=document.createElement("div");s.areHostMethods(r,["insertBefore","appendChild","cloneNode"])||F.fail("Incomplete Element implementation"),s.isHostProperty(r,"innerHTML")||F.fail("Element is missing innerHTML property"),r=document.createTextNode("test"),s.areHostMethods(r,["splitText","deleteData","insertData","appendData","cloneNode"])||F.fail("Incomplete Text Node implementation");var q=function(e,d){for(var f=e.length;f--;){if(e[f]===d){return !0}}return !1};x.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){var d,c=this._current=this._next;if(this._current){if(d=c.firstChild,!d){for(d=null;c!==this.root&&!(d=c.nextSibling);){c=c.parentNode}}this._next=d}return this._current},detach:function(){this._current=this._next=this.root=null}},w.prototype={equals:function(b){return this.node===b.node&this.offset==b.offset},inspect:function(){return"[DomPosition("+y(this.node)+":"+this.offset+")]"}},v.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},v.prototype.toString=function(){return this.message},G.dom={arrayContains:q,isHtmlNamespace:function(d){var c;return typeof d.namespaceURI==u||null===(c=d.namespaceURI)||"http://www.w3.org/1999/xhtml"==c},parentElement:function(b){return b=b.parentNode,1==b.nodeType?b:null},getNodeIndex:E,getNodeLength:function(d){var c;return B(d)?d.length:(c=d.childNodes)?c.length:0},getCommonAncestor:D,isAncestorOf:function(e,d,f){for(d=f?d:d.parentNode;d;){if(d===e){return !0}d=d.parentNode}return !1},getClosestAncestorIn:C,isCharacterDataNode:B,insertAfter:A,splitDataNode:function(e,d){var f=e.cloneNode(!1);return f.deleteData(0,d),e.deleteData(d,e.length-d),A(f,e),f},getDocument:z,getWindow:function(b){if(b=z(b),typeof b.defaultView!=u){return b.defaultView}if(typeof b.parentWindow!=u){return b.parentWindow}throw Error("Cannot get a window object for node")},getIframeWindow:function(b){if(typeof b.contentWindow!=u){return b.contentWindow}if(typeof b.contentDocument!=u){return b.contentDocument.defaultView}throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(b){if(typeof b.contentDocument!=u){return b.contentDocument}if(typeof b.contentWindow!=u){return b.contentWindow.document}throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(b){return s.isHostObject(b,"body")?b.body:b.getElementsByTagName("body")[0]},getRootContainer:function(d){for(var c;c=d.parentNode;){d=c}return d},comparePoints:function(d,c,k,j){var e;if(d==k){return c===j?0:j>c?-1:1}if(e=C(k,d,!0)){return c<=E(e)?-1:1}if(e=C(d,k,!0)){return E(e)<j?-1:1}if(c=D(d,k),d=d===c?c:C(d,c,!0),k=k===c?c:C(k,c,!0),d===k){throw Error("comparePoints got to case 4 and childA and childB are the same!")}for(c=c.firstChild;c;){if(c===d){return -1}if(c===k){return 1}c=c.nextSibling}throw Error("Should not be here!")},inspectNode:y,fragmentFromNodeChildren:function(e){for(var d,f=z(e).createDocumentFragment();d=e.firstChild;){f.appendChild(d)}return f},createIterator:function(b){return new x(b)},DomPosition:w},G.DOMException=v}),rangy.createModule("DomRange",function(a3){function a2(d,c){return 3!=d.nodeType&&(au.isAncestorOf(d,c.startContainer,!0)||au.isAncestorOf(d,c.endContainer,!0))}function a1(b){return au.getDocument(b.startContainer)}function a0(g,f,k){if(f=g._listeners[f]){for(var j=0,h=f.length;h>j;++j){f[j].call(g,{target:g,args:k})}}}function aZ(b){return new at(b.parentNode,au.getNodeIndex(b))}function aY(b){return new at(b.parentNode,au.getNodeIndex(b)+1)}function aX(f,e,h){var g=11==f.nodeType?f.firstChild:f;return au.isCharacterDataNode(e)?h==e.length?au.insertAfter(f,e):e.parentNode.insertBefore(f,0==h?e:au.splitDataNode(e,h)):h>=e.childNodes.length?e.appendChild(f):e.insertBefore(f,e.childNodes[h]),g}function aW(f){for(var c,h,g=a1(f.range).createDocumentFragment();h=f.next();){if(c=f.isPartiallySelectedSubtree(),h=h.cloneNode(!c),c&&(c=f.getSubtreeIterator(),h.appendChild(aW(c)),c.detach(!0)),10==h.nodeType){throw new ar("HIERARCHY_REQUEST_ERR")}g.appendChild(h)}return g}function aV(g,f,k){for(var j,h,k=k||{stop:!1};j=g.next();){if(g.isPartiallySelectedSubtree()){if(!1===f(j)){k.stop=!0;break}if(j=g.getSubtreeIterator(),aV(j,f,k),j.detach(!0),k.stop){break}}else{for(j=au.createIterator(j);h=j.next();){if(!1===f(h)){return k.stop=!0,void 0}}}}}function aU(d){for(var c;d.next();){d.isPartiallySelectedSubtree()?(c=d.getSubtreeIterator(),aU(c),c.detach(!0)):d.remove()}}function aT(f){for(var c,h,g=a1(f.range).createDocumentFragment();c=f.next();){if(f.isPartiallySelectedSubtree()?(c=c.cloneNode(!1),h=f.getSubtreeIterator(),c.appendChild(aT(h)),h.detach(!0)):f.remove(),10==c.nodeType){throw new ar("HIERARCHY_REQUEST_ERR")}g.appendChild(c)}return g}function aS(j,h,o){var n,m=!(!h||!h.length),l=!!o;m&&(n=RegExp("^("+h.join("|")+")$"));var k=[];return aV(new aQ(j,!1),function(b){(!m||n.test(b.nodeType))&&(!l||o(b))&&k.push(b)}),k}function aR(b){return"["+("undefined"==typeof b.getName?"Range":b.getName())+"("+au.inspectNode(b.startContainer)+":"+b.startOffset+", "+au.inspectNode(b.endContainer)+":"+b.endOffset+")]"}function aQ(e,d){if(this.range=e,this.clonePartiallySelectedTextNodes=d,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var f=e.commonAncestorContainer;this.sc===this.ec&&au.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==f||au.isCharacterDataNode(this.sc)?au.getClosestAncestorIn(this.sc,f,!0):this.sc.childNodes[this.so],this._last=this.ec!==f||au.isCharacterDataNode(this.ec)?au.getClosestAncestorIn(this.ec,f,!0):this.ec.childNodes[this.eo-1])}}function aP(b){this.code=this[b],this.codeName=b,this.message="RangeException: "+this.codeName}function aO(e,d,f){this.nodes=aS(e,d,f),this._next=this.nodes[0],this._position=0}function aN(b){return function(a,h){for(var g,f=h?a:a.parentNode;f;){if(g=f.nodeType,au.arrayContains(b,g)){return f}f=f.parentNode}return null}}function aM(d,c){if(aj(d,c)){throw new aP("INVALID_NODE_TYPE_ERR")}}function aL(b){if(!b.startContainer){throw new ar("INVALID_STATE_ERR")}}function aK(d,c){if(!au.arrayContains(c,d.nodeType)){throw new aP("INVALID_NODE_TYPE_ERR")}}function aJ(d,c){if(0>c||c>(au.isCharacterDataNode(d)?d.length:d.childNodes.length)){throw new ar("INDEX_SIZE_ERR")}}function aI(d,c){if(al(d,!0)!==al(c,!0)){throw new ar("WRONG_DOCUMENT_ERR")}}function aH(b){if(ak(b,!0)){throw new ar("NO_MODIFICATION_ALLOWED_ERR")}}function aG(d,c){if(!d){throw new ar(c)}}function aF(b){if(aL(b),!((au.arrayContains(ap,b.startContainer.nodeType)||al(b.startContainer,!0))&&(au.arrayContains(ap,b.endContainer.nodeType)||al(b.endContainer,!0))&&b.startOffset<=(au.isCharacterDataNode(b.startContainer)?b.startContainer.length:b.startContainer.childNodes.length)&&b.endOffset<=(au.isCharacterDataNode(b.endContainer)?b.endContainer.length:b.endContainer.childNodes.length))){throw Error("Range error: Range is no longer valid after DOM mutation ("+b.inspect()+")")}}function aE(){}function aC(b){b.START_TO_START=ae,b.START_TO_END=ad,b.END_TO_END=ac,b.END_TO_START=aa,b.NODE_BEFORE=aD,b.NODE_AFTER=a5,b.NODE_BEFORE_AND_AFTER=aB,b.NODE_INSIDE=a4}function aA(b){aC(b),aC(b.prototype)}function az(d,c){return function(){aF(this);var h=this.startContainer,f=this.startOffset,b=this.commonAncestorContainer,a=new aQ(this,!0);return h!==b&&(h=au.getClosestAncestorIn(h,b,!0),f=aY(h),h=f.node,f=f.offset),aV(a,aH),a.reset(),b=d(a),a.detach(),c(this,h,f,h,f),b}}function ay(k,j,f){function e(d,c){return function(g){aL(this),aK(g,aq),aK(am(g),ap),g=(d?aZ:aY)(g),(c?b:a)(this,g.node,g.offset)}}function b(g,d,m){var l=g.endContainer,h=g.endOffset;(d!==g.startContainer||m!==g.startOffset)&&((am(d)!=am(l)||1==au.comparePoints(d,m,l,h))&&(l=d,h=m),j(g,d,m,l,h))}function a(g,d,m){var l=g.startContainer,h=g.startOffset;(d!==g.endContainer||m!==g.endOffset)&&((am(d)!=am(l)||-1==au.comparePoints(d,m,l,h))&&(l=d,h=m),j(g,l,h,d,m))}k.prototype=new aE,a3.util.extend(k.prototype,{setStart:function(d,c){aL(this),aM(d,!0),aJ(d,c),b(this,d,c)},setEnd:function(d,c){aL(this),aM(d,!0),aJ(d,c),a(this,d,c)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(c){aF(this),c?j(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):j(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(c){aL(this),aM(c,!0),j(this,c,0,c,au.getNodeLength(c))},selectNode:function(d){aL(this),aM(d,!1),aK(d,aq);var c=aZ(d),d=aY(d);j(this,c.node,c.offset,d.node,d.offset)},extractContents:az(aT,j),deleteContents:az(aU,j),canSurroundContents:function(){aF(this),aH(this.startContainer),aH(this.endContainer);var d=new aQ(this,!0),g=d._first&&a2(d._first,this)||d._last&&a2(d._last,this);return d.detach(),!g},detach:function(){f(this)},splitBoundaries:function(){aF(this);var g=this.startContainer,d=this.startOffset,m=this.endContainer,l=this.endOffset,h=g===m;au.isCharacterDataNode(m)&&l>0&&l<m.length&&au.splitDataNode(m,l),au.isCharacterDataNode(g)&&d>0&&d<g.length&&(g=au.splitDataNode(g,d),h?(l-=d,m=g):m==g.parentNode&&l>=au.getNodeIndex(g)&&l++,d=0),j(this,g,d,m,l)},normalizeBoundaries:function(){aF(this);var l=this.startContainer,d=this.startOffset,q=this.endContainer,p=this.endOffset,o=function(g){var c=g.nextSibling;c&&c.nodeType==g.nodeType&&(q=g,p=g.length,g.appendData(c.data),c.parentNode.removeChild(c))},n=function(r){var h=r.previousSibling;if(h&&h.nodeType==r.nodeType){l=r;var c=r.length;d=h.length,r.insertData(0,h.data),h.parentNode.removeChild(h),l==q?(p+=d,q=l):q==r.parentNode&&(h=au.getNodeIndex(r),p==h?(q=r,p=c):p>h&&p--)}},m=!0;au.isCharacterDataNode(q)?q.length==p&&o(q):(p>0&&(m=q.childNodes[p-1])&&au.isCharacterDataNode(m)&&o(m),m=!this.collapsed),m?au.isCharacterDataNode(l)?0==d&&n(l):d<l.childNodes.length&&(o=l.childNodes[d])&&au.isCharacterDataNode(o)&&n(o):(l=q,d=p),j(this,l,d,q,p)},collapseToPoint:function(d,c){aL(this),aM(d,!0),aJ(d,c),(d!==this.startContainer||c!==this.startOffset||d!==this.endContainer||c!==this.endOffset)&&j(this,d,c,d,c)}}),aA(k)}function ax(b){b.collapsed=b.startContainer===b.endContainer&&b.startOffset===b.endOffset,b.commonAncestorContainer=b.collapsed?b.startContainer:au.getCommonAncestor(b.startContainer,b.endContainer)}function aw(j,d,o,n,m){var l=j.startContainer!==d||j.startOffset!==o,k=j.endContainer!==n||j.endOffset!==m;j.startContainer=d,j.startOffset=o,j.endContainer=n,j.endOffset=m,ax(j),a0(j,"boundarychange",{startMoved:l,endMoved:k})}function av(b){this.startContainer=b,this.startOffset=0,this.endContainer=b,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},ax(this)}a3.requireModules(["DomUtil"]);var au=a3.dom,at=au.DomPosition,ar=a3.DOMException;aQ.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return !!this._next},next:function(){var b=this._current=this._next;return b&&(this._next=b!==this._last?b.nextSibling:null,au.isCharacterDataNode(b)&&this.clonePartiallySelectedTextNodes&&(b===this.ec&&(b=b.cloneNode(!0)).deleteData(this.eo,b.length-this.eo),this._current===this.sc&&(b=b.cloneNode(!0)).deleteData(0,this.so))),b},remove:function(){var e,d,f=this._current;!au.isCharacterDataNode(f)||f!==this.sc&&f!==this.ec?f.parentNode&&f.parentNode.removeChild(f):(e=f===this.sc?this.so:0,d=f===this.ec?this.eo:f.length,e!=d&&f.deleteData(e,d-e))},isPartiallySelectedSubtree:function(){return a2(this._current,this.range)},getSubtreeIterator:function(){var h;if(this.isSingleCharacterDataNode){h=this.range.cloneRange(),h.collapse()}else{h=new av(a1(this.range));var c=this._current,m=c,l=0,k=c,j=au.getNodeLength(c);au.isAncestorOf(c,this.sc,!0)&&(m=this.sc,l=this.so),au.isAncestorOf(c,this.ec,!0)&&(k=this.ec,j=this.eo),aw(h,m,l,k,j)}return new aQ(h,this.clonePartiallySelectedTextNodes)},detach:function(b){b&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},aP.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},aP.prototype.toString=function(){return this.message},aO.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var aq=[1,3,4,5,7,8,10],ap=[2,9,11],ao=[1,3,4,5,7,8,10,11],an=[1,3,4,5,7,8],am=au.getRootContainer,al=aN([9,11]),ak=aN([5,6,10,12]),aj=aN([6,10,12]),ai=document.createElement("style"),ah=!1;try{ai.innerHTML="<b>x</b>",ah=3==ai.firstChild.nodeType}catch(ag){}a3.features.htmlParsingConforms=ah;var af="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),ae=0,ad=1,ac=2,aa=3,aD=0,a5=1,aB=2,a4=3;aE.prototype={attachListener:function(d,c){this._listeners[d].push(c)},compareBoundaryPoints:function(f,e){aF(this),aI(this.startContainer,e.startContainer);var h=f==aa||f==ae?"start":"end",g=f==ad||f==ae?"start":"end";return au.comparePoints(this[h+"Container"],this[h+"Offset"],e[g+"Container"],e[g+"Offset"])},insertNode:function(b){if(aF(this),aK(b,ao),aH(this.startContainer),au.isAncestorOf(b,this.startContainer,!0)){throw new ar("HIERARCHY_REQUEST_ERR")}this.setStartBefore(aX(b,this.startContainer,this.startOffset))},cloneContents:function(){aF(this);var d,c;return this.collapsed?a1(this).createDocumentFragment():this.startContainer===this.endContainer&&au.isCharacterDataNode(this.startContainer)?(d=this.startContainer.cloneNode(!0),d.data=d.data.slice(this.startOffset,this.endOffset),c=a1(this).createDocumentFragment(),c.appendChild(d),c):(c=new aQ(this,!0),d=aW(c),c.detach(),d)},canSurroundContents:function(){aF(this),aH(this.startContainer),aH(this.endContainer);var b=new aQ(this,!0),d=b._first&&a2(b._first,this)||b._last&&a2(b._last,this);return b.detach(),!d},surroundContents:function(d){if(aK(d,an),!this.canSurroundContents()){throw new aP("BAD_BOUNDARYPOINTS_ERR")}var c=this.extractContents();if(d.hasChildNodes()){for(;d.lastChild;){d.removeChild(d.lastChild)}}aX(d,this.startContainer,this.startOffset),d.appendChild(c),this.selectNode(d)},cloneRange:function(){aF(this);for(var e,c=new av(a1(this)),f=af.length;f--;){e=af[f],c[e]=this[e]}return c},toString:function(){aF(this);var d=this.startContainer;if(d===this.endContainer&&au.isCharacterDataNode(d)){return 3==d.nodeType||4==d.nodeType?d.data.slice(this.startOffset,this.endOffset):""}var c=[],d=new aQ(this,!0);return aV(d,function(b){(3==b.nodeType||4==b.nodeType)&&c.push(b.data)}),d.detach(),c.join("")},compareNode:function(e){aF(this);var d=e.parentNode,f=au.getNodeIndex(e);if(!d){throw new ar("NOT_FOUND_ERR")}return e=this.comparePoint(d,f),d=this.comparePoint(d,f+1),0>e?d>0?aB:aD:d>0?a5:a4},comparePoint:function(d,c){return aF(this),aG(d,"HIERARCHY_REQUEST_ERR"),aI(d,this.startContainer),0>au.comparePoints(d,c,this.startContainer,this.startOffset)?-1:0<au.comparePoints(d,c,this.endContainer,this.endOffset)?1:0},createContextualFragment:ah?function(f){var e=this.startContainer,h=au.getDocument(e);if(!e){throw new ar("INVALID_STATE_ERR")}var g=null;return 1==e.nodeType?g=e:au.isCharacterDataNode(e)&&(g=au.parentElement(e)),g=null===g||"HTML"==g.nodeName&&au.isHtmlNamespace(au.getDocument(g).documentElement)&&au.isHtmlNamespace(g)?h.createElement("body"):g.cloneNode(!1),g.innerHTML=f,au.fragmentFromNodeChildren(g)}:function(d){aL(this);var c=a1(this).createElement("body");return c.innerHTML=d,au.fragmentFromNodeChildren(c)},toHtml:function(){aF(this);var b=a1(this).createElement("div");return b.appendChild(this.cloneContents()),b.innerHTML},intersectsNode:function(g,c){if(aF(this),aG(g,"NOT_FOUND_ERR"),au.getDocument(g)!==a1(this)){return !1}var k=g.parentNode,j=au.getNodeIndex(g);aG(k,"NOT_FOUND_ERR");var h=au.comparePoints(k,j,this.endContainer,this.endOffset),k=au.comparePoints(k,j+1,this.startContainer,this.startOffset);return c?0>=h&&k>=0:0>h&&k>0},isPointInRange:function(d,c){return aF(this),aG(d,"HIERARCHY_REQUEST_ERR"),aI(d,this.startContainer),0<=au.comparePoints(d,c,this.startContainer,this.startOffset)&&0>=au.comparePoints(d,c,this.endContainer,this.endOffset)},intersectsRange:function(f,c){if(aF(this),a1(f)!=a1(this)){throw new ar("WRONG_DOCUMENT_ERR")}var h=au.comparePoints(this.startContainer,this.startOffset,f.endContainer,f.endOffset),g=au.comparePoints(this.endContainer,this.endOffset,f.startContainer,f.startOffset);return c?0>=h&&g>=0:0>h&&g>0},intersection:function(f){if(this.intersectsRange(f)){var e=au.comparePoints(this.startContainer,this.startOffset,f.startContainer,f.startOffset),h=au.comparePoints(this.endContainer,this.endOffset,f.endContainer,f.endOffset),g=this.cloneRange();return -1==e&&g.setStart(f.startContainer,f.startOffset),1==h&&g.setEnd(f.endContainer,f.endOffset),g}return null},union:function(d){if(this.intersectsRange(d,!0)){var c=this.cloneRange();return -1==au.comparePoints(d.startContainer,d.startOffset,this.startContainer,this.startOffset)&&c.setStart(d.startContainer,d.startOffset),1==au.comparePoints(d.endContainer,d.endOffset,this.endContainer,this.endOffset)&&c.setEnd(d.endContainer,d.endOffset),c}throw new aP("Ranges do not intersect")},containsNode:function(d,c){return c?this.intersectsNode(d,!1):this.compareNode(d)==a4},containsNodeContents:function(b){return 0<=this.comparePoint(b,0)&&0>=this.comparePoint(b,au.getNodeLength(b))},containsRange:function(b){return this.intersection(b).equals(b)},containsNodeText:function(e){var d=this.cloneRange();d.selectNode(e);var f=d.getNodes([3]);return 0<f.length?(d.setStart(f[0],0),e=f.pop(),d.setEnd(e,e.length),e=this.containsRange(d),d.detach(),e):this.containsNodeContents(e)},createNodeIterator:function(d,c){return aF(this),new aO(this,d,c)},getNodes:function(d,c){return aF(this),aS(this,d,c)},getDocument:function(){return a1(this)},collapseBefore:function(b){aL(this),this.setEndBefore(b),this.collapse(!1)},collapseAfter:function(b){aL(this),this.setStartAfter(b),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(b){return av.rangesEqual(this,b)},inspect:function(){return aR(this)}},ay(av,aw,function(b){aL(b),b.startContainer=b.startOffset=b.endContainer=b.endOffset=null,b.collapsed=b.commonAncestorContainer=null,a0(b,"detach",null),b._listeners=null}),a3.rangePrototype=aE.prototype,av.rangeProperties=af,av.RangeIterator=aQ,av.copyComparisonConstants=aA,av.createPrototypeRange=ay,av.inspect=aR,av.getRangeDocument=a1,av.rangesEqual=function(d,c){return d.startContainer===c.startContainer&&d.startOffset===c.startOffset&&d.endContainer===c.endContainer&&d.endOffset===c.endOffset},a3.DomRange=av,a3.RangeException=aP}),rangy.createModule("WrappedRange",function(k){function j(f,e,x,w){var v=f.duplicate();v.collapse(x);var u=v.parentElement();if(o.isAncestorOf(e,u,!0)||(u=e),!u.canHaveHTML){return new n(u.parentNode,o.getNodeIndex(u))}var s,e=o.getDocument(u).createElement("span"),r=x?"StartToStart":"StartToEnd";do{u.insertBefore(e,e.previousSibling),v.moveToElementText(e)}while(0<(s=v.compareEndPoints(r,f))&&e.previousSibling);if(r=e.nextSibling,-1==s&&r&&o.isCharacterDataNode(r)){if(v.setEndPoint(x?"EndToStart":"EndToEnd",f),/[\r\n]/.test(r.data)){for(u=v.duplicate(),x=u.text.replace(/\r\n/g,"\r").length,x=u.moveStart("character",x);-1==u.compareEndPoints("StartToEnd",u);){x++,u.moveStart("character",1)}}else{x=v.text.length}u=new n(r,x)}else{r=(w||!x)&&e.previousSibling,u=(x=(w||x)&&e.nextSibling)&&o.isCharacterDataNode(x)?new n(x,0):r&&o.isCharacterDataNode(r)?new n(r,r.length):new n(u,o.getNodeIndex(e))}return e.parentNode.removeChild(e),u}function q(r,e){var y,x,w=r.offset,v=o.getDocument(r.node),u=v.body.createTextRange(),s=o.isCharacterDataNode(r.node);return s?(y=r.node,x=y.parentNode):(y=r.node.childNodes,y=w<y.length?y[w]:null,x=r.node),v=v.createElement("span"),v.innerHTML="&#feff;",y?x.insertBefore(v,y):x.appendChild(v),u.moveToElementText(v),u.collapse(!e),x.removeChild(v),s&&u[e?"moveStart":"moveEnd"]("character",w),u}k.requireModules(["DomUtil","DomRange"]);var p,o=k.dom,n=o.DomPosition,m=k.DomRange;if(!k.features.implementsDomRange||k.features.implementsTextRange&&k.config.preferTextRange){if(k.features.implementsTextRange){p=function(b){this.textRange=b,this.refresh()},p.prototype=new m(document),p.prototype.refresh=function(){var b,h,g=this.textRange;b=g.parentElement();var e=g.duplicate();e.collapse(!0),h=e.parentElement(),e=g.duplicate(),e.collapse(!1),g=e.parentElement(),h=h==g?h:o.getCommonAncestor(h,g),h=h==b?h:o.getCommonAncestor(b,h),0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?h=b=j(this.textRange,h,!0,!0):(b=j(this.textRange,h,!0,!1),h=j(this.textRange,h,!1,!1)),this.setStart(b.node,b.offset),this.setEnd(h.node,h.offset)},m.copyComparisonConstants(p);var l=function(){return this}();"undefined"==typeof l.Range&&(l.Range=p),k.createNativeRange=function(b){return b=b||document,b.body.createTextRange()}}}else{(function(){function a(h){for(var f,v=r.length;v--;){f=r[v],h[f]=h.nativeRange[f]}}var u,s,r=m.rangeProperties;p=function(b){if(!b){throw Error("Range must be specified")}this.nativeRange=b,a(this)},m.createPrototypeRange(p,function(v,h,z,y,x){var w=v.endContainer!==y||v.endOffset!=x;(v.startContainer!==h||v.startOffset!=z||w)&&(v.setEnd(y,x),v.setStart(h,z))},function(h){h.nativeRange.detach(),h.detached=!0;for(var f,v=r.length;v--;){f=r[v],h[f]=null}}),u=p.prototype,u.selectNode=function(b){this.nativeRange.selectNode(b),a(this)},u.deleteContents=function(){this.nativeRange.deleteContents(),a(this)},u.extractContents=function(){var b=this.nativeRange.extractContents();return a(this),b},u.cloneContents=function(){return this.nativeRange.cloneContents()},u.surroundContents=function(b){this.nativeRange.surroundContents(b),a(this)},u.collapse=function(b){this.nativeRange.collapse(b),a(this)},u.cloneRange=function(){return new p(this.nativeRange.cloneRange())},u.refresh=function(){a(this)},u.toString=function(){return this.nativeRange.toString()};var g=document.createTextNode("test");o.getBody(document).appendChild(g);var e=document.createRange();e.setStart(g,0),e.setEnd(g,0);try{e.setStart(g,1),u.setStart=function(b,f){this.nativeRange.setStart(b,f),a(this)},u.setEnd=function(b,f){this.nativeRange.setEnd(b,f),a(this)},s=function(b){return function(f){this.nativeRange[b](f),a(this)}}}catch(d){u.setStart=function(b,h){try{this.nativeRange.setStart(b,h)}catch(f){this.nativeRange.setEnd(b,h),this.nativeRange.setStart(b,h)}a(this)},u.setEnd=function(b,h){try{this.nativeRange.setEnd(b,h)}catch(f){this.nativeRange.setStart(b,h),this.nativeRange.setEnd(b,h)}a(this)},s=function(b,f){return function(h){try{this.nativeRange[b](h)}catch(c){this.nativeRange[f](h),this.nativeRange[b](h)}a(this)}}}u.setStartBefore=s("setStartBefore","setEndBefore"),u.setStartAfter=s("setStartAfter","setEndAfter"),u.setEndBefore=s("setEndBefore","setStartBefore"),u.setEndAfter=s("setEndAfter","setStartAfter"),e.selectNodeContents(g),u.selectNodeContents=e.startContainer==g&&e.endContainer==g&&0==e.startOffset&&e.endOffset==g.length?function(b){this.nativeRange.selectNodeContents(b),a(this)}:function(b){this.setStart(b,0),this.setEnd(b,m.getEndOffset(b))},e.selectNodeContents(g),e.setEnd(g,3),s=document.createRange(),s.selectNodeContents(g),s.setEnd(g,4),s.setStart(g,2),u.compareBoundaryPoints=-1==e.compareBoundaryPoints(e.START_TO_END,s)&1==e.compareBoundaryPoints(e.END_TO_START,s)?function(f,c){return c=c.nativeRange||c,f==c.START_TO_END?f=c.END_TO_START:f==c.END_TO_START&&(f=c.START_TO_END),this.nativeRange.compareBoundaryPoints(f,c)}:function(f,c){return this.nativeRange.compareBoundaryPoints(f,c.nativeRange||c)},k.util.isHostMethod(e,"createContextualFragment")&&(u.createContextualFragment=function(b){return this.nativeRange.createContextualFragment(b)}),o.getBody(document).removeChild(g),e.detach(),s.detach()})(),k.createNativeRange=function(b){return b=b||document,b.createRange()}}k.features.implementsTextRange&&(p.rangeToTextRange=function(e){if(e.collapsed){return q(new n(e.startContainer,e.startOffset),!0)}var c=q(new n(e.startContainer,e.startOffset),!0),f=q(new n(e.endContainer,e.endOffset),!1),e=o.getDocument(e.startContainer).body.createTextRange();return e.setEndPoint("StartToStart",c),e.setEndPoint("EndToEnd",f),e}),p.prototype.getName=function(){return"WrappedRange"},k.WrappedRange=p,k.createRange=function(a){return a=a||document,new p(k.createNativeRange(a))},k.createRangyRange=function(b){return b=b||document,new m(b)},k.createIframeRange=function(a){return k.createRange(o.getIframeDocument(a))},k.createIframeRangyRange=function(a){return k.createRangyRange(o.getIframeDocument(a))},k.addCreateMissingNativeApiListener(function(a){a=a.document,"undefined"==typeof a.createRange&&(a.createRange=function(){return k.createRange(this)}),a=a=null})}),rangy.createModule("WrappedSelection",function(aC,aB){function aA(b){return(b||window).getSelection()}function az(b){return(b||window).document.selection}function ay(f,e,h){var g=h?"end":"start",h=h?"start":"end";f.anchorNode=e[g+"Container"],f.anchorOffset=e[g+"Offset"],f.focusNode=e[h+"Container"],f.focusOffset=e[h+"Offset"]}function ax(b){b.anchorNode=b.focusNode=null,b.anchorOffset=b.focusOffset=0,b.rangeCount=0,b.isCollapsed=!0,b._ranges.length=0}function aw(a){var d;return a instanceof ai?(d=a._selectionNativeRange,d||(d=aC.createNativeRange(ak.getDocument(a.startContainer)),d.setEnd(a.endContainer,a.endOffset),d.setStart(a.startContainer,a.startOffset),a._selectionNativeRange=d,a.attachListener("detach",function(){this._selectionNativeRange=null}))):a instanceof ah?d=a.nativeRange:aC.features.implementsDomRange&&a instanceof ak.getWindow(a.startContainer).Range&&(d=a),d}function av(f){var e,h=f.getNodes();f:if(h.length&&1==h[0].nodeType){e=1;for(var g=h.length;g>e;++e){if(!ak.isAncestorOf(h[0],h[e])){e=!1;break f}}e=!0}else{e=!1}if(!e){throw Error("getSingleElementFromRange: range "+f.inspect()+" did not consist of a single element")}return h[0]}function au(e,d){var f=new ah(d);e._ranges=[f],ay(e,f,!1),e.rangeCount=1,e.isCollapsed=f.collapsed}function at(a){if(a._ranges.length=0,"None"==a.docSelection.type){ax(a)}else{var k=a.docSelection.createRange();if(k&&"undefined"!=typeof k.text){au(a,k)}else{a.rangeCount=k.length;for(var j,f=ak.getDocument(k.item(0)),e=0;e<a.rangeCount;++e){j=aC.createRange(f),j.selectNode(k.item(e)),a._ranges.push(j)}a.isCollapsed=1==a.rangeCount&&a._ranges[0].collapsed,ay(a,a._ranges[a.rangeCount-1],!1)}}}function ar(j,h){for(var p=j.docSelection.createRange(),o=av(h),n=ak.getDocument(p.item(0)),n=ak.getBody(n).createControlRange(),m=0,l=p.length;l>m;++m){n.add(p.item(m))}try{n.add(o)}catch(k){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}n.select(),at(j)}function aq(e,d,f){this.nativeSelection=e,this.docSelection=d,this._ranges=[],this.win=f,this.refresh()}function ap(h,g){for(var m,l=ak.getDocument(g[0].startContainer),l=ak.getBody(l).createControlRange(),k=0;rangeCount>k;++k){m=av(g[k]);try{l.add(m)}catch(j){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}l.select(),at(h)}function ao(d,c){if(d.anchorNode&&ak.getDocument(d.anchorNode)!==ak.getDocument(c)){throw new ag("WRONG_DOCUMENT_ERR")}}function an(j){var h=[],o=new af(j.anchorNode,j.anchorOffset),n=new af(j.focusNode,j.focusOffset),m="function"==typeof j.getName?j.getName():"Selection";if("undefined"!=typeof j.rangeCount){for(var l=0,k=j.rangeCount;k>l;++l){h[l]=ai.inspect(j.getRangeAt(l))}}return"["+m+"(Ranges: "+h.join(", ")+")(anchor: "+o.inspect()+", focus: "+n.inspect()+"]"}aC.requireModules(["DomUtil","DomRange","WrappedRange"]),aC.config.checkSelectionRanges=!0;var am,al,ak=aC.dom,aj=aC.util,ai=aC.DomRange,ah=aC.WrappedRange,ag=aC.DOMException,af=ak.DomPosition,ae=aC.util.isHostMethod(window,"getSelection"),ad=aC.util.isHostObject(document,"selection"),ac=ad&&(!ae||aC.config.preferTextRange);ac?(am=az,aC.isSelectionValid=function(d){var d=(d||window).document,c=d.selection;return"None"!=c.type||ak.getDocument(c.createRange().parentElement())==d}):ae?(am=aA,aC.isSelectionValid=function(){return !0}):aB.fail("Neither document.selection or window.getSelection() detected."),aC.getNativeSelection=am;var ae=am(),ab=aC.createNativeRange(document),aa=ak.getBody(document),Z=aj.areHostObjects(ae,aj.areHostProperties(ae,["anchorOffset","focusOffset"]));aC.features.selectionHasAnchorAndFocus=Z;var Y=aj.isHostMethod(ae,"extend");aC.features.selectionHasExtend=Y;var X="number"==typeof ae.rangeCount;aC.features.selectionHasRangeCount=X;var W=!1,V=!0;aj.areHostMethods(ae,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof ae.rangeCount&&aC.features.implementsDomRange&&function(){var g=document.createElement("iframe");aa.appendChild(g);var f=ak.getIframeDocument(g);f.open(),f.write("<html><head></head><body>12</body></html>"),f.close();var k=ak.getIframeWindow(g).getSelection(),j=f.documentElement.lastChild.firstChild,f=f.createRange();f.setStart(j,1),f.collapse(!0),k.addRange(f),V=1==k.rangeCount,k.removeAllRanges();var h=f.cloneRange();f.setStart(j,0),h.setEnd(j,2),k.addRange(f),k.addRange(h),W=2==k.rangeCount,f.detach(),h.detach(),aa.removeChild(g)}(),aC.features.selectionSupportsMultipleRanges=W,aC.features.collapsedNonEditableSelectionsSupported=V;var U,T=!1;aa&&aj.isHostMethod(aa,"createControlRange")&&(U=aa.createControlRange(),aj.areHostProperties(U,["item","add"])&&(T=!0)),aC.features.implementsControlRange=T,al=Z?function(b){return b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset}:function(b){return b.rangeCount?b.getRangeAt(b.rangeCount-1).collapsed:!1};var S;if(aj.isHostMethod(ae,"getRangeAt")?S=function(e,d){try{return e.getRangeAt(d)}catch(f){return null}}:Z&&(S=function(a){var d=ak.getDocument(a.anchorNode),d=aC.createRange(d);return d.setStart(a.anchorNode,a.anchorOffset),d.setEnd(a.focusNode,a.focusOffset),d.collapsed!==this.isCollapsed&&(d.setStart(a.focusNode,a.focusOffset),d.setEnd(a.anchorNode,a.anchorOffset)),d}),aC.getSelection=function(f){var f=f||window,d=f._rangySelection,h=am(f),g=ad?az(f):null;return d?(d.nativeSelection=h,d.docSelection=g,d.refresh(f)):(d=new aq(h,g,f),f._rangySelection=d),d},aC.getIframeSelection=function(a){return aC.getSelection(ak.getIframeWindow(a))},U=aq.prototype,!ac&&Z&&aj.areHostMethods(ae,["removeAllRanges","addRange"])){U.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),ax(this)};var R=function(a,f){var e=ai.getRangeDocument(f),e=aC.createRange(e);e.collapseToPoint(f.endContainer,f.endOffset),a.nativeSelection.addRange(aw(e)),a.nativeSelection.extend(f.startContainer,f.startOffset),a.refresh()};U.addRange=X?function(a,f){if(T&&ad&&"Control"==this.docSelection.type){ar(this,a)}else{if(f&&Y){R(this,a)}else{var e;W?e=this.rangeCount:(this.removeAllRanges(),e=0),this.nativeSelection.addRange(aw(a)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1?(aC.config.checkSelectionRanges&&(e=S(this.nativeSelection,this.rangeCount-1))&&!ai.rangesEqual(e,a)&&(a=new ah(e)),this._ranges[this.rangeCount-1]=a,ay(this,a,O(this.nativeSelection)),this.isCollapsed=al(this)):this.refresh()}}}:function(d,c){c&&Y?R(this,d):(this.nativeSelection.addRange(aw(d)),this.refresh())},U.setRanges=function(e){if(T&&e.length>1){ap(this,e)}else{this.removeAllRanges();for(var d=0,f=e.length;f>d;++d){this.addRange(e[d])}}}}else{if(!(aj.isHostMethod(ae,"empty")&&aj.isHostMethod(ab,"select")&&T&&ac)){return aB.fail("No means of selecting a Range or TextRange was found"),!1}U.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode){e=ak.getDocument(this.anchorNode)}else{if("Control"==this.docSelection.type){var d=this.docSelection.createRange();d.length&&(e=ak.getDocument(d.item(0)).body.createTextRange())}}e&&(e.body.createTextRange().select(),this.docSelection.empty())}}catch(f){}ax(this)},U.addRange=function(b){"Control"==this.docSelection.type?ar(this,b):(ah.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,ay(this,b,!1))},U.setRanges=function(d){this.removeAllRanges();var c=d.length;c>1?ap(this,d):c&&this.addRange(d[0])}}U.getRangeAt=function(b){if(0>b||b>=this.rangeCount){throw new ag("INDEX_SIZE_ERR")}return this._ranges[b]};var Q;if(ac){Q=function(a){var d;aC.isSelectionValid(a.win)?d=a.docSelection.createRange():(d=ak.getBody(a.win.document).createTextRange(),d.collapse(!0)),"Control"==a.docSelection.type?at(a):d&&"undefined"!=typeof d.text?au(a,d):ax(a)}}else{if(aj.isHostMethod(ae,"getRangeAt")&&"number"==typeof ae.rangeCount){Q=function(a){if(T&&ad&&"Control"==a.docSelection.type){at(a)}else{if(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount){for(var f=0,e=a.rangeCount;e>f;++f){a._ranges[f]=new aC.WrappedRange(a.nativeSelection.getRangeAt(f))}ay(a,a._ranges[a.rangeCount-1],O(a.nativeSelection)),a.isCollapsed=al(a)}else{ax(a)}}}}else{if(!Z||"boolean"!=typeof ae.isCollapsed||"boolean"!=typeof ab.collapsed||!aC.features.implementsDomRange){return aB.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1}Q=function(d){var c;c=d.nativeSelection,c.anchorNode?(c=S(c,0),d._ranges=[c],d.rangeCount=1,c=d.nativeSelection,d.anchorNode=c.anchorNode,d.anchorOffset=c.anchorOffset,d.focusNode=c.focusNode,d.focusOffset=c.focusOffset,d.isCollapsed=al(d)):ax(d)}}}U.refresh=function(d){var c=d?this._ranges.slice(0):null;if(Q(this),d){if(d=c.length,d!=this._ranges.length){return !1}for(;d--;){if(!ai.rangesEqual(c[d],this._ranges[d])){return !1}}return !0}};var P=function(h,f){var m=h.getAllRanges(),l=!1;h.removeAllRanges();for(var k=0,j=m.length;j>k;++k){l||f!==m[k]?h.addRange(m[k]):l=!0}h.rangeCount||ax(h)};U.removeRange=T?function(j){if("Control"==this.docSelection.type){for(var h,o=this.docSelection.createRange(),j=av(j),n=ak.getDocument(o.item(0)),n=ak.getBody(n).createControlRange(),m=!1,l=0,k=o.length;k>l;++l){h=o.item(l),h!==j||m?n.add(o.item(l)):m=!0}n.select(),at(this)}else{P(this,j)}}:function(b){P(this,b)};var O;!ac&&Z&&aC.features.implementsDomRange?(O=function(d){var c=!1;return d.anchorNode&&(c=1==ak.comparePoints(d.anchorNode,d.anchorOffset,d.focusNode,d.focusOffset)),c},U.isBackwards=function(){return O(this)}):O=U.isBackwards=function(){return !1},U.toString=function(){for(var e=[],d=0,f=this.rangeCount;f>d;++d){e[d]=""+this._ranges[d]}return e.join("")},U.collapse=function(a,f){ao(this,a);var e=aC.createRange(ak.getDocument(a));e.collapseToPoint(a,f),this.removeAllRanges(),this.addRange(e),this.isCollapsed=!0},U.collapseToStart=function(){if(!this.rangeCount){throw new ag("INVALID_STATE_ERR")}var b=this._ranges[0];this.collapse(b.startContainer,b.startOffset)},U.collapseToEnd=function(){if(!this.rangeCount){throw new ag("INVALID_STATE_ERR")}var b=this._ranges[this.rangeCount-1];this.collapse(b.endContainer,b.endOffset)},U.selectAllChildren=function(a){ao(this,a);var d=aC.createRange(ak.getDocument(a));d.selectNodeContents(a),this.removeAllRanges(),this.addRange(d)},U.deleteFromDocument=function(){if(T&&ad&&"Control"==this.docSelection.type){for(var e,d=this.docSelection.createRange();d.length;){e=d.item(0),d.remove(e),e.parentNode.removeChild(e)}this.refresh()}else{if(this.rangeCount){d=this.getAllRanges(),this.removeAllRanges(),e=0;for(var f=d.length;f>e;++e){d[e].deleteContents()}this.addRange(d[f-1])}}},U.getAllRanges=function(){return this._ranges.slice(0)},U.setSingleRange=function(b){this.setRanges([b])},U.containsNode=function(f,e){for(var h=0,g=this._ranges.length;g>h;++h){if(this._ranges[h].containsNode(f,e)){return !0}}return !1},U.toHtml=function(){var e="";if(this.rangeCount){for(var e=ai.getRangeDocument(this._ranges[0]).createElement("div"),d=0,f=this._ranges.length;f>d;++d){e.appendChild(this._ranges[d].cloneContents())}e=e.innerHTML}return e},U.getName=function(){return"WrappedSelection"},U.inspect=function(){return an(this)},U.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null},aq.inspect=an,aC.Selection=aq,aC.selectionPrototype=U,aC.addCreateMissingNativeApiListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return aC.getSelection(this)}),a=null})});var Base=function(){};Base.extend=function(h,g){var m=Base.prototype.extend;Base._prototyping=!0;var l=new this;m.call(l,h),l.base=function(){},delete Base._prototyping;var k=l.constructor,j=l.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==j){this._constructing=!0,k.apply(this,arguments),delete this._constructing}else{if(null!=arguments[0]){return(arguments[0].extend||m).call(arguments[0],l)}}}};return j.ancestor=this,j.extend=this.extend,j.forEach=this.forEach,j.implement=this.implement,j.prototype=l,j.toString=this.toString,j.valueOf=function(b){return"object"==b?j:k.valueOf()},m.call(j,g),"function"==typeof j.init&&j.init(),j},Base.prototype={extend:function(r,q){if(1<arguments.length){var p=this[r];if(p&&"function"==typeof q&&(!p.valueOf||p.valueOf()!=q.valueOf())&&/\bbase\b/.test(q)){var o=q.valueOf(),q=function(){var d=this.base||Base.prototype.base;this.base=p;var c=o.apply(this,arguments);return this.base=d,c};q.valueOf=function(b){return"object"==b?q:o},q.toString=Base.toString}this[r]=q}else{if(r){var n=Base.prototype.extend;!Base._prototyping&&"function"!=typeof this&&(n=this.extend||n);for(var m={toSource:null},l=["constructor","toString","valueOf"],k=Base._prototyping?0:1;j=l[k++];){r[j]!=m[j]&&n.call(this,j,r[j])}for(var j in r){m[j]||n.call(this,j,r[j])}}}return this}},Base=Base.extend({constructor:function(b){this.extend(b)}},{ancestor:Object,version:"1.1",forEach:function(f,e,h){for(var g in f){void 0===this.prototype[g]&&e.call(h,f[g],g,f)}},implement:function(){for(var b=0;b<arguments.length;b++){"function"==typeof arguments[b]?arguments[b](this.prototype):this.prototype.extend(arguments[b])}return this},toString:function(){return""+this.valueOf()}}),wysihtml5.browser=function(){var j=navigator.userAgent,h=document.createElement("div"),o=-1!==j.indexOf("MSIE")&&-1===j.indexOf("Opera"),n=-1!==j.indexOf("Gecko")&&-1===j.indexOf("KHTML"),m=-1!==j.indexOf("AppleWebKit/"),l=-1!==j.indexOf("Chrome/"),k=-1!==j.indexOf("Opera/");return{USER_AGENT:j,supported:function(){var b=this.USER_AGENT.toLowerCase(),p="contentEditable" in h,g=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,f=document.querySelector&&document.querySelectorAll,b=this.isIos()&&5>(/ipad|iphone|ipod/.test(b)&&b.match(/ os (\d+).+? like mac os x/)||[,0])[1]||-1!==b.indexOf("opera mobi")||-1!==b.indexOf("hpwos/");return p&&g&&f&&!b},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){var b=this.USER_AGENT.toLowerCase();return -1!==b.indexOf("webkit")&&-1!==b.indexOf("mobile")},supportsSandboxedIframes:function(){return o},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return !n},hasCurrentStyleProperty:function(){return"currentStyle" in h},insertsLineBreaksOnReturn:function(){return n},supportsPlaceholderAttributeOn:function(b){return"placeholder" in b},supportsEvent:function(b){var d;return(d="on"+b in h)||(h.setAttribute("on"+b,"return;"),d="function"==typeof h["on"+b]),d},supportsEventsInIframeCorrectly:function(){return !k},firesOnDropOnlyWhenOnDragOverIsCancelled:function(){return m||n},supportsDataTransfer:function(){try{return m&&(window.Clipboard||window.DataTransfer).prototype.getData}catch(b){return !1}},supportsHTML5Tags:function(b){return b=b.createElement("div"),b.innerHTML="<article>foo</article>","<article>foo</article>"===b.innerHTML.toLowerCase()},supportsCommand:function(){var d={formatBlock:o,insertUnorderedList:o||k||m,insertOrderedList:o||k||m},c={insertHTML:n};return function(p,g){if(!d[g]){try{return p.queryCommandSupported(g)}catch(b){}try{return p.queryCommandEnabled(g)}catch(a){return !!c[g]}}return !1}}(),doesAutoLinkingInContentEditable:function(){return o},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return n||k||m},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return n||o||k},clearsListsInContentEditableCorrectly:function(){return n||o||m},autoScrollsToCaret:function(){return !m},autoClosesUnclosedTags:function(){var b,d=h.cloneNode(!1);return d.innerHTML="<p><div></div>",d=d.innerHTML.toLowerCase(),b="<p></p><div></div>"===d||"<p><div></div></p>"===d,this.autoClosesUnclosedTags=function(){return b},b},supportsNativeGetElementsByClassName:function(){return -1!==(""+document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()},supportsClassList:function(){return"classList" in h},needsSpaceAfterLineBreak:function(){return k},supportsSpeechApiOn:function(a){return 11<=(j.match(/Chrome\/(\d+)/)||[,0])[1]&&("onwebkitspeechchange" in a||"speech" in a)},crashesWhenDefineProperty:function(b){return o&&("XMLHttpRequest"===b||"XDomainRequest"===b)},doesAsyncFocus:function(){return o},hasProblemsSettingCaretAfterImg:function(){return o},hasUndoInContextMenu:function(){return n||l||k}}}(),wysihtml5.lang.array=function(b){return{contains:function(a){if(b.indexOf){return -1!==b.indexOf(a)}for(var f=0,e=b.length;e>f;f++){if(b[f]===a){return !0}}return !1},without:function(a){for(var a=wysihtml5.lang.array(a),h=[],g=0,f=b.length;f>g;g++){a.contains(b[g])||h.push(b[g])}return h},get:function(){for(var a=0,f=b.length,e=[];f>a;a++){e.push(b[a])}return e}}},wysihtml5.lang.Dispatcher=Base.extend({observe:function(d,c){return this.events=this.events||{},this.events[d]=this.events[d]||[],this.events[d].push(c),this},on:function(){return this.observe.apply(this,wysihtml5.lang.array(arguments).get())},fire:function(f,e){this.events=this.events||{};for(var h=this.events[f]||[],g=0;g<h.length;g++){h[g].call(this,e)}return this},stopObserving:function(g,f){this.events=this.events||{};var k,j,h=0;if(g){for(k=this.events[g]||[],j=[];h<k.length;h++){k[h]!==f&&f&&j.push(k[h])}this.events[g]=j}else{this.events={}}return this}}),wysihtml5.lang.object=function(b){return{merge:function(a){for(var d in a){b[d]=a[d]}return this},get:function(){return b},clone:function(){var a,d={};for(a in b){d[a]=b[a]}return d},isArray:function(){return"[object Array]"===Object.prototype.toString.call(b)}}},function(){var d=/^\s+/,c=/\s+$/;wysihtml5.lang.string=function(a){return a=""+a,{trim:function(){return a.replace(d,"").replace(c,"")},interpolate:function(f){for(var e in f){a=this.replace("#{"+e+"}").by(f[e])}return a},replace:function(b){return{by:function(e){return a.split(b).join(e)}}}}}}(),function(k){function j(b){return b.replace(o,function(g,f){var s=(f.match(n)||[])[1]||"",r=l[s],f=f.replace(n,"");f.split(r).length>f.split(s).length&&(f+=s,s="");var h=r=f;return f.length>m&&(h=h.substr(0,m)+"..."),"www."===r.substr(0,4)&&(r="http://"+r),'<a href="'+r+'">'+h+"</a>"+s})}function q(d){if(!p.contains(d.nodeName)){if(d.nodeType!==k.TEXT_NODE||!d.data.match(o)){for(b=k.lang.array(d.childNodes).get(),c=b.length,a=0;c>a;a++){q(b[a])}return d}var c,b=d.parentNode;c=b.ownerDocument;var a=c._wysihtml5_tempElement;for(a||(a=c._wysihtml5_tempElement=c.createElement("div")),c=a,c.innerHTML="<span></span>"+j(d.data),c.removeChild(c.firstChild);c.firstChild;){b.insertBefore(c.firstChild,d)}b.removeChild(d)}}var p=k.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")),o=/((https?:\/\/|www\.)[^\s<]{3,})/gi,n=/([^\w\/\-](,?))$/i,m=100,l={")":"(","]":"[","}":"{"};k.dom.autoLink=function(d){var c;d:{c=d;for(var f;c.parentNode;){if(c=c.parentNode,f=c.nodeName,p.contains(f)){c=!0;break d}if("body"===f){break}}c=!1}return c?d:(d===d.ownerDocument.documentElement&&(d=d.ownerDocument.body),q(d))},k.dom.autoLink.URL_REG_EXP=o}(wysihtml5),function(e){var d=e.browser.supportsClassList(),f=e.dom;f.addClass=function(b,c){return d?b.classList.add(c):(f.hasClass(b,c)||(b.className+=" "+c),void 0)},f.removeClass=function(b,g){return d?b.classList.remove(g):(b.className=b.className.replace(RegExp("(^|\\s+)"+g+"(\\s+|$)")," "),void 0)},f.hasClass=function(b,h){if(d){return b.classList.contains(h)}var g=b.className;return 0<g.length&&(g==h||RegExp("(^|\\s)"+h+"(\\s|$)").test(g))}}(wysihtml5),wysihtml5.dom.contains=function(){var b=document.documentElement;return b.contains?function(d,c){return c.nodeType!==wysihtml5.ELEMENT_NODE&&(c=c.parentNode),d!==c&&d.contains(c)}:b.compareDocumentPosition?function(d,c){return !!(16&d.compareDocumentPosition(c))}:void 0}(),wysihtml5.dom.convertToList=function(){function b(e,d){var f=e.createElement("li");return d.appendChild(f),f}return function(w,v){if("UL"===w.nodeName||"OL"===w.nodeName||"MENU"===w.nodeName){return w}var u,s,r,q,p,o=w.ownerDocument,n=o.createElement(v),m=w.querySelectorAll("br"),a=m.length;for(p=0;a>p;p++){for(u=m[p];(s=u.parentNode)&&s!==w&&s.lastChild===u;){if("block"===wysihtml5.dom.getStyle("display").from(s)){s.removeChild(u);break}wysihtml5.dom.insert(u).after(u.parentNode)}}for(m=wysihtml5.lang.array(w.childNodes).get(),a=m.length,p=0;a>p;p++){q=q||b(o,n),u=m[p],s="block"===wysihtml5.dom.getStyle("display").from(u),r="BR"===u.nodeName,s?(q=q.firstChild?b(o,n):q,q.appendChild(u),q=null):r?q=q.firstChild?null:q:q.appendChild(u)}return w.parentNode.replaceChild(n,w),n}}(),wysihtml5.dom.copyAttributes=function(b){return{from:function(a){return{to:function(k){for(var j,h=0,g=b.length;g>h;h++){j=b[h],"undefined"!=typeof a[j]&&""!==a[j]&&(k[j]=a[j])}return{andTo:arguments.callee}}}}}},function(e){var d=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],f=function(h){var g;e:for(var b=0,a=d.length;a>b;b++){if("border-box"===e.getStyle(d[b]).from(h)){g=d[b];break e}}return g?parseInt(e.getStyle("width").from(h),10)<h.offsetWidth:!1};e.copyStyles=function(a){return{from:function(l){f(l)&&(a=wysihtml5.lang.array(a).without(d));for(var k,j="",c=a.length,b=0;c>b;b++){k=a[b],j+=k+":"+e.getStyle(k).from(l)+";"}return{to:function(g){return e.setStyles(j).on(g),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(b){b.dom.delegate=function(a,h,g,f){return b.dom.observe(a,g,function(j){for(var e=j.target,c=b.lang.array(a.querySelectorAll(h));e&&e!==a;){if(c.contains(e)){f.call(e,j);break}e=e.parentNode}})}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var b="abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");return function(a,m){var l,m=m||document;if("object"==typeof a&&a.nodeType){l=m.createElement("div"),l.appendChild(a)}else{if(wysihtml5.browser.supportsHTML5Tags(m)){l=m.createElement("div"),l.innerHTML=a}else{if(l=m,!l._wysihtml5_supportsHTML5Tags){for(var k=0,j=b.length;j>k;k++){l.createElement(b[k])}l._wysihtml5_supportsHTML5Tags=!0}l=m,k=l.createElement("div"),k.style.display="none",l.body.appendChild(k);try{k.innerHTML=a}catch(h){}l.body.removeChild(k),l=k}}return l}}(),wysihtml5.dom.getParentElement=function(){function b(d,c){return c&&c.length?"string"==typeof c?d===c:wysihtml5.lang.array(c).contains(d):!0}return function(a,o,n){if(n=n||50,o.className||o.classRegExp){b:{for(var m=o.nodeName,l=o.className,o=o.classRegExp;n--&&a&&"BODY"!==a.nodeName;){var k;if((k=a.nodeType===wysihtml5.ELEMENT_NODE)&&(k=b(a.nodeName,m))){k=l;var j=(a.className||"").match(o)||[];k=k?j[j.length-1]===k:!!j.length}if(k){break b}a=a.parentNode}a=null}return a}b:{for(m=o.nodeName,l=n;l--&&a&&"BODY"!==a.nodeName;){if(b(a.nodeName,m)){break b}a=a.parentNode}a=null}return a}}(),wysihtml5.dom.getStyle=function(){function e(b){return b.replace(f,function(c){return c.charAt(1).toUpperCase()})}var d={"float":"styleFloat" in document.createElement("div").style?"styleFloat":"cssFloat"},f=/\-[a-z]/g;return function(a){return{from:function(q){if(q.nodeType===wysihtml5.ELEMENT_NODE){var p=q.ownerDocument,o=d[a]||e(a),n=q.style,m=q.currentStyle,l=n[o];if(l){return l}if(m){try{return m[o]}catch(c){}}var b,o=p.defaultView||p.parentWindow,p=("height"===a||"width"===a)&&"TEXTAREA"===q.nodeName;if(o.getComputedStyle){return p&&(b=n.overflow,n.overflow="hidden"),q=o.getComputedStyle(q,null).getPropertyValue(a),p&&(n.overflow=b||""),q}}}}}}(),wysihtml5.dom.hasElementWithTagName=function(){var d={},c=1;return function(h,g){var b=(h._wysihtml5_identifier||(h._wysihtml5_identifier=c++))+":"+g,a=d[b];return a||(a=d[b]=h.getElementsByTagName(g)),0<a.length}}(),function(e){var d={},f=1;e.dom.hasElementWithClassName=function(h,c){if(!e.browser.supportsNativeGetElementsByClassName()){return !!h.querySelector("."+c)}var b=(h._wysihtml5_identifier||(h._wysihtml5_identifier=f++))+":"+c,a=d[b];return a||(a=d[b]=h.getElementsByClassName(c)),0<a.length}}(wysihtml5),wysihtml5.dom.insert=function(b){return{after:function(a){a.parentNode.insertBefore(b,a.nextSibling)},before:function(a){a.parentNode.insertBefore(b,a)},into:function(a){a.appendChild(b)}}},wysihtml5.dom.insertCSS=function(b){return b=b.join("\n"),{into:function(a){var f=a.head||a.getElementsByTagName("head")[0],e=a.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=b:e.appendChild(a.createTextNode(b)),f&&f.appendChild(e)}}},wysihtml5.dom.observe=function(j,h,o){for(var n,m,h="string"==typeof h?[h]:h,l=0,k=h.length;k>l;l++){m=h[l],j.addEventListener?j.addEventListener(m,o,!1):(n=function(a){"target" in a||(a.target=a.srcElement),a.preventDefault=a.preventDefault||function(){this.returnValue=!1},a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=!0},o.call(j,a)},j.attachEvent("on"+m,n))}return{stop:function(){for(var c,b=0,a=h.length;a>b;b++){c=h[b],j.removeEventListener?j.removeEventListener(c,o,!1):j.detachEvent("on"+c,n)}}}},wysihtml5.dom.parse=function(){function u(a,w){var v,j=a.childNodes,d=j.length;v=r[a.nodeType];var c=0;if(v=v&&v(a),!v){return null}for(c=0;d>c;c++){(newChild=u(j[c],w))&&v.appendChild(newChild)}return w&&1>=v.childNodes.length&&v.nodeName.toLowerCase()===q&&!v.attributes.length?v.firstChild:v}function s(g,f){var v,f=f.toLowerCase();if((v="IMG"==g.nodeName)&&(v="src"==f)){var j;try{j=g.complete&&!g.mozMatchesSelector(":-moz-broken")}catch(h){g.complete&&"complete"===g.readyState&&(j=!0)}v=!0===j}return v?g.src:m&&"outerHTML" in g?-1!=g.outerHTML.toLowerCase().indexOf(" "+f+"=")?g.getAttribute(f):null:g.getAttribute(f)}var r={1:function(B){var A,z,y=n.tags;if(z=B.nodeName.toLowerCase(),A=B.scopeName,B._wysihtml5){return null}if(B._wysihtml5=1,"wysihtml5-temp"===B.className){return null}if(A&&"HTML"!=A&&(z=A+":"+z),"outerHTML" in B&&!wysihtml5.browser.autoClosesUnclosedTags()&&"P"===B.nodeName&&"</p>"!==B.outerHTML.slice(-4).toLowerCase()&&(z="div"),z in y){if(A=y[z],!A||A.remove){return null}A="string"==typeof A?{rename_tag:A}:A}else{if(!B.firstChild){return null}A={rename_tag:q}}z=B.ownerDocument.createElement(A.rename_tag||z);var y={},x=A.set_class,w=A.add_class,v=A.set_attributes,j=A.check_attributes,g=n.classes,e=0,d=[];A=[];var b,E=[],D=[];if(v&&(y=wysihtml5.lang.object(v).clone()),j){for(b in j){(v=l[j[b]])&&(v=v(s(B,b)),"string"==typeof v&&(y[b]=v))}}if(x&&d.push(x),w){for(b in w){(v=k[w[b]])&&(x=v(s(B,b)),"string"==typeof x&&d.push(x))}}for(g["_wysihtml5-temp-placeholder"]=1,(D=B.getAttribute("class"))&&(d=d.concat(D.split(p))),w=d.length;w>e;e++){B=d[e],g[B]&&A.push(B)}for(g=A.length;g--;){B=A[g],wysihtml5.lang.array(E).contains(B)||E.unshift(B)}E.length&&(y["class"]=E.join(" "));for(b in y){try{z.setAttribute(b,y[b])}catch(C){}}return y.src&&("undefined"!=typeof y.width&&z.setAttribute("width",y.width),"undefined"!=typeof y.height&&z.setAttribute("height",y.height)),z},3:function(b){return b.ownerDocument.createTextNode(b.data)}},q="span",p=/\s+/,o={tags:{},classes:{}},n={},m=!wysihtml5.browser.supportsGetAttributeCorrectly(),l={url:function(){var b=/^https?:\/\//i;return function(a){return a&&a.match(b)?a.replace(b,function(c){return c.toLowerCase()}):null}}(),alt:function(){var b=/[^ a-z0-9_\-]/gi;return function(a){return a?a.replace(b,""):""}}(),numbers:function(){var b=/\D/g;return function(a){return(a=(a||"").replace(b,""))||null}}()},k={align_img:function(){var b={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(a){return b[(""+a).toLowerCase()]}}(),align_text:function(){var b={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(a){return b[(""+a).toLowerCase()]}}(),clear_br:function(){var b={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(a){return b[(""+a).toLowerCase()]}}(),size_font:function(){var b={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(a){return b[(""+a).charAt(0)]}}()};return function(a,v,j,g){wysihtml5.lang.object(n).merge(o).merge(v).get();for(var j=j||a.ownerDocument||document,v=j.createDocumentFragment(),f="string"==typeof a,a=f?wysihtml5.dom.getAsDom(a,j):a;a.firstChild;){j=a.firstChild,a.removeChild(j),(j=u(j,g))&&v.appendChild(j)}return a.innerHTML="",a.appendChild(v),f?wysihtml5.quirks.getCorrectInnerHTML(a):a}}(),wysihtml5.dom.removeEmptyTextNodes=function(f){for(var e=wysihtml5.lang.array(f.childNodes).get(),h=e.length,g=0;h>g;g++){f=e[g],f.nodeType===wysihtml5.TEXT_NODE&&""===f.data&&f.parentNode.removeChild(f)}},wysihtml5.dom.renameElement=function(f,e){for(var h,g=f.ownerDocument.createElement(e);h=f.firstChild;){g.appendChild(h)}return wysihtml5.dom.copyAttributes(["align","className"]).from(f).to(g),f.parentNode.replaceChild(g,f),g},wysihtml5.dom.replaceWithChildNodes=function(d){if(d.parentNode){if(d.firstChild){for(var c=d.ownerDocument.createDocumentFragment();d.firstChild;){c.appendChild(d.firstChild)}d.parentNode.replaceChild(c,d)}else{d.parentNode.removeChild(d)}}},function(d){function c(f){var e=f.ownerDocument.createElement("br");f.appendChild(e)}d.resolveList=function(m){if("MENU"===m.nodeName||"UL"===m.nodeName||"OL"===m.nodeName){var l,k,j,b=m.ownerDocument.createDocumentFragment(),a=m.previousElementSibling||m.previousSibling;for(a&&"block"!==d.getStyle("display").from(a)&&c(b);j=m.firstChild;){for(l=j.lastChild;a=j.firstChild;){k=(k=a===l)&&"block"!==d.getStyle("display").from(a)&&"BR"!==a.nodeName,b.appendChild(a),k&&c(b)}j.parentNode.removeChild(j)}m.parentNode.replaceChild(b,m)}}}(wysihtml5.dom),function(g){var f=document,k="parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "),j="open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "),h=["referrer","write","open","close"];g.dom.Sandbox=Base.extend({constructor:function(a,d){this.callback=a||g.EMPTY_FUNCTION,this.config=g.lang.object({}).merge(d).get(),this.iframe=this._createIframe()},insertInto:function(b){"string"==typeof b&&(b=f.getElementById(b)),b.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var b=this.getIframe();b.parentNode.removeChild(b)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var b=this,a=f.createElement("iframe");return a.className="wysihtml5-sandbox",g.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(a),g.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(a.src="javascript:'<html></html>'"),a.onload=function(){a.onreadystatechange=a.onload=null,b._onLoadIframe(a)},a.onreadystatechange=function(){/loaded|complete/.test(a.readyState)&&(a.onreadystatechange=a.onload=null,b._onLoadIframe(a))},a},_onLoadIframe:function(l){if(g.dom.contains(f.documentElement,l)){var e=this,d=l.contentWindow,c=l.contentWindow.document,b=this._getHtml({charset:f.characterSet||f.charset||"utf-8",stylesheets:this.config.stylesheets});if(c.open("text/html","replace"),c.write(b),c.close(),this.getWindow=function(){return l.contentWindow},this.getDocument=function(){return l.contentWindow.document},d.onerror=function(n,m,o){throw Error("wysihtml5.Sandbox: "+n,m,o)},!g.browser.supportsSandboxedIframes()){var a,b=0;for(a=k.length;a>b;b++){this._unset(d,k[b])}for(b=0,a=j.length;a>b;b++){this._unset(d,j[b],g.EMPTY_FUNCTION)}for(b=0,a=h.length;a>b;b++){this._unset(c,h[b])}this._unset(c,"cookie","",!0)}this.loaded=!0,setTimeout(function(){e.callback(e)},0)}},_getHtml:function(a){var o,n=a.stylesheets,m="",l=0;if(n="string"==typeof n?[n]:n){for(o=n.length;o>l;l++){m+='<link rel="stylesheet" href="'+n[l]+'">'}}return a.stylesheets=m,g.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(a)},_unset:function(s,r,q,p){try{s[r]=q}catch(o){}try{s.__defineGetter__(r,function(){return q})}catch(n){}if(p){try{s.__defineSetter__(r,function(){})}catch(m){}}if(!g.browser.crashesWhenDefineProperty(r)){try{var l={get:function(){return q}};p&&(l.set=function(){}),Object.defineProperty(s,r,l)}catch(a){}}}})}(wysihtml5),function(){var b={className:"class"};wysihtml5.dom.setAttributes=function(a){return{on:function(f){for(var e in a){f.setAttribute(b[e]||e,a[e])}}}}}(),wysihtml5.dom.setStyles=function(b){return{on:function(a){if(a=a.style,"string"==typeof b){a.cssText+=";"+b}else{for(var d in b){"float"===d?(a.cssFloat=b[d],a.styleFloat=b[d]):a[d]=b[d]}}}}},function(b){b.simulatePlaceholder=function(a,k,j){var h=function(){k.hasPlaceholderSet()&&k.clear(),b.removeClass(k.element,"placeholder")},g=function(){k.isEmpty()&&(k.setValue(j),b.addClass(k.element,"placeholder"))};a.observe("set_placeholder",g).observe("unset_placeholder",h).observe("focus:composer",h).observe("paste:composer",h).observe("blur:composer",g),g()}}(wysihtml5.dom),function(d){var c=document.documentElement;"textContent" in c?(d.setTextContent=function(f,e){f.textContent=e},d.getTextContent=function(b){return b.textContent}):"innerText" in c?(d.setTextContent=function(f,e){f.innerText=e},d.getTextContent=function(b){return b.innerText}):(d.setTextContent=function(f,e){f.nodeValue=e},d.getTextContent=function(b){return b.nodeValue})}(wysihtml5.dom),wysihtml5.quirks.cleanPastedHTML=function(){var b={"a u":wysihtml5.dom.replaceWithChildNodes};return function(a,p,o){var n,m,l,p=p||b,o=o||a.ownerDocument||document,k="string"==typeof a,j=0,a=k?wysihtml5.dom.getAsDom(a,o):a;for(l in p){for(n=a.querySelectorAll(l),o=p[l],m=n.length;m>j;j++){o(n[j])}}return k?a.innerHTML:a}}(),function(d){var c=d.dom;d.quirks.ensureProperClearing=function(){var b=function(){var e=this;setTimeout(function(){var a=e.innerHTML.toLowerCase();("<p>&nbsp;</p>"==a||"<p>&nbsp;</p><p>&nbsp;</p>"==a)&&(e.innerHTML="")},0)};return function(a){c.observe(a.element,["cut","keydown"],b)}}(),d.quirks.ensureProperClearingOfLists=function(){var a=["OL","UL","MENU"];return function(b){c.observe(b.element,"keydown",function(h){if(h.keyCode===d.BACKSPACE_KEY){var g=b.selection.getSelectedNode(),h=b.element;h.firstChild&&d.lang.array(a).contains(h.firstChild.nodeName)&&(g=c.getParentElement(g,{nodeName:a}))&&g==h.firstChild&&1>=g.childNodes.length&&(g.firstChild?""===g.firstChild.innerHTML:1)&&g.parentNode.removeChild(g)}})}}()}(wysihtml5),function(b){b.quirks.getCorrectInnerHTML=function(a){var m=a.innerHTML;if(-1===m.indexOf("%7E")){return m}var l,k,j,h,a=a.querySelectorAll("[href*='~'], [src*='~']");for(h=0,j=a.length;j>h;h++){l=a[h].href||a[h].src,k=b.lang.string(l).replace("~").by("%7E"),m=b.lang.string(m).replace(k).by(l)}return m}}(wysihtml5),function(f){var e=f.dom,h="LI P H1 H2 H3 H4 H5 H6".split(" "),g=["UL","OL","MENU"];f.quirks.insertLineBreakOnReturn=function(b){function a(k){if(k=e.getParentElement(k,{nodeName:["P","DIV"]},2)){var j=document.createTextNode(f.INVISIBLE_SPACE);e.insert(j).before(k),e.replaceWithChildNodes(k),b.selection.selectNode(j)}}e.observe(b.element.ownerDocument,"keydown",function(j){var d=j.keyCode;if(!(j.shiftKey||d!==f.ENTER_KEY&&d!==f.BACKSPACE_KEY)){var c=b.selection.getSelectedNode();(c=e.getParentElement(c,{nodeName:h},4))?"LI"!==c.nodeName||d!==f.ENTER_KEY&&d!==f.BACKSPACE_KEY?c.nodeName.match(/H[1-6]/)&&d===f.ENTER_KEY&&setTimeout(function(){a(b.selection.getSelectedNode())},0):setTimeout(function(){var k,l=b.selection.getSelectedNode();l&&((k=e.getParentElement(l,{nodeName:g},2))||a(l))},0):d===f.ENTER_KEY&&!f.browser.insertsLineBreaksOnReturn()&&(b.commands.exec("insertLineBreak"),j.preventDefault())}})}}(wysihtml5),function(b){b.quirks.redraw=function(a){b.dom.addClass(a,"wysihtml5-quirks-redraw"),b.dom.removeClass(a,"wysihtml5-quirks-redraw");try{var f=a.ownerDocument;f.execCommand("italic",!1,null),f.execCommand("italic",!1,null)}catch(e){}}}(wysihtml5),function(d){var c=d.dom;d.Selection=Base.extend({constructor:function(b){window.rangy.init(),this.editor=b,this.composer=b.composer,this.doc=this.composer.doc},getBookmark:function(){var b=this.getRange();return b&&b.cloneRange()},setBookmark:function(b){b&&this.setSelection(b)},setBefore:function(f){var e=rangy.createRange(this.doc);return e.setStartBefore(f),e.setEndBefore(f),this.setSelection(e)},setAfter:function(f){var e=rangy.createRange(this.doc);return e.setStartAfter(f),e.setEndAfter(f),this.setSelection(e)},selectNode:function(n){var m=rangy.createRange(this.doc),l=n.nodeType===d.ELEMENT_NODE,k="canHaveHTML" in n?n.canHaveHTML:"IMG"!==n.nodeName,j=l?n.innerHTML:n.data,j=""===j||j===d.INVISIBLE_SPACE,b=c.getStyle("display").from(n),b="block"===b||"list-item"===b;if(j&&l&&k){try{n.innerHTML=d.INVISIBLE_SPACE}catch(a){}}k?m.selectNodeContents(n):m.selectNode(n),k&&j&&l?m.collapse(b):k&&j&&(m.setStartAfter(n),m.setEndAfter(n)),this.setSelection(m)},getSelectedNode:function(b){return b&&this.doc.selection&&"Control"===this.doc.selection.type&&(b=this.doc.selection.createRange())&&b.length?b.item(0):(b=this.getSelection(this.doc),b.focusNode===b.anchorNode?b.focusNode:(b=this.getRange(this.doc))?b.commonAncestorContainer:this.doc.body)},executeAndRestore:function(r,q){var p=this.doc.body,o=q&&p.scrollTop,n=q&&p.scrollLeft,m='<span class="_wysihtml5-temp-placeholder">'+d.INVISIBLE_SPACE+"</span>",l=this.getRange(this.doc);if(l){m=l.createContextualFragment(m),l.insertNode(m);try{r(l.startContainer,l.endContainer)}catch(k){setTimeout(function(){throw k},0)}(caretPlaceholder=this.doc.querySelector("._wysihtml5-temp-placeholder"))?(l=rangy.createRange(this.doc),l.selectNode(caretPlaceholder),l.deleteContents(),this.setSelection(l)):p.focus(),q&&(p.scrollTop=o,p.scrollLeft=n);try{caretPlaceholder.parentNode.removeChild(caretPlaceholder)}catch(a){}}else{r(p,p)}},executeAndRestoreSimple:function(u){var s,r,q,p=this.getRange(),o=this.doc.body;if(p){s=p.getNodes([3]),o=s[0]||p.startContainer,q=s[s.length-1]||p.endContainer,s=o===p.startContainer?p.startOffset:0,r=q===p.endContainer?p.endOffset:q.length;try{u(p.startContainer,p.endContainer)}catch(n){setTimeout(function(){throw n},0)}u=rangy.createRange(this.doc);try{u.setStart(o,s)}catch(m){}try{u.setEnd(q,r)}catch(l){}try{this.setSelection(u)}catch(k){}}else{u(o,o)}},insertHTML:function(f){var f=rangy.createRange(this.doc).createContextualFragment(f),e=f.lastChild;this.insertNode(f),e&&this.setAfter(e)},insertNode:function(f){var e=this.getRange();e&&e.insertNode(f)},surround:function(f){var e=this.getRange();if(e){try{e.surroundContents(f),this.selectNode(f)}catch(g){f.appendChild(e.extractContents()),e.insertNode(f)}}},scrollIntoView:function(){var a,h=this.doc,g=h.documentElement.scrollHeight>h.documentElement.offsetHeight;if((a=h._wysihtml5ScrollIntoViewElement)||(a=h.createElement("span"),a.innerHTML=d.INVISIBLE_SPACE),a=h._wysihtml5ScrollIntoViewElement=a,g){this.insertNode(a);var g=a,f=0;if(g.parentNode){do{f+=g.offsetTop||0,g=g.offsetParent}while(g)}g=f,a.parentNode.removeChild(a),g>h.body.scrollTop&&(h.body.scrollTop=g)}},selectLine:function(){d.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var b=this.doc.defaultView.getSelection();b.modify("extend","left","lineboundary"),b.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var h,g=this.doc.selection.createRange(),m=g.boundingTop,l=this.doc.body.scrollWidth;if(g.moveToPoint){for(0===m&&(h=this.doc.createElement("span"),this.insertNode(h),m=h.offsetTop,h.parentNode.removeChild(h)),m+=1,h=-10;l>h;h+=2){try{g.moveToPoint(h,m);break}catch(k){}}for(h=this.doc.selection.createRange();l>=0;l--){try{h.moveToPoint(l,m);break}catch(j){}}g.setEndPoint("EndToEnd",h),g.select()}},getText:function(){var b=this.getSelection();return b?b.toString():""},getNodes:function(f,e){var g=this.getRange();return g?g.getNodes([f],e):[]},getRange:function(){var b=this.getSelection();return b&&b.rangeCount&&b.getRangeAt(0)},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(b){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow).setSingleRange(b)}})}(wysihtml5),function(k,j){function q(b,d){return j.dom.isCharacterDataNode(b)?0==d?!!b.previousSibling:d==b.length?!!b.nextSibling:!0:d>0&&d<b.childNodes.length}function p(b,s,r){var h;if(j.dom.isCharacterDataNode(s)&&(0==r?(r=j.dom.getNodeIndex(s),s=s.parentNode):r==s.length?(r=j.dom.getNodeIndex(s)+1,s=s.parentNode):h=j.dom.splitDataNode(s,r)),!h){h=s.cloneNode(!1),h.id&&h.removeAttribute("id");for(var d;d=s.childNodes[r];){h.appendChild(d)}j.dom.insertAfter(h,s)}return s==b?h:p(b,h.parentNode,j.dom.getNodeIndex(h))}function o(a){this.firstTextNode=(this.isElementMerge=a.nodeType==k.ELEMENT_NODE)?a.lastChild:a,this.textNodes=[this.firstTextNode]}function n(f,e,h,g){this.tagNames=f||[m],this.cssClass=e||"",this.similarClassRegExp=h,this.normalize=g,this.applyToAnyTagName=!1}var m="span",l=/\s+/g;o.prototype={doMerge:function(){for(var g,f,s=[],r=0,h=this.textNodes.length;h>r;++r){g=this.textNodes[r],f=g.parentNode,s[r]=g.data,r&&(f.removeChild(g),f.hasChildNodes()||f.parentNode.removeChild(f))}return this.firstTextNode.data=s=s.join("")},getLength:function(){for(var d=this.textNodes.length,c=0;d--;){c+=this.textNodes[d].length}return c},toString:function(){for(var e=[],d=0,f=this.textNodes.length;f>d;++d){e[d]="'"+this.textNodes[d].data+"'"}return"[Merge("+e.join(",")+")]"}},n.prototype={getAncestorWithClass:function(f){for(var b;f;){if(this.cssClass){if(b=this.cssClass,f.className){var a=f.className.match(this.similarClassRegExp)||[];b=a[a.length-1]===b}else{b=!1}}else{b=!0}if(f.nodeType==k.ELEMENT_NODE&&j.dom.arrayContains(this.tagNames,f.tagName.toLowerCase())&&b){return f}f=f.parentNode}return !1},postApply:function(E,D){for(var C,B,A,z=E[0],y=E[E.length-1],x=[],w=z,v=y,u=0,s=y.length,r=0,e=E.length;e>r;++r){B=E[r],(A=this.getAdjacentMergeableTextNode(B.parentNode,!1))?(C||(C=new o(A),x.push(C)),C.textNodes.push(B),B===z&&(w=C.firstTextNode,u=w.length),B===y&&(v=C.firstTextNode,s=C.getLength())):C=null}if((z=this.getAdjacentMergeableTextNode(y.parentNode,!0))&&(C||(C=new o(y),x.push(C)),C.textNodes.push(z)),x.length){for(r=0,e=x.length;e>r;++r){x[r].doMerge()}D.setStart(w,u),D.setEnd(v,s)}},getAdjacentMergeableTextNode:function(a,s){var r=a.nodeType==k.TEXT_NODE,h=r?a.parentNode:a,g=s?"nextSibling":"previousSibling";if(r){if((r=a[g])&&r.nodeType==k.TEXT_NODE){return r}}else{if((r=h[g])&&this.areElementsMergeable(a,r)){return r[s?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(b,v){var u;if((u=j.dom.arrayContains(this.tagNames,(b.tagName||"").toLowerCase()))&&(u=j.dom.arrayContains(this.tagNames,(v.tagName||"").toLowerCase()))&&(u=b.className.replace(l," ")==v.className.replace(l," "))){b:if(b.attributes.length!=v.attributes.length){u=!1}else{u=0;for(var s,r,h=b.attributes.length;h>u;++u){if(s=b.attributes[u],r=s.name,"class"!=r&&(r=v.attributes.getNamedItem(r),s.specified!=r.specified||s.specified&&s.nodeValue!==r.nodeValue)){u=!1;break b}}u=!0}}return u},createContainer:function(b){return b=b.createElement(this.tagNames[0]),this.cssClass&&(b.className=this.cssClass),b},applyToTextNode:function(b){var d=b.parentNode;1==d.childNodes.length&&j.dom.arrayContains(this.tagNames,d.tagName.toLowerCase())?this.cssClass&&(b=this.cssClass,d.className?(d.className&&(d.className=d.className.replace(this.similarClassRegExp,"")),d.className+=" "+b):d.className=b):(d=this.createContainer(j.dom.getDocument(b)),b.parentNode.insertBefore(d,b),d.appendChild(b))},isRemovable:function(a){return j.dom.arrayContains(this.tagNames,a.tagName.toLowerCase())&&k.lang.string(a.className).trim()==this.cssClass},undoToTextNode:function(d,c,f){if(c.containsNode(f)||(d=c.cloneRange(),d.selectNode(f),d.isPointInRange(c.endContainer,c.endOffset)&&q(c.endContainer,c.endOffset)&&(p(f,c.endContainer,c.endOffset),c.setEndAfter(f)),d.isPointInRange(c.startContainer,c.startOffset)&&q(c.startContainer,c.startOffset)&&(f=p(f,c.startContainer,c.startOffset))),this.similarClassRegExp&&f.className&&(f.className=f.className.replace(this.similarClassRegExp,"")),this.isRemovable(f)){for(c=f,f=c.parentNode;c.firstChild;){f.insertBefore(c.firstChild,c)}f.removeChild(c)}},applyToRange:function(a){var v=a.getNodes([k.TEXT_NODE]);if(!v.length){try{var u=this.createContainer(a.endContainer.ownerDocument);return a.surroundContents(u),this.selectNode(a,u),void 0}catch(s){}}if(a.splitBoundaries(),v=a.getNodes([k.TEXT_NODE]),v.length){for(var r=0,h=v.length;h>r;++r){u=v[r],this.getAncestorWithClass(u)||this.applyToTextNode(u)}a.setStart(v[0],0),u=v[v.length-1],a.setEnd(u,u.length),this.normalize&&this.postApply(v,a)}},undoToRange:function(a){var v,u,s=a.getNodes([k.TEXT_NODE]);s.length?(a.splitBoundaries(),s=a.getNodes([k.TEXT_NODE])):(s=a.endContainer.ownerDocument.createTextNode(k.INVISIBLE_SPACE),a.insertNode(s),a.selectNode(s),s=[s]);for(var r=0,h=s.length;h>r;++r){v=s[r],(u=this.getAncestorWithClass(v))&&this.undoToTextNode(v,a,u)}1==h?this.selectNode(a,s[0]):(a.setStart(s[0],0),v=s[s.length-1],a.setEnd(v,v.length),this.normalize&&this.postApply(s,a))},selectNode:function(a,v){var u=v.nodeType===k.ELEMENT_NODE,s="canHaveHTML" in v?v.canHaveHTML:!0,r=u?v.innerHTML:v.data;if((r=""===r||r===k.INVISIBLE_SPACE)&&u&&s){try{v.innerHTML=k.INVISIBLE_SPACE}catch(h){}}a.selectNodeContents(v),r&&u?a.collapse(!1):r&&(a.setStartAfter(v),a.setEndAfter(v))},getTextSelectedByRange:function(f,e){var h=e.cloneRange();h.selectNodeContents(f);var g=h.intersection(e),g=g?g.toString():"";return h.detach(),g},isAppliedToRange:function(a){var x,w=[],v=a.getNodes([k.TEXT_NODE]);if(!v.length){return(x=this.getAncestorWithClass(a.startContainer))?[x]:!1}for(var u,s=0,r=v.length;r>s;++s){if(u=this.getTextSelectedByRange(v[s],a),x=this.getAncestorWithClass(v[s]),""!=u&&!x){return !1}w.push(x)}return w},toggleRange:function(b){this.isAppliedToRange(b)?this.undoToRange(b):this.applyToRange(b)}},k.selection.HTMLApplier=n}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(b){this.editor=b,this.composer=b.composer,this.doc=this.composer.doc},support:function(b){return wysihtml5.browser.supportsCommand(this.doc,b)},exec:function(j,h){var o=wysihtml5.commands[j],n=wysihtml5.lang.array(arguments).get(),m=o&&o.exec,l=null;if(this.editor.fire("beforecommand:composer"),m){n.unshift(this.composer),l=m.apply(o,n)}else{try{l=this.doc.execCommand(j,!1,h)}catch(k){}}return this.editor.fire("aftercommand:composer"),l},state:function(g){var f=wysihtml5.commands[g],k=wysihtml5.lang.array(arguments).get(),j=f&&f.state;if(j){return k.unshift(this.composer),j.apply(f,k)}try{return this.doc.queryCommandState(g)}catch(h){return !1}},value:function(f){var e=wysihtml5.commands[f],h=e&&e.value;if(h){return h.call(e,this.composer,f)}try{return this.doc.queryCommandValue(f)}catch(g){return null}}}),function(b){b.commands.bold={exec:function(a,d){return b.commands.formatInline.exec(a,d,"b")},state:function(a,d){return b.commands.formatInline.state(a,d,"b")},value:function(){}}}(wysihtml5),function(g){function f(a,p){var o,n,m,e=a.doc,d="_wysihtml5-temp-"+ +new Date,c=0;for(g.commands.formatInline.exec(a,k,j,d,/non-matching-class/g),o=e.querySelectorAll(j+"."+d),d=o.length;d>c;c++){for(m in n=o[c],n.removeAttribute("class"),p){n.setAttribute(m,p[m])}}c=n,1===d&&(m=h.getTextContent(n),d=!!n.querySelector("*"),m=""===m||m===g.INVISIBLE_SPACE,!d&&m&&(h.setTextContent(n,p.text||n.href),e=e.createTextNode(" "),a.selection.setAfter(n),a.selection.insertNode(e),c=e)),a.selection.setAfter(c)}var k,j="A",h=g.dom;g.commands.createLink={exec:function(b,m,l){var e=this.state(b,m);e?b.selection.executeAndRestore(function(){for(var o,n,r,q=e.length,p=0;q>p;p++){o=e[p],n=h.getParentElement(o,{nodeName:"code"}),r=h.getTextContent(o),r.match(h.autoLink.URL_REG_EXP)&&!n?h.renameElement(o,"code"):h.replaceWithChildNodes(o)}}):(l="object"==typeof l?l:{href:l},f(b,l))},state:function(a,d){return g.commands.formatInline.state(a,d,"A")},value:function(){return k}}}(wysihtml5),function(d){var c=/wysiwyg-font-size-[a-z\-]+/g;d.commands.fontSize={exec:function(f,b,a){return d.commands.formatInline.exec(f,b,"span","wysiwyg-font-size-"+a,c)},state:function(f,b,a){return d.commands.formatInline.state(f,b,"span","wysiwyg-font-size-"+a,c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-color-[a-z]+/g;d.commands.foreColor={exec:function(f,b,a){return d.commands.formatInline.exec(f,b,"span","wysiwyg-color-"+a,c)},state:function(f,b,a){return d.commands.formatInline.state(f,b,"span","wysiwyg-color-"+a,c)},value:function(){}}}(wysihtml5),function(k){function j(a){for(a=a.previousSibling;a&&a.nodeType===k.TEXT_NODE&&!k.lang.string(a.data).trim();){a=a.previousSibling}return a}function q(a){for(a=a.nextSibling;a&&a.nodeType===k.TEXT_NODE&&!k.lang.string(a.data).trim();){a=a.nextSibling}return a}function p(b){return"BR"===b.nodeName||"block"===m.getStyle("display").from(b)?!0:!1}function o(a,s,r,h){if(h){var g=m.observe(a,"DOMNodeInserted",function(d){var e,d=d.target;d.nodeType===k.ELEMENT_NODE&&(e=m.getStyle("display").from(d),"inline"!==e.substr(0,6)&&(d.className+=" "+h))})}a.execCommand(s,!1,r),g&&g.stop()}function n(b,h){b.selection.selectLine(),b.selection.surround(h);var g=q(h),c=j(h);g&&"BR"===g.nodeName&&g.parentNode.removeChild(g),c&&"BR"===c.nodeName&&c.parentNode.removeChild(c),(g=h.lastChild)&&"BR"===g.nodeName&&g.parentNode.removeChild(g),b.selection.selectNode(h)}var m=k.dom,l="H1 H2 H3 H4 H5 H6 P BLOCKQUOTE DIV".split(" ");k.commands.formatBlock={exec:function(e,d,c,b,a){var h,g=e.doc,f=this.state(e,d,c,b,a),c="string"==typeof c?c.toUpperCase():c;if(f){e.selection.executeAndRestoreSimple(function(){a&&(f.className=f.className.replace(a,""));var v=!!k.lang.string(f.className).trim();if(v||f.nodeName!==(c||"DIV")){v&&m.renameElement(f,"DIV")}else{var v=f,u=v.ownerDocument,s=q(v),r=j(v);s&&!p(s)&&v.parentNode.insertBefore(u.createElement("br"),s),r&&!p(r)&&v.parentNode.insertBefore(u.createElement("br"),v),m.replaceWithChildNodes(f)}})}else{if((null===c||k.lang.array(l).contains(c))&&(h=e.selection.getSelectedNode(),f=m.getParentElement(h,{nodeName:l}))){return e.selection.executeAndRestoreSimple(function(){if(c&&(f=m.renameElement(f,c)),b){var r=f;r.className?(r.className=r.className.replace(a,""),r.className+=" "+b):r.className=b}}),void 0}e.commands.support(d)?o(g,d,c||"DIV",b):(f=g.createElement(c||"DIV"),b&&(f.className=b),n(e,f))}},state:function(g,f,s,r,h){return s="string"==typeof s?s.toUpperCase():s,g=g.selection.getSelectedNode(),m.getParentElement(g,{nodeName:s,className:r,classRegExp:h})},value:function(){}}}(wysihtml5),function(f){function e(a,n,m){var l=a+":"+n;if(!g[l]){var k=g,d=f.selection.HTMLApplier,c=h[a],a=c?[a.toLowerCase(),c.toLowerCase()]:[a.toLowerCase()];k[l]=new d(a,n,m,!0)}return g[l]}var h={strong:"b",em:"i",b:"strong",i:"em"},g={};f.commands.formatInline={exec:function(b,m,l,k,j){return(m=b.selection.getRange())?(e(l,k,j).toggleRange(m),b.selection.setSelection(m),void 0):!1},state:function(l,k,j,c,b){var k=l.doc,a=h[j]||j;return !f.dom.hasElementWithTagName(k,j)&&!f.dom.hasElementWithTagName(k,a)||c&&!f.dom.hasElementWithClassName(k,c)?!1:(l=l.selection.getRange(),l?e(j,c,b).isAppliedToRange(l):!1)},value:function(){}}}(wysihtml5),function(b){b.commands.insertHTML={exec:function(e,d,f){e.commands.support(d)?e.doc.execCommand(d,!1,f):e.selection.insertHTML(f)},state:function(){return !1},value:function(){}}}(wysihtml5),function(b){b.commands.insertImage={exec:function(a,k,j){var h,j="object"==typeof j?j:{src:j},g=a.doc,k=this.state(a);if(k){a.selection.setBefore(k),j=k.parentNode,j.removeChild(k),b.dom.removeEmptyTextNodes(j),"A"===j.nodeName&&!j.firstChild&&(a.selection.setAfter(j),j.parentNode.removeChild(j)),b.quirks.redraw(a.element)}else{k=g.createElement("IMG");for(h in j){k[h]=j[h]}a.selection.insertNode(k),b.browser.hasProblemsSettingCaretAfterImg()?(j=g.createTextNode(b.INVISIBLE_SPACE),a.selection.insertNode(j),a.selection.setAfter(j)):a.selection.setAfter(k)}},state:function(a){var d;return b.dom.hasElementWithTagName(a.doc,"IMG")?(d=a.selection.getSelectedNode())?"IMG"===d.nodeName?d:d.nodeType!==b.ELEMENT_NODE?!1:(d=a.selection.getText(),(d=b.lang.string(d).trim())?!1:(a=a.selection.getNodes(b.ELEMENT_NODE,function(c){return"IMG"===c.nodeName}),1!==a.length?!1:a[0])):!1:!1},value:function(c){return(c=this.state(c))&&c.src}}}(wysihtml5),function(d){var c="<br>"+(d.browser.needsSpaceAfterLineBreak()?" ":"");d.commands.insertLineBreak={exec:function(b,a){b.commands.support(a)?(b.doc.execCommand(a,!1,null),d.browser.autoScrollsToCaret()||b.selection.scrollIntoView()):b.commands.exec("insertHTML",c)},state:function(){return !1},value:function(){}}}(wysihtml5),function(b){b.commands.insertOrderedList={exec:function(a,o){var n,m=a.doc,l=a.selection.getSelectedNode(),k=b.dom.getParentElement(l,{nodeName:"OL"}),j=b.dom.getParentElement(l,{nodeName:"UL"}),l="_wysihtml5-temp-"+(new Date).getTime();a.commands.support(o)?m.execCommand(o,!1,null):k?a.selection.executeAndRestoreSimple(function(){b.dom.resolveList(k)}):j?a.selection.executeAndRestoreSimple(function(){b.dom.renameElement(j,"ol")}):(a.commands.exec("formatBlock","div",l),n=m.querySelector("."+l),m=""===n.innerHTML||n.innerHTML===b.INVISIBLE_SPACE,a.selection.executeAndRestoreSimple(function(){k=b.dom.convertToList(n,"ol")}),m&&a.selection.selectNode(k.querySelector("li")))},state:function(a){return a=a.selection.getSelectedNode(),b.dom.getParentElement(a,{nodeName:"OL"})},value:function(){}}}(wysihtml5),function(b){b.commands.insertUnorderedList={exec:function(a,o){var n,m=a.doc,l=a.selection.getSelectedNode(),k=b.dom.getParentElement(l,{nodeName:"UL"}),j=b.dom.getParentElement(l,{nodeName:"OL"}),l="_wysihtml5-temp-"+(new Date).getTime();a.commands.support(o)?m.execCommand(o,!1,null):k?a.selection.executeAndRestoreSimple(function(){b.dom.resolveList(k)}):j?a.selection.executeAndRestoreSimple(function(){b.dom.renameElement(j,"ul")}):(a.commands.exec("formatBlock","div",l),n=m.querySelector("."+l),m=""===n.innerHTML||n.innerHTML===b.INVISIBLE_SPACE,a.selection.executeAndRestoreSimple(function(){k=b.dom.convertToList(n,"ul")}),m&&a.selection.selectNode(k.querySelector("li")))},state:function(a){return a=a.selection.getSelectedNode(),b.dom.getParentElement(a,{nodeName:"UL"})},value:function(){}}}(wysihtml5),function(b){b.commands.italic={exec:function(a,d){return b.commands.formatInline.exec(a,d,"i")},state:function(a,d){return b.commands.formatInline.state(a,d,"i")},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyCenter={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-center",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-center",c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyLeft={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-left",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-left",c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyRight={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-right",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-right",c)},value:function(){}}}(wysihtml5),function(b){b.commands.underline={exec:function(a,d){return b.commands.formatInline.exec(a,d,"u")},state:function(a,d){return b.commands.formatInline.state(a,d,"u")},value:function(){}}}(wysihtml5),function(f){var e='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+f.INVISIBLE_SPACE+"</span>",h='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+f.INVISIBLE_SPACE+"</span>",g=f.dom;f.UndoManager=f.lang.Dispatcher.extend({constructor:function(b){this.editor=b,this.composer=b.composer,this.element=this.composer.element,this.history=[this.composer.getValue()],this.position=1,this.composer.commands.support("insertHTML")&&this._observe()},_observe:function(){var l,k=this,d=this.composer.sandbox.getDocument();if(g.observe(this.element,"keydown",function(m){if(!m.altKey&&(m.ctrlKey||m.metaKey)){var j=m.keyCode,n=90===j&&m.shiftKey||89===j;90!==j||m.shiftKey?n&&(k.redo(),m.preventDefault()):(k.undo(),m.preventDefault())}}),g.observe(this.element,"keydown",function(j){j=j.keyCode,j!==l&&(l=j,(8===j||46===j)&&k.transact())}),f.browser.hasUndoInContextMenu()){var c,b,a=function(){for(var j;j=d.querySelector("._wysihtml5-temp");){j.parentNode.removeChild(j)}clearInterval(c)};g.observe(this.element,"contextmenu",function(){a(),k.composer.selection.executeAndRestoreSimple(function(){k.element.lastChild&&k.composer.selection.setAfter(k.element.lastChild),d.execCommand("insertHTML",!1,e),d.execCommand("insertHTML",!1,h),d.execCommand("undo",!1,null)}),c=setInterval(function(){d.getElementById("_wysihtml5-redo")?(a(),k.redo()):d.getElementById("_wysihtml5-undo")||(a(),k.undo())},400),b||(b=!0,g.observe(document,"mousedown",a),g.observe(d,["mousedown","paste","cut","copy"],a))})}this.editor.observe("newword:composer",function(){k.transact()}).observe("beforecommand:composer",function(){k.transact()})},transact:function(){var d=this.history[this.position-1],c=this.composer.getValue();c!=d&&(40<(this.history.length=this.position)&&(this.history.shift(),this.position--),this.position++,this.history.push(c))},undo:function(){this.transact(),1>=this.position||(this.set(this.history[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.position>=this.history.length||(this.set(this.history[++this.position-1]),this.editor.fire("redo:composer"))},set:function(b){this.composer.setValue(b),this.editor.focus(!0)}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,d,f){this.parent=e,this.element=d,this.config=f,this._observeViewChange()},_observeViewChange:function(){var b=this;this.parent.observe("beforeload",function(){b.parent.observe("change_view",function(a){a===b.name?(b.parent.currentView=b,b.show(),setTimeout(function(){b.focus()},0)):b.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element){try{this.element.focus()}catch(b){}}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var d=e.dom,f=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(h,g,j){this.base(h,g,j),this.textarea=this.parent.textarea,this._initSandbox()},clear:function(){this.element.innerHTML=f.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(a){var g=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return a&&(g=this.parent.parse(g)),g=e.lang.string(g).replace(e.INVISIBLE_SPACE).by("")},setValue:function(g,c){c&&(g=this.parent.parse(g)),this.element.innerHTML=g},show:function(){this.iframe.style.display=this._displayStyle||"",this.disable(),this.enable()},hide:function(){this._displayStyle=d.getStyle("display").from(this.iframe),"none"===this._displayStyle&&(this._displayStyle=null),this.iframe.style.display="none"},disable:function(){this.element.removeAttribute("contentEditable"),this.base()},enable:function(){this.element.setAttribute("contentEditable","true"),this.base()},focus:function(a){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var g=this.element.lastChild;a&&g&&("BR"===g.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return d.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")},isEmpty:function(){var b=this.element.innerHTML;return""===b||b===this.CARET_HACK||this.hasPlaceholderSet()||""===this.getTextContent()&&!this.element.querySelector("blockquote, ul, ol, img, embed, object, table, iframe, svg, video, audio, button, input, select, textarea")},_initSandbox:function(){var b=this;this.sandbox=new d.Sandbox(function(){b._create()},{stylesheets:this.config.stylesheets}),this.iframe=this.sandbox.getIframe();var h=document.createElement("input");h.type="hidden",h.name="_wysihtml5_mode",h.value=1;var g=this.textarea.element;d.insert(this.iframe).after(g),d.insert(h).after(g)},_create:function(){var b=this;this.doc=this.sandbox.getDocument(),this.element=this.doc.body,this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0),this.enable(),this.selection=new e.Selection(this.parent),this.commands=new e.Commands(this.parent),d.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element),d.addClass(this.element,this.config.composerClassName),this.config.style&&this.style(),this.observe();var a=this.config.name;a&&(d.addClass(this.element,a),d.addClass(this.iframe,a)),(a="string"==typeof this.config.placeholder?this.config.placeholder:this.textarea.element.getAttribute("placeholder"))&&d.simulatePlaceholder(this.parent,this,a),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&setTimeout(function(){b.focus()},100),e.quirks.insertLineBreakOnReturn(this),f.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),f.clearsListsInContentEditableCorrectly()||e.quirks.ensureProperClearingOfLists(this),this.initSync&&this.config.sync&&this.initSync(),this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var l=this,k=f.canDisableAutoLinking(),j=f.doesAutoLinkingInContentEditable();if(k&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!j||j&&k)&&this.parent.observe("newword:composer",function(){l.selection.executeAndRestore(function(g,h){d.autoLink(h.parentNode)})});var c=this.sandbox.getDocument().getElementsByTagName("a"),b=d.autoLink.URL_REG_EXP,a=function(g){return g=e.lang.string(d.getTextContent(g)).trim(),"www."===g.substr(0,4)&&(g="http://"+g),g};d.observe(this.element,"keydown",function(g){if(c.length){var m,g=l.selection.getSelectedNode(g.target.ownerDocument),h=d.getParentElement(g,{nodeName:"A"},4);h&&(m=a(h),setTimeout(function(){var n=a(h);n!==m&&n.match(b)&&h.setAttribute("href",n)},0))}})}},_initObjectResizing:function(){var c=["width","height"],b=c.length,a=this.element;this.commands.exec("enableObjectResizing",this.config.allowObjectResizing),this.config.allowObjectResizing?f.supportsEvent("resizeend")&&d.observe(a,"resizeend",function(j){for(var m,j=j.target||j.srcElement,l=j.style,k=0;b>k;k++){m=c[k],l[m]&&(j.setAttribute(m,parseInt(l[m],10)),l[m]="")}e.quirks.redraw(a)}):f.supportsEvent("resizestart")&&d.observe(a,"resizestart",function(g){g.preventDefault()})},_initUndoManager:function(){new e.UndoManager(this.parent)}})}(wysihtml5),function(u){var s=u.dom,r=document,q=window,p=r.createElement("div"),o="background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "),n="background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),m="width height top left right bottom".split(" "),l=["html             { height: 100%; }","body             { min-height: 100%; padding: 0; margin: 0; margin-top: -1px; padding-top: 1px; }","._wysihtml5-temp { display: none; }",u.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","body[disabled]   { background-color: #eee !important; color: #999 !important; cursor: default !important; }","img:-moz-broken  { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],k=function(b){if(b.setActive){try{b.setActive()}catch(v){}}else{var j=b.style,d=r.documentElement.scrollTop||r.body.scrollTop,c=r.documentElement.scrollLeft||r.body.scrollLeft,j={position:j.position,top:j.top,left:j.left,WebkitUserSelect:j.WebkitUserSelect};s.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(b),b.focus(),s.setStyles(j).on(b),q.scrollTo&&q.scrollTo(c,d)}};u.views.Composer.prototype.style=function(){var c=this,b=r.querySelector(":focus"),a=this.textarea.element,g=a.hasAttribute("placeholder"),f=g&&a.getAttribute("placeholder");this.focusStylesHost=this.focusStylesHost||p.cloneNode(!1),this.blurStylesHost=this.blurStylesHost||p.cloneNode(!1),g&&a.removeAttribute("placeholder"),a===b&&a.blur(),s.copyStyles(n).from(a).to(this.iframe).andTo(this.blurStylesHost),s.copyStyles(o).from(a).to(this.element).andTo(this.blurStylesHost),s.insertCSS(l).into(this.element.ownerDocument),k(a),s.copyStyles(n).from(a).to(this.focusStylesHost),s.copyStyles(o).from(a).to(this.focusStylesHost);var e=u.lang.array(n).without(["display"]);if(b?b.focus():a.blur(),g&&a.setAttribute("placeholder",f),!u.browser.hasCurrentStyleProperty()){var d=s.observe(q,"resize",function(){if(s.contains(document.documentElement,c.iframe)){var h=s.getStyle("display").from(a),j=s.getStyle("display").from(c.iframe);a.style.display="",c.iframe.style.display="none",s.copyStyles(m).from(a).to(c.iframe).andTo(c.focusStylesHost).andTo(c.blurStylesHost),c.iframe.style.display=j,a.style.display=h}else{d.stop()}})}return this.parent.observe("focus:composer",function(){s.copyStyles(e).from(c.focusStylesHost).to(c.iframe),s.copyStyles(o).from(c.focusStylesHost).to(c.element)}),this.parent.observe("blur:composer",function(){s.copyStyles(e).from(c.blurStylesHost).to(c.iframe),s.copyStyles(o).from(c.blurStylesHost).to(c.element)}),this}}(wysihtml5),function(f){var e=f.dom,h=f.browser,g={66:"bold",73:"italic",85:"underline"};f.views.Composer.prototype.observe=function(){var p=this,o=this.getValue(),n=this.sandbox.getIframe(),m=this.element,d=h.supportsEventsInIframeCorrectly()?m:this.sandbox.getWindow(),c=h.supportsEvent("drop")?["drop","paste"]:["dragdrop","paste"];e.observe(n,"DOMNodeRemoved",function(){clearInterval(b),p.parent.fire("destroy:composer")});var b=setInterval(function(){e.contains(document.documentElement,n)||(clearInterval(b),p.parent.fire("destroy:composer"))},250);e.observe(d,"focus",function(){p.parent.fire("focus").fire("focus:composer"),setTimeout(function(){o=p.getValue()},0)}),e.observe(d,"blur",function(){o!==p.getValue()&&p.parent.fire("change").fire("change:composer"),p.parent.fire("blur").fire("blur:composer")}),f.browser.isIos()&&e.observe(m,"blur",function(){var k=m.ownerDocument.createElement("input"),j=document.documentElement.scrollTop||document.body.scrollTop,q=document.documentElement.scrollLeft||document.body.scrollLeft;try{p.selection.insertNode(k)}catch(l){m.appendChild(k)}k.focus(),k.parentNode.removeChild(k),window.scrollTo(q,j)}),e.observe(m,"dragenter",function(){p.parent.fire("unset_placeholder")}),h.firesOnDropOnlyWhenOnDragOverIsCancelled()&&e.observe(m,["dragover","dragenter"],function(j){j.preventDefault()}),e.observe(m,c,function(k){var j,l=k.dataTransfer;l&&h.supportsDataTransfer()&&(j=l.getData("text/html")||l.getData("text/plain")),j?(m.focus(),p.commands.exec("insertHTML",j),p.parent.fire("paste").fire("paste:composer"),k.stopPropagation(),k.preventDefault()):setTimeout(function(){p.parent.fire("paste").fire("paste:composer")},0)}),e.observe(m,"keyup",function(j){j=j.keyCode,(j===f.SPACE_KEY||j===f.ENTER_KEY)&&p.parent.fire("newword:composer")}),this.parent.observe("paste:composer",function(){setTimeout(function(){p.parent.fire("newword:composer")},0)}),h.canSelectImagesInContentEditable()||e.observe(m,"mousedown",function(k){var j=k.target;"IMG"===j.nodeName&&(p.selection.selectNode(j),k.preventDefault())}),e.observe(m,"keydown",function(k){var j=g[k.keyCode];(k.ctrlKey||k.metaKey)&&!k.altKey&&j&&(p.commands.exec(j),k.preventDefault())}),e.observe(m,"keydown",function(j){var l=p.selection.getSelectedNode(!0),k=j.keyCode;!l||"IMG"!==l.nodeName||k!==f.BACKSPACE_KEY&&k!==f.DELETE_KEY||(k=l.parentNode,k.removeChild(l),"A"===k.nodeName&&!k.firstChild&&k.parentNode.removeChild(k),setTimeout(function(){f.quirks.redraw(m)},0),j.preventDefault())});var a={IMG:"Image: ",A:"Link: "};e.observe(m,"mouseover",function(k){var k=k.target,j=k.nodeName;!("A"!==j&&"IMG"!==j)&&!k.hasAttribute("title")&&(j=a[j]+(k.getAttribute("href")||k.getAttribute("src")),k.setAttribute("title",j))})}}(wysihtml5),function(b){b.views.Synchronizer=Base.extend({constructor:function(e,d,f){this.editor=e,this.textarea=d,this.composer=f,this._observe()},fromComposerToTextarea:function(a){this.textarea.setValue(b.lang.string(this.composer.getValue()).trim(),a)},fromTextareaToComposer:function(d){var c=this.textarea.getValue();c?this.composer.setValue(c,d):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(c){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(c):this.fromComposerToTextarea(c)},_observe:function(){var a,k=this,j=this.textarea.element.form,h=function(){a=setInterval(function(){k.fromComposerToTextarea()},400)},g=function(){clearInterval(a),a=null};h(),j&&(b.dom.observe(j,"submit",function(){k.sync(!0)}),b.dom.observe(j,"reset",function(){setTimeout(function(){k.fromTextareaToComposer()},0)})),this.editor.observe("change_view",function(c){"composer"!==c||a?"textarea"===c&&(k.fromComposerToTextarea(!0),g()):(k.fromTextareaToComposer(!0),h())}),this.editor.observe("destroy:composer",g)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,d,f){this.base(e,d,f),this._observe()},clear:function(){this.element.value=""},getValue:function(d){var c=this.isEmpty()?"":this.element.value;return d&&(c=this.parent.parse(c)),c},setValue:function(d,c){c&&(d=this.parent.parse(d)),this.element.value=d},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),d=this.element.getAttribute("placeholder")||null,f=this.element.value;return e&&!f||f===d},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var f=this.element,e=this.parent,h={focusin:"focus",focusout:"blur"},g=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.observe("beforeload",function(){wysihtml5.dom.observe(f,g,function(b){b=h[b.type]||b.type,e.fire(b).fire(b+":textarea")}),wysihtml5.dom.observe(f,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}}),function(d){var c=d.dom;d.toolbar.Dialog=d.lang.Dispatcher.extend({constructor:function(f,e){this.link=f,this.container=e},_observe:function(){if(!this._observed){var m=this,l=function(f){var e=m._serialize();e==m.elementToChange?m.fire("edit",e):m.fire("save",e),m.hide(),f.preventDefault(),f.stopPropagation()};c.observe(m.link,"click",function(){c.hasClass(m.link,"wysihtml5-command-dialog-opened")&&setTimeout(function(){m.hide()},0)}),c.observe(this.container,"keydown",function(f){var g=f.keyCode;g===d.ENTER_KEY&&l(f),g===d.ESCAPE_KEY&&m.hide()}),c.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",l),c.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){m.fire("cancel"),m.hide(),e.preventDefault(),e.stopPropagation()});for(var k=this.container.querySelectorAll("input, select, textarea"),j=0,b=k.length,a=function(){clearInterval(m.interval)};b>j;j++){c.observe(k[j],"change",a)}this._observed=!0}},_serialize:function(){for(var f=this.elementToChange||{},e=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),h=e.length,g=0;h>g;g++){f[e[g].getAttribute("data-wysihtml5-dialog-field")]=e[g].value}return f},_interpolate:function(j){for(var h,o,n=document.querySelector(":focus"),m=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),l=m.length,k=0;l>k;k++){h=m[k],h!==n&&!(j&&"hidden"===h.type)&&(o=h.getAttribute("data-wysihtml5-dialog-field"),o=this.elementToChange?this.elementToChange[o]||"":h.defaultValue,h.value=o)}},show:function(b){var h=this,g=this.container.querySelector("input, select, textarea");if(this.elementToChange=b,this._observe(),this._interpolate(),b&&(this.interval=setInterval(function(){h._interpolate(!0)},500)),c.addClass(this.link,"wysihtml5-command-dialog-opened"),this.container.style.display="",this.fire("show"),g&&!b){try{g.focus()}catch(f){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,c.removeClass(this.link,"wysihtml5-command-dialog-opened"),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(h){var g=h.dom,m={position:"relative"},l={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},k={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},j={"x-webkit-speech":"",speech:""};h.toolbar.Speech=function(d,c){var b=document.createElement("input");if(h.browser.supportsSpeechApiOn(b)){var a=document.createElement("div");h.lang.object(l).merge({width:c.offsetWidth+"px",height:c.offsetHeight+"px"}),g.insert(b).into(a),g.insert(a).into(c),g.setStyles(k).on(b),g.setAttributes(j).on(b),g.setStyles(l).on(a),g.setStyles(m).on(c),g.observe(b,"onwebkitspeechchange" in b?"webkitspeechchange":"speechchange",function(){d.execCommand("insertText",b.value),b.value=""}),g.observe(b,"click",function(e){g.hasClass(c,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}else{c.style.display="none"}}}(wysihtml5),function(d){var c=d.dom;d.toolbar.Toolbar=Base.extend({constructor:function(a,k){this.editor=a,this.container="string"==typeof k?document.getElementById(k):k,this.composer=a.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),this.show();for(var j=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),h=j.length,g=0;h>g;g++){new d.toolbar.Speech(this,j[g])}},_getLinks:function(u){for(var s,r,q,p,o,n=this[u+"Links"]=d.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+u+"]")).get(),m=n.length,l=0,a=this[u+"Mapping"]={};m>l;l++){s=n[l],q=s.getAttribute("data-wysihtml5-"+u),p=s.getAttribute("data-wysihtml5-"+u+"-value"),r=this.container.querySelector("[data-wysihtml5-"+u+"-group='"+q+"']"),o=this._getDialog(s,q),a[q+":"+p]={link:s,group:r,name:q,value:p,dialog:o,state:!1}}},_getDialog:function(a,m){var l,k,j=this,h=this.container.querySelector("[data-wysihtml5-dialog='"+m+"']");return h&&(l=new d.toolbar.Dialog(a,h),l.observe("show",function(){k=j.composer.selection.getBookmark(),j.editor.fire("show:dialog",{command:m,dialogContainer:h,commandLink:a})}),l.observe("save",function(b){k&&j.composer.selection.setBookmark(k),j._execCommand(m,b),j.editor.fire("save:dialog",{command:m,dialogContainer:h,commandLink:a})}),l.observe("cancel",function(){j.editor.focus(!1),j.editor.fire("cancel:dialog",{command:m,dialogContainer:h,commandLink:a})})),l},execCommand:function(f,e){if(!this.commandsDisabled){var g=this.commandMapping[f+":"+e];g&&g.dialog&&!g.state?g.dialog.show():this._execCommand(f,e)}},_execCommand:function(f,e){this.editor.focus(!1),this.composer.commands.exec(f,e),this._updateLinkStates()},execAction:function(f){var e=this.editor;switch(f){case"change_view":e.currentView===e.textarea?e.fire("change_view","composer"):e.fire("change_view","textarea")}},_observe:function(){for(var b=this,m=this.editor,l=this.container,k=this.commandLinks.concat(this.actionLinks),j=k.length,h=0;j>h;h++){c.setAttributes({href:"javascript:;",unselectable:"on"}).on(k[h])}c.delegate(l,"[data-wysihtml5-command]","mousedown",function(e){e.preventDefault()}),c.delegate(l,"[data-wysihtml5-command]","click",function(a){var f=this.getAttribute("data-wysihtml5-command"),e=this.getAttribute("data-wysihtml5-command-value");b.execCommand(f,e),a.preventDefault()}),c.delegate(l,"[data-wysihtml5-action]","click",function(a){var e=this.getAttribute("data-wysihtml5-action");b.execAction(e),a.preventDefault()}),m.observe("focus:composer",function(){b.bookmark=null,clearInterval(b.interval),b.interval=setInterval(function(){b._updateLinkStates()},500)}),m.observe("blur:composer",function(){clearInterval(b.interval)}),m.observe("destroy:composer",function(){clearInterval(b.interval)}),m.observe("change_view",function(a){setTimeout(function(){b.commandsDisabled="composer"!==a,b._updateLinkStates(),b.commandsDisabled?c.addClass(l,"wysihtml5-commands-disabled"):c.removeClass(l,"wysihtml5-commands-disabled")},0)})},_updateLinkStates:function(){var k,j,h,b=this.commandMapping,a=this.actionMapping;for(k in b){h=b[k],this.commandsDisabled?(j=!1,c.removeClass(h.link,"wysihtml5-command-active"),h.group&&c.removeClass(h.group,"wysihtml5-command-active"),h.dialog&&h.dialog.hide()):(j=this.composer.commands.state(h.name,h.value),d.lang.object(j).isArray()&&(j=1===j.length?j[0]:!0),c.removeClass(h.link,"wysihtml5-command-disabled"),h.group&&c.removeClass(h.group,"wysihtml5-command-disabled")),h.state!==j&&((h.state=j)?(c.addClass(h.link,"wysihtml5-command-active"),h.group&&c.addClass(h.group,"wysihtml5-command-active"),h.dialog&&("object"==typeof j?h.dialog.show(j):h.dialog.hide())):(c.removeClass(h.link,"wysihtml5-command-active"),h.group&&c.removeClass(h.group,"wysihtml5-command-active"),h.dialog&&h.dialog.hide()))}for(k in a){b=a[k],"change_view"===b.name&&(b.state=this.editor.currentView===this.editor.textarea,b.state?c.addClass(b.link,"wysihtml5-action-active"):c.removeClass(b.link,"wysihtml5-action-active"))}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(d){var c={name:void 0,style:!0,toolbar:void 0,autoLink:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:d.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",stylesheets:[],placeholderText:void 0,allowObjectResizing:!0,supportTouchDevices:!0};d.Editor=d.lang.Dispatcher.extend({constructor:function(h,g){if(this.textareaElement="string"==typeof h?document.getElementById(h):h,this.config=d.lang.object({}).merge(c).merge(g).get(),this.currentView=this.textarea=new d.views.Textarea(this,this.textareaElement,this.config),this._isCompatible=d.browser.supported(),!this._isCompatible||!this.config.supportTouchDevices&&d.browser.isTouchDevice()){var b=this;setTimeout(function(){b.fire("beforeload").fire("load")},0)}else{d.dom.addClass(document.body,this.config.bodyClassName),this.currentView=this.composer=new d.views.Composer(this,this.textareaElement,this.config),"function"==typeof this.config.parser&&this._initParser(),this.observe("beforeload",function(){this.synchronizer=new d.views.Synchronizer(this,this.textarea,this.composer),this.config.toolbar&&(this.toolbar=new d.toolbar.Toolbar(this,this.config.toolbar))});try{console.log("Heya! This page is using wysihtml5 for rich text editing. Check out https://github.com/xing/wysihtml5")}catch(a){}}},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(b){return this.currentView.getValue(b)},setValue:function(f,e){return f?(this.currentView.setValue(f,e),this):this.clear()},focus:function(b){return this.currentView.focus(b),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(a){var e=this.config.parser(a,this.config.parserRules,this.composer.sandbox.getDocument(),!0);return"object"==typeof a&&d.quirks.redraw(a),e},_initParser:function(){this.observe("paste:composer",function(){var a=this;a.composer.selection.executeAndRestore(function(){d.quirks.cleanPastedHTML(a.composer.element),a.parse(a.composer.element)},!0)}),this.observe("paste:textarea",function(){this.textarea.setValue(this.parse(this.textarea.getValue()))})}})}(wysihtml5);var Handlebars=function(){var h=function(){function d(b){this.string=b}var c;return d.prototype.toString=function(){return""+this.string},c=d}(),g=function(A){function z(b){return s[b]||"&amp;"}function y(e,d){for(var f in d){d.hasOwnProperty(f)&&(e[f]=d[f])}}function x(b){return b instanceof u?b.toString():b||0===b?(b=""+b,q.test(b)?b.replace(r,z):b):""}function w(b){return b||0===b?n(b)&&0===b.length?!0:!1:!0}var v={},u=A,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=/[&<>"'`]/g,q=/[&<>"'`]/;v.extend=y;var p=Object.prototype.toString;v.toString=p;var o=function(b){return"function"==typeof b};o(/x/)&&(o=function(b){return"function"==typeof b&&"[object Function]"===p.call(b)});var o;v.isFunction=o;var n=Array.isArray||function(b){return b&&"object"==typeof b?"[object Array]"===p.call(b):!1};return v.isArray=n,v.escapeExpression=x,v.isEmpty=w,v}(h),m=function(){function e(){for(var n=Error.prototype.constructor.apply(this,arguments),c=0;c<f.length;c++){this[f[c]]=n[f[c]]}}var d,f=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,d=e}(),l=function(I,H){function G(d,c){this.helpers=d||{},this.partials=c||{},F(this)}function F(b){b.registerHelper("helperMissing",function(c){if(2===arguments.length){return void 0}throw new Error("Missing helper: '"+c+"'")}),b.registerHelper("blockHelperMissing",function(a,o){var n=o.inverse||function(){},f=o.fn;return w(a)&&(a=a.call(this)),a===!0?f(this):a===!1||null==a?n(this):x(a)?a.length>0?b.helpers.each(a,o):n(this):f(a)}),b.registerHelper("each",function(N,M){var L,K=M.fn,J=M.inverse,q=0,p="";if(w(N)&&(N=N.call(this)),M.data&&(L=r(M.data)),N&&"object"==typeof N){if(x(N)){for(var o=N.length;o>q;q++){L&&(L.index=q,L.first=0===q,L.last=q===N.length-1),p+=K(N[q],{data:L})}}else{for(var n in N){N.hasOwnProperty(n)&&(L&&(L.key=n),p+=K(N[n],{data:L}),q++)}}}return 0===q&&(p=J(this)),p}),b.registerHelper("if",function(d,c){return w(d)&&(d=d.call(this)),!c.hash.includeZero&&!d||C.isEmpty(d)?c.inverse(this):c.fn(this)}),b.registerHelper("unless",function(a,d){return b.helpers["if"].call(this,a,{fn:d.inverse,inverse:d.fn,hash:d.hash})}),b.registerHelper("with",function(d,c){return w(d)&&(d=d.call(this)),C.isEmpty(d)?void 0:c.fn(d)}),b.registerHelper("log",function(a,f){var e=f.data&&null!=f.data.level?parseInt(f.data.level,10):1;b.log(e,a)})}function E(d,c){s.log(d,c)}var D={},C=I,B=H,A="1.1.2";D.VERSION=A;var z=4;D.COMPILER_REVISION=z;var y={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};D.REVISION_CHANGES=y;var x=C.isArray,w=C.isFunction,v=C.toString,u="[object Object]";D.HandlebarsEnvironment=G,G.prototype={constructor:G,logger:s,log:E,registerHelper:function(e,d,f){if(v.call(e)===u){if(f||d){throw new B("Arg not supported with multiple helpers")}C.extend(this.helpers,e)}else{f&&(d.not=f),this.helpers[e]=d}},registerPartial:function(d,c){v.call(d)===u?C.extend(this.partials,d):this.partials[d]=c}};var s={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,d){if(s.level<=e){var f=s.methodMap[e];"undefined"!=typeof console&&console[f]&&console[f].call(console,d)}}};D.logger=s,D.log=E;var r=function(d){var c={};return C.extend(c,d),c};return D.createFrame=r,D}(g,m),k=function(C,B,A){function z(n){var f=n&&n[0]||1,F=p;if(f!==F){if(F>f){var E=o[F],D=o[f];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+E+") or downgrade your runtime to an older version ("+D+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+n[1]+").")}}function y(f,d){if(!d){throw new Error("No environment passed to template")}var D;D=d.compile?function(b,K,J,I,H,G){var F=v.apply(this,arguments);if(F){return F}var E={helpers:I,partials:H,data:G};return H[K]=d.compile(b,{data:void 0!==G},d),H[K](J,E)}:function(E,e){var F=v.apply(this,arguments);if(F){return F}throw new q("The partial "+e+" could not be compiled when running in runtime-only mode")};var n={escapeExpression:r.escapeExpression,invokePartial:D,programs:[],program:function(E,e,G){var F=this.programs[E];return G?F=w(E,e,G):F||(F=this.programs[E]=w(E,e)),F},merge:function(E,e){var F=E||e;return E&&e&&E!==e&&(F={},r.extend(F,e),r.extend(F,E)),F},programWithDepth:x,noop:u,compilerInfo:null};return function(G,F){F=F||{};var E,e,b=F.partial?F:d;F.partial||(E=F.helpers,e=F.partials);var a=f.call(n,b,G,E,e,F.data);return F.partial||z(n.compilerInfo),a}}function x(n,f,F){var E=Array.prototype.slice.call(arguments,3),D=function(b,c){return c=c||{},f.apply(this,[b,c.data||F].concat(E))};return D.program=n,D.depth=E.length,D}function w(f,e,D){var n=function(b,c){return c=c||{},e(b,c.data||D)};return n.program=f,n.depth=0,n}function v(D,n,I,H,G,F){var E={partial:!0,helpers:H,partials:G,data:F};if(void 0===D){throw new q("The partial "+n+" could not be found")}return D instanceof Function?D(I,E):void 0}function u(){return""}var s={},r=C,q=B,p=A.COMPILER_REVISION,o=A.REVISION_CHANGES;return s.template=y,s.programWithDepth=x,s.program=w,s.invokePartial=v,s.noop=u,s}(g,m,l),j=function(A,z,y,x,w){var v,u=A,s=z,r=y,q=x,p=w,o=function(){var b=new u.HandlebarsEnvironment;return q.extend(b,u),b.SafeString=s,b.Exception=r,b.Utils=q,b.VM=p,b.template=function(a){return p.template(a,b)},b},n=o();return n.create=o,v=n}(l,h,m,g,k);return j}(),glob="undefined"==typeof window?global:window,Handlebars=glob.Handlebars||require("handlebars");this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.color=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.black,typeof r===o?r.apply(x):r))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.black,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.silver,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.gray,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.maroon,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.red,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.purple,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.green,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.olive,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.navy,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.blue,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.orange,typeof r===o?r.apply(x):r))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.emphasis=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.bold,typeof r===o?r.apply(x):r))+'</a>\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.italic,typeof r===o?r.apply(x):r))+'</a>\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.underline,typeof r===o?r.apply(x):r))+"</a>\n  </div>\n</li>\n"}),this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+='" data-toggle="dropdown">\n    <span class="glyphicon glyphicon-font"></span>\n    <span class="current-font">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.normal,typeof r===o?r.apply(x):r))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="div" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.normal,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h1,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h2,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h3,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h4,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h5,typeof r===o?r.apply(x):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h6,typeof r===o?r.apply(x):r))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.html=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-action="change_view" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.html,r=null==r||r===!1?r:r.edit,typeof r===o?r.apply(x):r))+'" tabindex="-1">\n      <span class="glyphicon glyphicon-pencil"></span>\n    </a>\n  </div>\n</li>\n'}),this.wysihtml5.tpl.image=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade">\n    <div class="modal-dialog">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+n((r=x&&x.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'</h3>\n        </div>\n        <div class="modal-body">\n          <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control">\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.cancel,typeof r===o?r.apply(x):r))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertImage" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'" tabindex="-1">\n    <span class="glyphicon glyphicon-picture"></span>\n  </a>\n</li>\n'}),this.wysihtml5.tpl.link=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade">\n    <div class="modal-dialog">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+n((r=x&&x.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'</h3>\n        </div>\n        <div class="modal-body">\n          <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control">\n          <label class="checkbox"> <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+n((r=x&&x.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.target,typeof r===o?r.apply(x):r))+'</label>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.cancel,typeof r===o?r.apply(x):r))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal">'+n((r=x&&x.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="createLink" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(x):r))+'" tabindex="-1">\n    <span class="glyphicon glyphicon-share"></span>\n  </a>\n</li>\n'}),this.wysihtml5.tpl.lists=Handlebars.template(function(y,x,w,v,u){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],w=this.merge(w,y.helpers),u=u||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.unordered,typeof r===o?r.apply(x):r))+'" tabindex="-1"><span class="glyphicon glyphicon-list"></span></a>\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.ordered,typeof r===o?r.apply(x):r))+'" tabindex="-1"><span class="glyphicon glyphicon-th-list"></span></a>\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="Outdent" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.outdent,typeof r===o?r.apply(x):r))+'" tabindex="-1"><span class="glyphicon glyphicon-indent-right"></span></a>\n    <a class="btn ',q=w["if"].call(x,(r=x&&x.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,u),data:u}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="Indent" title="'+n((r=x&&x.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.indent,typeof r===o?r.apply(x):r))+'" tabindex="-1"><span class="glyphicon glyphicon-indent-left"></span></a>\n  </div>\n</li>\n'}),"object"==typeof exports&&exports&&(module.exports=this.wysihtml5.tpl),!function(j,h){var o=function(b,f,e){return h.tpl[b]({locale:f,options:e})},n=function(p,f){this.el=p;var b=f||l;for(var a in b.customTemplates){h.tpl[a]=b.customTemplates[a]}this.toolbar=this.createToolbar(p,b),this.editor=this.createEditor(f),window.editor=this.editor,j("iframe.wysihtml5-sandbox").each(function(d,e){j(e.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){j("li.dropdown").removeClass("open")}})})};n.prototype={constructor:n,createEditor:function(f){f=f||{},f=j.extend(!0,{},f),f.toolbar=this.toolbar[0];var b=new h.Editor(this.el[0],f);if(f&&f.events){for(var a in f.events){b.on(a,f.events[a])}}return b},createToolbar:function(a,r){var q=this,p=j("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),g=r.locale||l.locale||"en";for(var f in l){var c=!1;void 0!==r[f]?r[f]===!0&&(c=!0):c=l[f],c===!0&&(p.append(o(f,k[g],r)),"html"===f&&this.initHtml(p),"link"===f&&this.initInsertLink(p),"image"===f&&this.initInsertImage(p))}if(r.toolbar){for(f in r.toolbar){p.append(r.toolbar[f])}}return p.find('a[data-wysihtml5-command="formatBlock"]').click(function(e){var u=e.target||e.srcElement,s=j(u);q.toolbar.find(".current-font").text(s.html())}),p.find('a[data-wysihtml5-command="foreColor"]').click(function(e){var u=e.target||e.srcElement,s=j(u);q.toolbar.find(".current-color").text(s.html())}),this.el.before(p),p},initHtml:function(d){var c='a[data-wysihtml5-action="change_view"]';d.find(c).click(function(){d.find("a.btn").not(c).toggleClass("disabled")})},initInsertImage:function(a){var w,v=this,u=a.find(".bootstrap-wysihtml5-insert-image-modal"),s=u.find(".bootstrap-wysihtml5-insert-image-url"),r=u.find("a.btn-primary"),q=s.val(),p=function(){var b=s.val();s.val(q),v.editor.currentView.element.focus(),w&&(v.editor.composer.selection.setBookmark(w),w=null),v.editor.composer.commands.exec("insertImage",b)};s.keypress(function(b){13==b.which&&(p(),u.modal("hide"))}),r.click(p),u.on("shown",function(){s.focus()}),u.on("hide",function(){v.editor.currentView.element.focus()}),a.find("a[data-wysihtml5-command=insertImage]").click(function(){var c=j(this).hasClass("wysihtml5-command-active");return c?!0:(v.editor.currentView.element.focus(!1),w=v.editor.composer.selection.getBookmark(),u.appendTo("body").modal("show"),u.on("click.dismiss.modal",'[data-dismiss="modal"]',function(b){b.stopPropagation()}),!1)})},initInsertLink:function(x){var w,v=this,u=x.find(".bootstrap-wysihtml5-insert-link-modal"),s=u.find(".bootstrap-wysihtml5-insert-link-url"),r=u.find(".bootstrap-wysihtml5-insert-link-target"),q=u.find("a.btn-primary"),p=s.val(),a=function(){var d=s.val();s.val(p),v.editor.currentView.element.focus(),w&&(v.editor.composer.selection.setBookmark(w),w=null);var c=r.prop("checked");v.editor.composer.commands.exec("createLink",{href:d,target:c?"_blank":"_self",rel:c?"nofollow":""})};s.keypress(function(b){13==b.which&&(a(),u.modal("hide"))}),q.click(a),u.on("shown",function(){s.focus()}),u.on("hide",function(){v.editor.currentView.element.focus()}),x.find("a[data-wysihtml5-command=createLink]").click(function(){var c=j(this).hasClass("wysihtml5-command-active");return c?!0:(v.editor.currentView.element.focus(!1),w=v.editor.composer.selection.getBookmark(),u.appendTo("body").modal("show"),u.on("click.dismiss.modal",'[data-dismiss="modal"]',function(b){b.stopPropagation()}),!1)})}};var m={resetDefaults:function(){j.fn.wysihtml5.defaultOptions=j.extend(!0,{},j.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(a){return this.each(function(){var b=j(this);b.data("wysihtml5",new n(b,a))})},shallowExtend:function(a){var f=j.extend({},j.fn.wysihtml5.defaultOptions,a||{},j(this).data()),e=this;return m.bypassDefaults.apply(e,[f])},deepExtend:function(a){var f=j.extend(!0,{},j.fn.wysihtml5.defaultOptions,a||{}),e=this;return m.bypassDefaults.apply(e,[f])},init:function(d){var c=this;return m.shallowExtend.apply(c,[d])}};j.fn.wysihtml5=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?(j.error("Method "+a+" does not exist on jQuery.wysihtml5"),void 0):m.init.apply(this,arguments)},j.fn.wysihtml5.Constructor=n;var l=j.fn.wysihtml5.defaultOptions={"font-styles":!0,color:!1,emphasis:!0,lists:!0,html:!1,link:!0,image:!0,events:{},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,code:1,pre:1}},locale:"en"};"undefined"==typeof j.fn.wysihtml5.defaultOptionsCache&&(j.fn.wysihtml5.defaultOptionsCache=j.extend(!0,{},j.fn.wysihtml5.defaultOptions));var k=j.fn.wysihtml5.locale={}}(window.jQuery,window.wysihtml5),function(b){b.fn.wysihtml5.locale.en=b.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}(jQuery);$(function(){if($("#page-js").text().indexOf("admin-console")>-1){$(".delete-achievement-button").click(function(){var a=$(this).closest("tr").data("uuid");$.ajax({type:"POST",url:"/admin/achievement",data:"uuid="+a+"&action=delete"});$(this).closest("tr").remove()});$(".delete-report-button").click(function(){var a=$(this).closest("tr").data("uuid");$.ajax({type:"POST",url:"/report/manage",data:"reportUuid="+a+"&action=delete-report"});$(this).closest("tr").remove()});$(".delete-reported-content-button").click(function(){var a=$(this).closest("tr").data("uuid");$.ajax({type:"POST",url:"/report/manage",data:"reportUuid="+a+"&action=delete-content"});$(this).closest("tr").remove()});$(".flag-reporter-button").click(function(){var a=$(this).closest("tr").data("uuid");$.ajax({type:"POST",url:"/report/manage",data:"reportUuid="+a+"&action=flag-reporter"});$(this).closest("tr").remove()})}});
/*!
 * Author: Abdullah A Almsaeed
 * Date: 4 Jan 2014
 * Description:
 *      This file should be included in all pages
 !**/
;var left_side_width=220;$(function(){$("[data-toggle='offcanvas']").click(function(d){d.preventDefault();if($(window).width()<=992){$(".row-offcanvas").toggleClass("active");$(".left-side").removeClass("collapse-left");$(".right-side").removeClass("strech");$(".row-offcanvas").toggleClass("relative")}else{$(".left-side").toggleClass("collapse-left");$(".right-side").toggleClass("strech")}});$(".btn").bind("touchstart",function(){$(this).addClass("hover")}).bind("touchend",function(){$(this).removeClass("hover")});$("[data-toggle='tooltip']").tooltip();$("[data-widget='collapse']").click(function(){var e=$(this).parents(".box").first();var d=e.find(".box-body, .box-footer");if(!e.hasClass("collapsed-box")){e.addClass("collapsed-box");$(this).children(".fa-minus").removeClass("fa-minus").addClass("fa-plus");d.slideUp()}else{e.removeClass("collapsed-box");$(this).children(".fa-plus").removeClass("fa-plus").addClass("fa-minus");d.slideDown()}});$(".navbar .menu").slimscroll({height:"200px",alwaysVisible:false,size:"3px"}).css("width","100%");$('.btn-group[data-toggle="btn-toggle"]').each(function(){var d=$(this);$(this).find(".btn").click(function(f){d.find(".btn.active").removeClass("active");$(this).addClass("active");f.preventDefault()})});$("[data-widget='remove']").click(function(){var d=$(this).parents(".box").first();d.slideUp()});$(".sidebar .treeview").tree();function c(){var f=$(".main-header").height()-($(".main-footer").height());var e=$(window).height();var d=$(".left-side").height();if(e>=d){$(".content, .left-side").css("min-height",e-f)}else{$(".content, .left-side").css("min-height",d-f)}}c();$(window).resize(function(){window.setTimeout(function(){c();fix_sidebar()},1000)});fix_sidebar();$("input[type='checkbox']:not(.simple), input[type='radio']:not(.simple)").iCheck({checkboxClass:"icheckbox_minimal",radioClass:"iradio_minimal"});$(".login-button").click(function(){$("#login-modal").removeClass("hidden")});$(".login-action").click(function(){$("#login-modal").addClass("hidden")});$("#close-ad").click(function(){$(this).closest(".ad").remove()});$(".wysihtml5-beam-me-up").wysihtml5();$(".nav .dropdown .dropdown-toggle").click(function(){var g=$(this).data("type");var f=$(this).data("user");var e=$(".label",this);var d=parseInt(e.text());if(d>0){$.ajax({type:"POST",url:"/mark-menu-items-read",data:"userId="+f+"&type="+g})}e.fadeOut().text("0")});$(".knob").knob();var b=$(".affirm-consent-check-box");var a=$(".affirm-consent-button");$(b).click(function(){$(this).toggleClass("checked");$(a).toggleClass("disabled")});$("#affirm-consent-modal").each(function(){var d=this;$(a).click(function(){var g=$(b).hasClass("checked");if(g){var e=$(this).data("user");$.ajax({type:"POST",url:"/affirm-consent",data:"userId="+e});$(d).remove()}else{var f={border:"1px solid #f56954"};$(affirmConsentCheckbox).css(f)}})});$("#tags-input-bar").tagsInput({width:"100%",height:"auto",defaultText:"Type Tags Here",removeWithBackspace:true})});function fix_sidebar(){if(!$("body").hasClass("fixed")){return}var a={height:($(window).height()-$(".header").height())+"px"};$(".sidebar").slimscroll({height:($(window).height()-$(".header").height())+"px",color:"rgba(0,0,0,0.2)"});$(".sidebar").parent().css(a);$(".sidebar").css(a)}$(window).load(function(){
/*! pace 0.4.17 */
(function(){var aY,aX,aW,aV,aU,aT,aS,aR,aQ,aP,aO,aN,aM,aL,aK,aJ,aI,aH,aG,aF,aE,aD,aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac=[].slice,ab={}.hasOwnProperty,aa=function(f,e){function h(){this.constructor=f}for(var g in e){ab.call(e,g)&&(f[g]=e[g])}return h.prototype=e.prototype,f.prototype=new h,f.__super__=e.prototype,f},Z=[].indexOf||function(e){for(var d=0,f=this.length;f>d;d++){if(d in this&&this[d]===e){return d}}return -1};for(aF={catchupTime:500,initialRate:0.03,minTime:500,ghostTime:500,maxProgressPerFrame:10,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!1}},ax=function(){var b;return null!=(b="undefined"!=typeof performance&&null!==performance?"function"==typeof performance.now?performance.now():void 0:void 0)?b:+new Date},av=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,aG=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==av&&(av=function(b){return setTimeout(b,50)},aG=function(b){return clearTimeout(b)}),at=function(e){var d,f;return d=ax(),(f=function(){var a;return a=ax()-d,a>=33?(d=ax(),e(a,function(){return av(f)})):setTimeout(f,33-a)})()},au=function(){var e,d,f;return f=arguments[0],d=arguments[1],e=3<=arguments.length?ac.call(arguments,2):[],"function"==typeof f[d]?f[d].apply(f,e):f[d]},aE=function(){var j,h,o,n,m,l,k;for(h=arguments[0],n=2<=arguments.length?ac.call(arguments,1):[],l=0,k=n.length;k>l;l++){if(o=n[l]){for(j in o){ab.call(o,j)&&(m=o[j],null!=h[j]&&"object"==typeof h[j]&&null!=m&&"object"==typeof m?aE(h[j],m):h[j]=m)}}}return h},aJ=function(h){var g,m,l,k,j;for(m=g=0,k=0,j=h.length;j>k;k++){l=h[k],m+=Math.abs(l),g++}return m/g},aC=function(h,g){var m,l,k;if(null==h&&(h="options"),null==g&&(g=!0),k=document.querySelector("[data-pace-"+h+"]")){if(m=k.getAttribute("data-pace-"+h),!g){return m}try{return JSON.parse(m)}catch(j){return l=j,"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",l):void 0}}},aS=function(){function b(){}return b.prototype.on=function(g,f,k,j){var h;return null==j&&(j=!1),null==this.bindings&&(this.bindings={}),null==(h=this.bindings)[g]&&(h[g]=[]),this.bindings[g].push({handler:f,ctx:k,once:j})},b.prototype.once=function(e,d,f){return this.on(e,d,f,!0)},b.prototype.off=function(g,f){var k,j,h;if(null!=(null!=(j=this.bindings)?j[g]:void 0)){if(null==f){return delete this.bindings[g]}for(k=0,h=[];k<this.bindings[g].length;){this.bindings[g][k].handler===f?h.push(this.bindings[g].splice(k,1)):h.push(k++)}return h}},b.prototype.trigger=function(){var r,q,p,o,n,m,l,k,j;if(p=arguments[0],r=2<=arguments.length?ac.call(arguments,1):[],null!=(l=this.bindings)?l[p]:void 0){for(n=0,j=[];n<this.bindings[p].length;){k=this.bindings[p][n],o=k.handler,q=k.ctx,m=k.once,o.apply(null!=q?q:this,r),m?j.push(this.bindings[p].splice(n,1)):j.push(n++)}return j}},b}(),null==window.Pace&&(window.Pace={}),aE(Pace,aS.prototype),aw=Pace.options=aE({},aF,window.paceOptions,aC()),af=["ajax","document","eventLag","elements"],aj=0,ah=af.length;ah>aj;aj++){ap=af[aj],aw[ap]===!0&&(aw[ap]=aF[ap])}aQ=function(d){function c(){return ae=c.__super__.constructor.apply(this,arguments)}return aa(c,d),c}(Error),aX=function(){function b(){this.progress=0}return b.prototype.getElement=function(){var c;if(null==this.el){if(c=document.querySelector(aw.target),!c){throw new aQ}this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace("pace-done",""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=c.firstChild?c.insertBefore(this.el,c.firstChild):c.appendChild(this.el)}return this.el},b.prototype.finish=function(){var c;return c=this.getElement(),c.className=c.className.replace("pace-active",""),c.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},b.prototype.update=function(c){return this.progress=c,this.render()},b.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(c){aQ=c}return this.el=void 0},b.prototype.render=function(){var d,c;return null==document.querySelector(aw.target)?!1:(d=this.getElement(),d.children[0].style.width=""+this.progress+"%",(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(d.children[0].setAttribute("data-progress-text",""+(0|this.progress)+"%"),this.progress>=100?c="99":(c=this.progress<10?"0":"",c+=0|this.progress),d.children[0].setAttribute("data-progress",""+c)),this.lastRenderedProgress=this.progress)},b.prototype.done=function(){return this.progress>=100},b}(),aR=function(){function b(){this.bindings={}}return b.prototype.trigger=function(j,h){var o,n,m,l,k;if(null!=this.bindings[j]){for(l=this.bindings[j],k=[],n=0,m=l.length;m>n;n++){o=l[n],k.push(o.call(this,h))}return k}},b.prototype.on=function(e,d){var f;return null==(f=this.bindings)[e]&&(f[e]=[]),this.bindings[e].push(d)},b}(),ak=window.XMLHttpRequest,al=window.XDomainRequest,am=window.WebSocket,aD=function(j,h){var o,n,m,l;l=[];for(n in h.prototype){try{m=h.prototype[n],null==j[n]&&"function"!=typeof m?l.push(j[n]=m):l.push(void 0)}catch(k){o=k}}return l},az=[],Pace.ignore=function(){var e,d,f;return d=arguments[0],e=2<=arguments.length?ac.call(arguments,1):[],az.unshift("ignore"),f=d.apply(null,e),az.shift(),f},Pace.track=function(){var e,d,f;return d=arguments[0],e=2<=arguments.length?ac.call(arguments,1):[],az.unshift("track"),f=d.apply(null,e),az.shift(),f},aq=function(d){var c;if(null==d&&(d="GET"),"track"===az[0]){return"force"}if(!az.length&&aw.ajax){if("socket"===d&&aw.ajax.trackWebSockets){return !0}if(c=d.toUpperCase(),Z.call(aw.ajax.trackMethods,c)>=0){return !0}}return !1},aP=function(d){function c(){var b,e=this;c.__super__.constructor.apply(this,arguments),b=function(g){var f;return f=g.open,g.open=function(h,a){return aq(h)&&e.trigger("request",{type:h,url:a,request:g}),f.apply(g,arguments)}},window.XMLHttpRequest=function(a){var f;return f=new ak(a),b(f),f},aD(window.XMLHttpRequest,ak),null!=al&&(window.XDomainRequest=function(){var a;return a=new al,b(a),a},aD(window.XDomainRequest,al)),null!=am&&aw.ajax.trackWebSockets&&(window.WebSocket=function(g,f){var h;return h=new am(g,f),aq("socket")&&e.trigger("request",{type:"socket",url:g,protocols:f,request:h}),h},aD(window.WebSocket,am))}return aa(c,d),c}(aR),ai=null,aB=function(){return null==ai&&(ai=new aP),ai},aB().on("request",function(a){var k,j,h,g;return g=a.type,h=a.request,Pace.running||aw.restartOnRequestAfter===!1&&"force"!==aq(g)?void 0:(j=arguments,k=aw.restartOnRequestAfter||0,"boolean"==typeof k&&(k=0),setTimeout(function(){var d,n,m,l,f,e;if(d="socket"===g?h.readyState<2:0<(l=h.readyState)&&4>l){for(Pace.restart(),f=Pace.sources,e=[],n=0,m=f.length;m>n;n++){if(ap=f[n],ap instanceof aY){ap.watch.apply(ap,j);break}e.push(void 0)}return e}},k))}),aY=function(){function b(){var c=this;this.elements=[],aB().on("request",function(){return c.watch.apply(c,arguments)})}return b.prototype.watch=function(f){var e,h,g;return g=f.type,e=f.request,h="socket"===g?new aM(e):new aL(e),this.elements.push(h)},b}(),aL=function(){function b(k){var j,q,p,o,n,m,l=this;if(this.progress=0,null!=window.ProgressEvent){for(q=null,k.addEventListener("progress",function(c){return l.progress=c.lengthComputable?100*c.loaded/c.total:l.progress+(100-l.progress)/2}),m=["load","abort","timeout","error"],p=0,o=m.length;o>p;p++){j=m[p],k.addEventListener(j,function(){return l.progress=100})}}else{n=k.onreadystatechange,k.onreadystatechange=function(){var a;return 0===(a=k.readyState)||4===a?l.progress=100:3===k.readyState&&(l.progress=50),"function"==typeof n?n.apply(null,arguments):void 0}}}return b}(),aM=function(){function b(h){var g,m,l,k,j=this;for(this.progress=0,k=["error","open"],m=0,l=k.length;l>m;m++){g=k[m],h.addEventListener(g,function(){return j.progress=100})}}return b}(),aV=function(){function b(g){var e,k,j,h;for(null==g&&(g={}),this.elements=[],null==g.selectors&&(g.selectors=[]),h=g.selectors,k=0,j=h.length;j>k;k++){e=h[k],this.elements.push(new aU(e))}}return b}(),aU=function(){function b(c){this.selector=c,this.progress=0,this.check()}return b.prototype.check=function(){var c=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return c.check()},aw.elements.checkInterval)},b.prototype.done=function(){return this.progress=100},b}(),aW=function(){function b(){var e,d,f=this;this.progress=null!=(d=this.states[document.readyState])?d:100,e=document.onreadystatechange,document.onreadystatechange=function(){return null!=f.states[document.readyState]&&(f.progress=f.states[document.readyState]),"function"==typeof e?e.apply(null,arguments):void 0}}return b.prototype.states={loading:0,interactive:50,complete:100},b}(),aT=function(){function b(){var h,g,m,l,k,j=this;this.progress=0,h=0,k=[],l=0,m=ax(),g=setInterval(function(){var a;return a=ax()-m-50,m=ax(),k.push(a),k.length>aw.eventLag.sampleCount&&k.shift(),h=aJ(k),++l>=aw.eventLag.minSamples&&h<aw.eventLag.lagThreshold?(j.progress=100,clearInterval(g)):j.progress=100*(3/(h+3))},50)}return b}(),aN=function(){function b(c){this.source=c,this.last=this.sinceLastUpdate=0,this.rate=aw.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=au(this.source,"progress"))}return b.prototype.tick=function(e,d){var f;return null==d&&(d=au(this.source,"progress")),d>=100&&(this.done=!0),d===this.last?this.sinceLastUpdate+=e:(this.sinceLastUpdate&&(this.rate=(d-this.last)/this.sinceLastUpdate),this.catchup=(d-this.progress)/aw.catchupTime,this.sinceLastUpdate=0,this.last=d),d>this.progress&&(this.progress+=this.catchup*e),f=1-Math.pow(this.progress/100,aw.easeFactor),this.progress+=f*this.rate*e,this.progress=Math.min(this.lastProgress+aw.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},b}(),ao=null,ar=null,aI=null,an=null,aK=null,aH=null,Pace.running=!1,aA=function(){return aw.restartOnPushState?Pace.restart():void 0},null!=window.history.pushState&&(ag=window.history.pushState,window.history.pushState=function(){return aA(),ag.apply(window.history,arguments)}),null!=window.history.replaceState&&(ad=window.history.replaceState,window.history.replaceState=function(){return aA(),ad.apply(window.history,arguments)}),aO={ajax:aY,elements:aV,document:aW,eventLag:aT},(ay=function(){var b,p,o,n,m,l,k,j;for(Pace.sources=ao=[],l=["ajax","elements","document","eventLag"],p=0,n=l.length;n>p;p++){b=l[p],aw[b]!==!1&&ao.push(new aO[b](aw[b]))}for(j=null!=(k=aw.extraSources)?k:[],o=0,m=j.length;m>o;o++){ap=j[o],ao.push(new ap(aw))}return Pace.bar=aI=new aX,ar=[],an=new aN})(),Pace.stop=function(){return Pace.trigger("stop"),Pace.running=!1,aI.destroy(),aH=!0,null!=aK&&("function"==typeof aG&&aG(aK),aK=null),ay()},Pace.restart=function(){return Pace.trigger("restart"),Pace.stop(),Pace.start()},Pace.go=function(){return Pace.running=!0,aI.render(),aH=!1,aK=at(function(L,K){var J,I,H,G,F,E,D,C,B,A,z,y,x,w,r,q,l;for(C=100-aI.progress,I=y=0,H=!0,E=x=0,r=ao.length;r>x;E=++x){for(ap=ao[E],A=null!=ar[E]?ar[E]:ar[E]=[],F=null!=(l=ap.elements)?l:[ap],D=w=0,q=F.length;q>w;D=++w){G=F[D],B=null!=A[D]?A[D]:A[D]=new aN(G),H&=B.done,B.done||(I++,y+=B.tick(L))}}return J=y/I,aI.update(an.tick(L,J)),z=ax(),aI.done()||H||aH?(aI.update(100),Pace.trigger("done"),setTimeout(function(){return aI.finish(),Pace.running=!1,Pace.trigger("hide")},Math.max(aw.ghostTime,Math.min(aw.minTime,ax()-z)))):K()})},Pace.start=function(d){aE(aw,d),Pace.running=!0;try{aI.render()}catch(c){aQ=c}return document.querySelector(".pace")?(Pace.trigger("start"),Pace.go()):setTimeout(Pace.start,50)},"function"==typeof define&&define.amd?define("theme-app",[],function(){return Pace}):"object"==typeof exports?module.exports=Pace:aw.startOnPageLoad&&Pace.start()}).call(this)});(function(a){a.fn.boxRefresh=function(d){var e=a.extend({trigger:".refresh-btn",source:"",onLoadStart:function(g){},onLoadDone:function(g){}},d);var c=a('<div class="overlay"></div><div class="loading-img"></div>');return this.each(function(){if(e.source===""){if(console){console.log("Please specify a source first - boxRefresh()")}return}var g=a(this);var h=g.find(e.trigger).first();h.click(function(j){j.preventDefault();f(g);g.find(".box-body").load(e.source,function(){b(g)})})});function f(g){g.append(c);e.onLoadStart.call(g)}function b(g){g.find(c).remove();e.onLoadDone.call(g)}}})(jQuery);(function(a){a.fn.tree=function(){return this.each(function(){var b=a(this).children("a").first();var d=a(this).children(".treeview-menu").first();var c=a(this).hasClass("active");if(c){d.show();b.children(".fa-angle-right").first().removeClass("fa-angle-right").addClass("fa-angle-down")}b.click(function(f){f.preventDefault();if(c){d.slideUp();c=false;b.children(".fa-angle-down").first().removeClass("fa-angle-down").addClass("fa-angle-right");b.parent("li").removeClass("active")}else{d.slideDown();c=true;b.children(".fa-angle-right").first().removeClass("fa-angle-right").addClass("fa-angle-down");b.parent("li").addClass("active")}});d.find("li > a").each(function(){var e=parseInt(a(this).css("margin-left"))+10;a(this).css({"margin-left":e+"px"})})})}}(jQuery));(function(a){a.fn.todolist=function(b){var c=a.extend({onCheck:function(d){},onUncheck:function(d){}},b);return this.each(function(){a("input",this).on("ifChecked",function(d){var e=a(this).parents("li").first();e.toggleClass("done");c.onCheck.call(e)});a("input",this).on("ifUnchecked",function(d){var e=a(this).parents("li").first();e.toggleClass("done");c.onUncheck.call(e)})})}}(jQuery));(function(a){jQuery.fn.center=function(b){if(b){b=this.parent()}else{b=window}this.css({position:"absolute",top:(((a(b).height()-this.outerHeight())/2)+a(b).scrollTop()+"px"),left:(((a(b).width()-this.outerWidth())/2)+a(b).scrollLeft()+"px")});return this}}(jQuery));(function(n,p,v){var x=n([]),s=n.resize=n.extend(n.resize,{}),o,l="setTimeout",m="resize",u=m+"-special-event",w="delay",r="throttleWindow";s[w]=250;s[r]=true;n.event.special[m]={setup:function(){if(!s[r]&&this[l]){return false}var a=n(this);x=x.add(a);n.data(this,u,{w:a.width(),h:a.height()});if(x.length===1){q()}},teardown:function(){if(!s[r]&&this[l]){return false}var a=n(this);x=x.not(a);a.removeData(u);if(!x.length){clearTimeout(o)}},add:function(b){if(!s[r]&&this[l]){return false}var c;function a(d,h,g){var f=n(this),e=n.data(this,u);e.w=h!==v?h:f.width();e.h=g!==v?g:f.height();c.apply(this,arguments)}if(n.isFunction(b)){c=b;return a}else{c=b.handler;b.handler=a}}};function q(){o=p[l](function(){x.each(function(){var d=n(this),a=d.width(),b=d.height(),c=n.data(this,u);if(a!==c.w||b!==c.h){d.trigger(m,[c.w=a,c.h=b])}});q()},s[w])}})(jQuery,this);
/*!
 * SlimScroll https://github.com/rochal/jQuery-slimScroll
 * =======================================================
 * 
 * Copyright (c) 2011 Piotr Rochala (http://rocha.la) Dual licensed under the MIT 
 */
(function(a){jQuery.fn.extend({slimScroll:function(c){var b=a.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:0.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"0px",railBorderRadius:"0px"},c);this.each(function(){function H(g){if(E){g=g||window.event;var k=0;g.wheelDelta&&(k=-g.wheelDelta/120);g.detail&&(k=g.detail/3);a(g.target||g.srcTarget||g.srcElement).closest("."+b.wrapperClass).is(S.parent())&&N(k,!0);g.preventDefault&&!P&&g.preventDefault();P||(g.returnValue=!1)}}function N(p,m,k){P=!1;var n=p,l=S.outerHeight()-R.outerHeight();m&&(n=parseInt(R.css("top"))+p*parseInt(b.wheelStep)/100*R.outerHeight(),n=Math.min(Math.max(n,0),l),n=0<p?Math.ceil(n):Math.floor(n),R.css({top:n+"px"}));O=parseInt(R.css("top"))/(S.outerHeight()-R.outerHeight());n=O*(S[0].scrollHeight-S.outerHeight());k&&(n=p,p=n/S[0].scrollHeight*S.outerHeight(),p=Math.min(Math.max(p,0),l),R.css({top:p+"px"}));S.scrollTop(n);S.trigger("slimscrolling",~~n);j();L()}function G(){window.addEventListener?(this.addEventListener("DOMMouseScroll",H,!1),this.addEventListener("mousewheel",H,!1),this.addEventListener("MozMousePixelScroll",H,!1)):document.attachEvent("onmousewheel",H)}function h(){o=Math.max(S.outerHeight()/S[0].scrollHeight*S.outerHeight(),F);R.css({height:o+"px"});var g=o==S.outerHeight()?"none":"block";R.css({display:g})}function j(){h();clearTimeout(K);O==~~O?(P=b.allowPageScroll,J!=O&&S.trigger("slimscroll",0==~~O?"top":"bottom")):P=!1;J=O;o>=S.outerHeight()?P=!0:(R.stop(!0,!0).fadeIn("fast"),b.railVisible&&Q.stop(!0,!0).fadeIn("fast"))}function L(){b.alwaysVisible||(K=setTimeout(function(){b.disableFadeOut&&E||(f||e)||(R.fadeOut("slow"),Q.fadeOut("slow"))},1000))}var E,f,e,K,d,o,O,J,F=30,P=!1,S=a(this);if(S.parent().hasClass(b.wrapperClass)){var M=S.scrollTop(),R=S.parent().find("."+b.barClass),Q=S.parent().find("."+b.railClass);h();if(a.isPlainObject(c)){if("height" in c&&"auto"==c.height){S.parent().css("height","auto");S.css("height","auto");var I=S.parent().parent().height();S.parent().css("height",I);S.css("height",I)}if("scrollTo" in c){M=parseInt(b.scrollTo)}else{if("scrollBy" in c){M+=parseInt(b.scrollBy)}else{if("destroy" in c){R.remove();Q.remove();S.unwrap();return}}}N(M,!1,!0)}}else{b.height="auto"==b.height?S.parent().height():b.height;M=a("<div></div>").addClass(b.wrapperClass).css({position:"relative",overflow:"hidden",width:b.width,height:b.height});S.css({overflow:"hidden",width:b.width,height:b.height});var Q=a("<div></div>").addClass(b.railClass).css({width:b.size,height:"100%",position:"absolute",top:0,display:b.alwaysVisible&&b.railVisible?"block":"none","border-radius":b.railBorderRadius,background:b.railColor,opacity:b.railOpacity,zIndex:90}),R=a("<div></div>").addClass(b.barClass).css({background:b.color,width:b.size,position:"absolute",top:0,opacity:b.opacity,display:b.alwaysVisible?"block":"none","border-radius":b.borderRadius,BorderRadius:b.borderRadius,MozBorderRadius:b.borderRadius,WebkitBorderRadius:b.borderRadius,zIndex:99}),I="right"==b.position?{right:b.distance}:{left:b.distance};Q.css(I);R.css(I);S.wrap(M);S.parent().append(R);S.parent().append(Q);b.railDraggable&&R.bind("mousedown",function(k){var g=a(document);e=!0;t=parseFloat(R.css("top"));pageY=k.pageY;g.bind("mousemove.slimscroll",function(l){currTop=t+l.pageY-pageY;R.css("top",currTop);N(0,R.position().top,!1)});g.bind("mouseup.slimscroll",function(l){e=!1;L();g.unbind(".slimscroll")});return !1}).bind("selectstart.slimscroll",function(g){g.stopPropagation();g.preventDefault();return !1});Q.hover(function(){j()},function(){L()});R.hover(function(){f=!0},function(){f=!1});S.hover(function(){E=!0;j();L()},function(){E=!1;L()});S.bind("touchstart",function(k,g){k.originalEvent.touches.length&&(d=k.originalEvent.touches[0].pageY)});S.bind("touchmove",function(g){P||g.originalEvent.preventDefault();g.originalEvent.touches.length&&(N((d-g.originalEvent.touches[0].pageY)/b.touchScrollStep,!0),d=g.originalEvent.touches[0].pageY)});h();"bottom"===b.start?(R.css({top:S.outerHeight()-R.outerHeight()}),N(0,!0)):"top"!==b.start&&(N(a(b.start).position().top,null,!0),b.alwaysVisible||R.hide());G()}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);
/*! iCheck v1.0.1 by Damir Sultanov, http://git.io/arlzeA, MIT Licensed */
(function(W){function B(k,h,n){var p=k[0],m=/er/.test(n)?T:/bl/.test(n)?O:U,l=n==j?{checked:p[U],disabled:p[O],indeterminate:"true"==k.attr(T)||"false"==k.attr(o)}:p[m];if(/^(ch|di|in)/.test(n)&&!l){P(k,m)}else{if(/^(un|en|de)/.test(n)&&l){N(k,m)}else{if(n==j){for(m in l){l[m]?P(k,m,!0):N(k,m,!0)}}else{if(!h||"toggle"==n){if(!h){k[R]("ifClicked")}l?p[S]!==C&&N(k,m):P(k,m)}}}}}function P(z,y,v){var w=z[0],u=z.parent(),q=y==U,n=y==T,m=y==O,x=n?o:q?K:"enabled",l=V(z,x+g(w[S])),s=V(z,y+g(w[S]));if(!0!==w[y]){if(!v&&y==U&&w[S]==C&&w.name){var k=z.closest("form"),h='input[name="'+w.name+'"]',h=k.length?k.find(h):W(h);h.each(function(){this!==w&&W(this).data(Q)&&N(W(this),y)})}n?(w[y]=!0,w[U]&&N(z,U,"force")):(v||(w[y]=!0),q&&w[T]&&N(z,T,!1));b(z,q,y,v)}w[O]&&V(z,e,!0)&&u.find("."+f).css(e,"default");u[A](s||V(z,y)||"");m?u.attr("aria-disabled","true"):u.attr("aria-checked",n?"mixed":"true");u[c](l||V(z,x)||"")}function N(y,x,v){var w=y[0],s=y.parent(),n=x==U,m=x==T,k=x==O,l=m?o:n?K:"enabled",D=V(y,l+g(w[S])),z=V(y,x+g(w[S]));if(!1!==w[x]){if(m||!v||"force"==v){w[x]=!1}b(y,n,l,v)}!w[O]&&V(y,e,!0)&&s.find("."+f).css(e,"pointer");s[c](z||V(y,x)||"");k?s.attr("aria-disabled","false"):s.attr("aria-checked","false");s[A](D||V(y,l)||"")}function a(k,h){if(k.data(Q)){k.parent().html(k.attr("style",k.data(Q).s||""));if(h){k[R](h)}k.off(".i").unwrap();W(r+'[for="'+k[0].id+'"]').add(k.closest(r)).off(".i")}}function V(k,h,l){if(k.data(Q)){return k.data(Q).o[h+(l?"":"Class")]}}function g(h){return h.charAt(0).toUpperCase()+h.slice(1)}function b(k,h,l,m){if(!m){if(h){k[R]("ifToggled")}k[R]("ifChanged")[R]("if"+g(l))}}var Q="iCheck",f=Q+"-helper",C="radio",U="checked",K="un"+U,O="disabled",o="determinate",T="in"+o,j="update",S="type",A="addClass",c="removeClass",R="trigger",r="label",e="cursor",d=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini|silk/i.test(navigator.userAgent);W.fn[Q]=function(E,z){var s='input[type="checkbox"], input[type="'+C+'"]',u=W(),q=function(k){k.each(function(){var w=W(this);u=w.is(s)?u.add(w):u.add(w.find(s))})};if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(E)){return E=E.toLowerCase(),q(this),u.each(function(){var k=W(this);"destroy"==E?a(k,"ifDestroyed"):B(k,!0,E);W.isFunction(z)&&z()})}if("object"!=typeof E&&E){return this}var p=W.extend({checkedClass:U,disabledClass:O,indeterminateClass:T,labelHover:!0,aria:!1},E),n=p.handle,m=p.hoverClass||"hover",D=p.focusClass||"focus",F=p.activeClass||"active",v=!!p.labelHover,l=p.labelHoverClass||"hover",h=(""+p.increaseArea).replace("%","")|0;if("checkbox"==n||n==C){s='input[type="'+n+'"]'}-50>h&&(h=-50);q(this);return u.each(function(){var M=W(this);a(M);var J=this,L=J.id,H=-h+"%",I=100+2*h+"%",I={position:"absolute",top:H,left:H,display:"block",width:I,height:I,margin:0,padding:0,background:"#fff",border:0,opacity:0},H=d?{position:"absolute",visibility:"hidden"}:h?I:{position:"absolute",opacity:0},y="checkbox"==J[S]?p.checkboxClass||"icheckbox":p.radioClass||"i"+C,x=W(r+'[for="'+L+'"]').add(M.closest(r)),w=!!p.aria,X=Q+"-"+Math.random().toString(36).replace("0.",""),G='<div class="'+y+'" '+(w?'role="'+J[S]+'" ':"");x.length&&w&&x.each(function(){G+='aria-labelledby="';this.id?G+=this.id:(this.id=X,G+=X);G+='"'});G=M.wrap(G+"/>")[R]("ifCreated").parent().append(p.insert);I=W('<ins class="'+f+'"/>').css(I).appendTo(G);M.data(Q,{o:p,s:M.attr("style")}).css(H);p.inheritClass&&G[A](J.className||"");p.inheritID&&L&&G.attr("id",Q+"-"+L);"static"==G.css("position")&&G.css("position","relative");B(M,!0,j);if(x.length){x.on("click.i mouseover.i mouseout.i touchbegin.i touchend.i",function(k){var Z=k[S],Y=W(this);if(!J[O]){if("click"==Z){if(W(k.target).is("a")){return}B(M,!1,!0)}else{v&&(/ut|nd/.test(Z)?(G[c](m),Y[c](l)):(G[A](m),Y[A](l)))}if(d){k.stopPropagation()}else{return !1}}})}M.on("click.i focus.i blur.i keyup.i keydown.i keypress.i",function(k){var Y=k[S];k=k.keyCode;if("click"==Y){return !1}if("keydown"==Y&&32==k){return J[S]==C&&J[U]||(J[U]?N(M,U):P(M,U)),!1}if("keyup"==Y&&J[S]==C){!J[U]&&P(M,U)}else{if(/us|ur/.test(Y)){G["blur"==Y?c:A](D)}}});I.on("click mousedown mouseup mouseover mouseout touchbegin.i touchend.i",function(k){var Z=k[S],Y=/wn|up/.test(Z)?F:m;if(!J[O]){if("click"==Z){B(M,!1,!0)}else{if(/wn|er|in/.test(Z)){G[A](Y)}else{G[c](Y+" "+F)}if(x.length&&v&&Y==m){x[/ut|nd/.test(Z)?c:A](l)}}if(d){k.stopPropagation()}else{return !1}}})})}})(window.jQuery||window.Zepto);$(function(){if($("#page-js").text().indexOf("baseline-landing")>-1){$("#what-to-expect-button").click(function(){$("#what-to-expect-text").toggleClass("hidden");if(!$("#about-the-science-text").hasClass("hidden")){$("#about-the-science-text").addClass("hidden")}});$("#about-the-science-button").click(function(){$("#about-the-science-text").toggleClass("hidden");if(!$("#what-to-expect-text").hasClass("hidden")){$("#what-to-expect-text").addClass("hidden")}})}});$(function(){if($("#page-js").text().indexOf("compare-content")>-1){var b=function(){$(this).removeClass("btn-success").addClass("btn-default")};var a=function(){$(this).removeClass("btn-default").addClass("btn-success")};$(".toggle-preference-button").click(function(){$(".toggle-preference-button").each(b);$(this).each(a)});$("#next-step-button").click(function(){var c=$(this).closest(".box-body");var d=$(".btn-success",c).data("character");var e=$(this).data("user");$.ajax({type:"POST",url:"/personalize/comparison",data:"userId="+e+"&preferenceCharacter="+d})})}});$(function(){if($("#page-js").text().indexOf("content-approval")>-1){var b=$(".content-approval-sidebar li");$(b).click(function(){var d=$(this).attr("id");$(b).removeClass("selected");$(this).addClass("selected");$(".content-approval-content-display").addClass("hidden");var c=$("#"+d+"-viewer");if(!$(c).hasClass("wysihtml5-activated")){$(".wysihtml5-beam-me-up-later",c).wysihtml5()}$(c).removeClass("hidden").addClass("wysihtml5-activated")});var a=$(".content-approval-action-buttons");$(".content-approval-action-button").click(function(){var g=$(this).data("action");var m=$(this).data("type");var c=$(this).parent().data("uuid");if(g=="save"){var l=$(this).closest(".content-approval-content-display");var k=$("[name=title]",l).val();var h=$("[name=body]",l).val();var j=$("[name=solution]",l).val();var n=$("[name=tags]",l).val();$.ajax({type:"POST",url:"/admin/content-approval",data:"uuid="+c+"&action="+g+"&title="+k+"&body="+h+"&solution="+j+"&tags="+n})}else{$.ajax({type:"POST",url:"/admin/content-approval",data:"uuid="+c+"&action="+g+"&contentType="+m})}var f="";if($(this).hasClass("btn-success")){f="green"}else{if($(this).hasClass("btn-warning")){f="yellow"}else{if($(this).hasClass("btn-primary")){f="light-blue"}else{if($(this).hasClass("btn-info")){f="aqua"}else{if($(this).hasClass("btn-danger")){f="red"}}}}}$(this).closest(".content-approval-action-buttons").children("button").removeClass().addClass("btn").addClass("btn-default").addClass("disabled");$(this).removeClass("btn-default").addClass("bg-"+f).addClass("disabled");var d=$(this).closest(".content-approval-content-display").attr("id");var e="#"+d.substring(0,d.length-7);$(e).addClass("bg-"+f)})}});$(function(){if($("#page-js").text().indexOf("explore")>-1){$(".content-rotating").each(function(){var d=this;var c=$(".btn-group",this);var b=$(".btn",c);var e=1;$(".row",this).each(function(){var f=this;var j=$(this).attr("id");var g=j+"-button";var h=$(b).clone().appendTo(c);$(h).attr("id",g).removeClass("hidden").text(""+e);e=e+1;$(h).click(function(){$(".row",d).addClass("hidden");$(f).removeClass("hidden");$(".btn",c).removeClass("btn-primary").addClass("btn-default");$(this).addClass("btn-primary").removeClass("btn-default")})});$(b).remove()});var a=function(){var b=$(this).data("user");var c=$(this).data("content");var d=$(this).data("action");$.ajax({type:"POST",url:"/bookmark",data:"userId="+b+"&contentUuid="+c+"&action="+d});if(d==="add"){$(this).data("action","remove");$("i",this).removeClass("fa-bookmark-o").addClass("fa-bookmark")}else{$(this).data("action","add");$("i",this).removeClass("fa-bookmark").addClass("fa-bookmark-o")}};$(".toggle-bookmark-button").click(a)}});$(function(){if($("#page-js").text().indexOf("lpg")>-1){var c='<li><button class="btn btn-default fa fa-magic lpg-toggle" title="Insert Math Equations" type="button"></button></li>';$(".wysihtml5-toolbar").append(c);$(".lpg-toggle").click(function(){$(".lpg-toggle").each(function(){if($(this).hasClass("btn-default")){$(this).removeClass("btn-default").addClass("btn-success")}else{if($(this).hasClass("btn-success")){$(this).removeClass("btn-success").addClass("btn-default")}}});var d=$(this).offset();d.left=d.left+45;$(".latex-playground").toggleClass("hidden").offset(d)});$(".latex-playground").draggable();var b=$(".lpg-input-box");var a=function(e){var d=$("#lpg-latex-line-select").val();if(d=="inline"){e="\\("+e+"\\)"}else{e="$$"+e+"$$"}$("#lpg-result-box").empty().text(e);MathJax.Hub.Queue(["Typeset",MathJax.Hub,"lpg-result-box"])};$(".lpg-button").click(function(){var d=$(this).data("tex");var e=$(b).val()+d;$(b).val(e);a(e)});$(".lpg-input-box").change(function(){var d=$(this).val();a(d)});$(".lpg-insert-into-body").click(function(){var e=$("#body-editor").parent().find("iframe");var d=$(".wysihtml5-editor",e.contents());var j=$(".lpg-input-box").first().val();var h=$(d).text();if(h==$("#body-editor").attr("placeholder")){h=""}var g=$("#lpg-latex-line-select").val();if(g=="inline"){j=" \\( "+j+" \\) "}else{j=" $$ "+j+" $$ "}var f=h+" "+j;$(d).text(f)});$(".lpg-insert-into-solution").click(function(){var e=$("#solution-editor").parent().find("iframe");var d=$(".wysihtml5-editor",e.contents());var j=$(".lpg-input-box").first().val();var h=$(d).text();if(h==$("#solution-editor").attr("placeholder")){h=""}var g=$("#lpg-latex-line-select").val();if(g=="inline"){j=" \\( "+j+" \\) "}else{j=" $$ "+j+" $$ "}var f=h+" "+j;$(d).text(f)});$(".lpg-instructions-toggle").click(function(){if($(this).hasClass("btn-default")){$(this).addClass("btn-primary").removeClass("btn-default");$(".lpg-instructions").removeClass("hidden")}else{$(this).addClass("btn-default").removeClass("btn-primary");$(".lpg-instructions").addClass("hidden")}})}});$(function(){if($("#page-js").text().indexOf("personalize-difficulty")>-1){$(".btn-group.difficulty-rating-buttons").each(function(){var b=$(this).data("user");var c=$(this).data("uuid");var a=this;$("button",this).click(function(){$("button",a).removeClass("btn-success").addClass("btn-default");$(this).removeClass("btn-default").addClass("btn-success")})})}});$(function(){if($("#page-js").text().indexOf("personalize-interests")>-1){var a=function(){var c=$(this).data("interest");var b=$(this).data("user");if($(this).hasClass("btn-default")){$(this).removeClass("btn-default").addClass("btn-success")}else{$(this).removeClass("btn-success").addClass("btn-default")}};$(".toggle-interest-button").click(a);$("#next-step-button").click(function(){var c=$(this).data("user");var b=[];$(".toggle-interest-button.btn-success").each(function(){var e=$(this).data("interest");b.push(e)});var d=[];$(".original-interest").each(function(){if(!$(this).hasClass("btn-success")){var e=$(this).data("interest");d.push(e)}});$.ajax({type:"POST",url:"/personalize/interests",data:"userId="+c+"&add-interests="+b+"&remove-interests="+d})})}});$(function(){if($("#page-js").text().indexOf("practiceProblem")>-1){var a=function(){console.log("This shouldn't be run!")};var b=function(){var c=$(this).data("user");var d=$(this).data("content");var e="add";$.ajax({type:"POST",url:"/bookmark",data:"userId="+c+"&contentUuid="+d+"&action="+e});$(this).unbind();$("a",this).text("Un-Bookmark Problem");$(this).click(a)};a=function(){var c=$(this).data("user");var d=$(this).data("content");var e="remove";$.ajax({type:"POST",url:"/bookmark",data:"userId="+c+"&contentUuid="+d+"&action="+e});$(this).unbind();$("a",this).text("Bookmark Problem");$(this).click(b)};$(".add-bookmark-button").click(b);$(".remove-bookmark-button").click(a);$(".peek-button").click(function(){var e=this;var d=$(this).closest(".panel");var c=$(".panel-collapse",d);var g={display:"block","max-height":"50px",overflow:"hidden"};$(".box-title > a",d).click(function(){$(e).remove();$(c).removeAttr("style");$(this).off()});var f=50;$(c).css(g);$(this).off();$(this).click(function(){f=f+50;var h={"max-height":f+"px"};$(c).css(h);if($(c).height()<f){$(c).removeAttr("style").addClass("in");$(this).remove()}})})}});$(function(){if($("#page-js").text().indexOf("practiceProblemCreation")>-1){$("#tags-input").tagsInput({width:"100%",height:"auto",defaultText:"To Add Tag, Press Enter",removeWithBackspace:true})}});$(function(){if($("#page-js").text().indexOf("private-profile")>-1){$("#email-pref-submit").click(function(){$(this).attr("disabled","disabled");var d=$(this).closest("form");var c=$("#email-pref-reply",d).val();var b=$("#email-pref-karma",d).val();var e=$("#email-pref-recommend",d).val();var a=$(d).data("user");$.ajax({type:"POST",url:"/change-email-preferences",data:"userId="+a+"&emailReply="+c+"&emailKarma="+b+"&emailRecommend="+e});$(this).val("Changed!").addClass("btn-success").removeClass("btn-primary")});$("#change-username-button").click(function(){$(this).attr("disabled","disabled");var c=$(this).closest("form");var a=$("#edit-user-name",c).val();var b=$(c).data("user");$.ajax({type:"POST",url:"/change-user-name",data:"userId="+b+"&edit-username="+a});$(this).val("Changed!").addClass("btn-success").removeClass("btn-primary")});$("#profile-picture-upload").change(function(){var a=$("#profile-picture-upload").val();if(a.length>0){$("#profile-picture-upload-button").prop("disabled",false)}else{$("#profile-picture-upload-button").prop("disabled",true)}});$(".remove-bookmark-button").click(function(){var a=$(this).data("user");var b=$(this).data("content");var c="remove";$.ajax({type:"POST",url:"/bookmark",data:"userId="+a+"&contentUuid="+b+"&action="+c})});$(".remove-notification-button").click(function(){var a=$(this).data("user");var b=$(this).data("uuid");var c="remove";$.ajax({type:"POST",url:"/remove-notification",data:"userId="+a+"&uuid="+b})})}});$(function(){if($("#page-js").text().indexOf("publicProfile")>-1){var a=function(){var b=$(this).data("user");var c=$(this).data("content");var d=$(this).data("action");$.ajax({type:"POST",url:"/bookmark",data:"userId="+b+"&contentUuid="+c+"&action="+d});if(d==="add"){$(this).data("action","remove");$("i",this).removeClass("fa-bookmark-o").addClass("fa-bookmark")}else{$(this).data("action","add");$("i",this).removeClass("fa-bookmark").addClass("fa-bookmark-o")}};$(".toggle-bookmark-button").click(a)}});$(function(){if($("#page-js").text().indexOf("question")>-1){var a=function(){console.log("This shouldn't be run!")};var b=function(){var c=$(this).data("user");var d=$(this).data("content");var e="add";$.ajax({type:"POST",url:"/bookmark",data:"userId="+c+"&contentUuid="+d+"&action="+e});$(this).unbind();$("a",this).text("Un-Bookmark Problem");$(this).click(a)};a=function(){var c=$(this).data("user");var d=$(this).data("content");var e="remove";$.ajax({type:"POST",url:"/bookmark",data:"userId="+c+"&contentUuid="+d+"&action="+e});$(this).unbind();$("a",this).text("Bookmark Problem");$(this).click(b)};$(".add-bookmark-button").click(b);$(".remove-bookmark-button").click(a)}});$(function(){if($("#page-js").text().indexOf("rating-system")>-1){$(".rating-system-horizontal").each(function(){var d=$(".submit-rating",this);var g=$(this).data("uuid");var c=$(this).data("user");var e=$("[name=helpfulness]",this);var b=$("[name=difficulty]",this);var f=$("[name=quality]",this);$(d).click(function(){var j=$(e).val();var l=$(b).val();var k=$(f).val();$.ajax({type:"POST",url:"/rating/submit",data:"userId="+c+"&contentUuid="+g+"&helpfulness="+j+"&difficulty="+l+"&quality="+k,success:function(h){$(d).removeClass("btn-default").addClass("btn-success").text("Successfully Rated").addClass("disabled").unbind();$(e).trigger("configure",{readOnly:true});$(b).trigger("configure",{readOnly:true});$(f).trigger("configure",{readOnly:true})}})})});var a=$(".rating-instructions > .info-button");$(a).click(function(){var b=$(this).closest(".rating-system-horizontal .rating-instructions");$(b).toggleClass("no-height")});$("#tags-input-bar").tagsInput({width:"100%",height:"auto",defaultText:"Type Tags Here",removeWithBackspace:true})}});$(function(){if($("#page-js").text().indexOf("recommendations")>-1){var a=function(){var f=$(this).data("user");var g=$(this).data("content");var h=$(this).data("action");$.ajax({type:"POST",url:"/bookmark",data:"userId="+f+"&contentUuid="+g+"&action="+h});if(h==="add"){$(this).data("action","remove");$(".fa",this).removeClass("fa-bookmark-o").addClass("fa-bookmark")}else{$(this).data("action","add");$(".fa",this).removeClass("fa-bookmark").addClass("fa-bookmark-o")}};$(".toggle-bookmark-button").click(a);var d=function(){var f=$(this).data("user");var g=$(this).data("content");var h=$(this).data("action");$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&contentUuid="+g+"&action="+h});$(this).addClass("hovered");var j=$(this).parent(".alert").addClass("fading");setTimeout(function(){$(j).remove()},1200)};$(".hide-recommendation-button").click(d);var b=function(){var g=$(".fa",this).hasClass("fa-thumbs-o-down");var k=$(".fa",this).hasClass("fa-thumbs-down");var f=$(this).data("user");var h=$(this).data("content");var j=$(this).data("action");if(g){$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&contentUuid="+h+"&action="+j});$(".fa",this).addClass("fa-thumbs-down").removeClass("fa-thumbs-o-down");$(".interested-button > .fa",$(this).parent()).removeClass("fa-thumbs-up").addClass("fa-thumbs-o-up")}else{if(k){j="unmark-"+j;$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&contentUuid="+h+"&action="+j});$(".fa",this).removeClass("fa-thumbs-down").addClass("fa-thumbs-o-down")}}};$(".disinterested-button").click(b);var e=function(){var g=$(".fa",this).hasClass("fa-thumbs-o-up");var k=$(".fa",this).hasClass("fa-thumbs-up");var f=$(this).data("user");var h=$(this).data("content");var j=$(this).data("action");console.log(h);if(g){$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&contentUuid="+h+"&action="+j});$(".fa",this).addClass("fa-thumbs-up").removeClass("fa-thumbs-o-up");$(".disinterested-button > .fa",$(this).parent()).removeClass("fa-thumbs-down").addClass("fa-thumbs-o-down")}else{if(k){j="unmark-"+j;$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&contentUuid="+h+"&action="+j});$(".fa",this).removeClass("fa-thumbs-up").addClass("fa-thumbs-o-up")}}};$(".interested-button").click(e);var c=function(){var f=$(this).data("user");var g=$(this).data("action");$.ajax({type:"POST",url:"/recommendations",data:"userId="+f+"&action="+g});$(this).addClass("disabled");$(this).text("All Recommendations Unhidden");setTimeout(location.reload,500);window.location.reload()};$(".show-all-recommendations").click(c);$(".search-result-page").each(function(){var g=$(this).parent(".all-search-results");var h="#"+$(this).attr("id");var f=h+"-tab";$(f,g).click(function(){$(".search-result-page",g).each(function(){$(this).addClass("hidden")});$(h,g).removeClass("hidden");$(".result-page-tab",g).each(function(){$(this).removeClass("btn-success").addClass("btn-default")});$(this).removeClass("btn-default").addClass("btn-success")})})}});$(function(){if($("#page-js").text().indexOf("searchByTag")>-1){$("#tags-input").tagsInput({width:"100%",height:"auto",defaultText:"Type Tags Here",removeWithBackspace:true});var a=function(){var b=$(this).data("user");var c=$(this).data("content");var d=$(this).data("action");$.ajax({type:"POST",url:"/bookmark",data:"userId="+b+"&contentUuid="+c+"&action="+d});if(d==="add"){$(this).data("action","remove");$("i",this).removeClass("fa-bookmark-o").addClass("fa-bookmark")}else{$(this).data("action","add");$("i",this).removeClass("fa-bookmark").addClass("fa-bookmark-o")}};$(".toggle-bookmark-button").click(a);$(".search-result-page").each(function(){var c=$(this).parent(".box-body");var d="#"+$(this).attr("id");var b=d+"-tab";$(b,c).click(function(){$(".search-result-page",c).each(function(){$(this).addClass("hidden")});$(d,c).removeClass("hidden");$(".result-page-tab",c).each(function(){$(this).removeClass("selected")});$(this).addClass("selected")})});$(".add-recommended-tag").click(function(){var b=$(this).data("tag");var c=$("#tags-input");var d='<span id="'+b+'-recommended-tag-input" class="tag"><span>'+b+'&nbsp;&nbsp;</span><a href="#" title="Removing tag"></a></span>';$(c).val($(c).val()+","+b);$(d).insertBefore("#tags-input_tag");$("#"+b+"-recommended-tag-input > a").click(function(){console.log("WE MADE IT");$(this).parent().remove()});$(this).remove()})}});$(function(){if($("#page-js").text().indexOf("topic-display")>-1){var a=function(){var b=$(this).data("user");var c=$(this).data("content");var d=$(this).data("action");$.ajax({type:"POST",url:"/bookmark",data:"userId="+b+"&contentUuid="+c+"&action="+d});if(d==="add"){$(this).data("action","remove");$("i",this).removeClass("fa-bookmark-o").addClass("fa-bookmark")}else{$(this).data("action","add");$("i",this).removeClass("fa-bookmark").addClass("fa-bookmark-o")}};$(".toggle-bookmark-button").click(a)}});$(function(){if($("#page-js").text().indexOf("topic-selector")>-1){function c(k){$(".topic-selector-selected-below",k).removeClass("topic-selector-selected-below");$(".topic-selector-selected-above",k).removeClass("topic-selector-selected-above");$(".topic-selector-selected",k).removeClass("topic-selector-selected").removeClass("btn-success").addClass("btn-default")}function b(k){$("a",$(k).parent()).removeClass("topic-selector-selected-below").removeClass("topic-selector-selected-above")}function j(k){var l=false;$("a",$(k).parent()).each(function(){if(!l){if(this==k){l=true}else{$(this).addClass("topic-selector-selected-below")}}else{$(this).addClass("topic-selector-selected-above")}})}function d(k){var l=$(k).attr("id")+"-box";$("#"+l).addClass("hidden");$(".topic-selector-selected","#"+l).each(function(){d(this)});c($("#"+l))}function g(k){var l=$(".topic-selector-selected",k);d(l);$(l).removeClass("topic-selector-selected").addClass("btn-default").removeClass("btn-success");b(l)}function e(k){$("a.btn",k).click(function(){var m=$(this).attr("id");$(".no-dropdown").removeClass("no-dropdown");$("#ts-view-topic-button").addClass("hidden");if($(this).hasClass("topic-selector-selected")){g($(this).parent())}else{g($(this).parent());$(this).addClass("topic-selector-selected").removeClass("btn-default").addClass("btn-success");j(this);$(this).parent().removeClass("topic-selector-selected-above");if($(".sub-topics","#"+m+"-data").text().length>2){if($("#"+m+"-box").length==0){var l=parseInt(($(this).closest(".col-lg-3").attr("id")).substring(7));f(l+1,m)}$("#"+m+"-box").removeClass("hidden")}else{$(this).parent().addClass("no-dropdown")}a(m)}h()})}e("#topic-selector");function f(z,m){var q=$("#"+m+"-data");var w=$(".title",q).text();var l=$(".sub-topics",q).text().replace("[","").replace("]","").split(",");var n=$(".short-desc",q).text();var u=$(".long-desc",q).text();var y=$(".tags",q).text();var x=$("#ts-topic-box-template").clone().attr("id",m+"-box");$(".box-title",x).text(w);var v=$(".box-body",x);for(var o in l){var s=l[o].trim();var k=$(".title","#ts-"+s+"-data").text();var r=$("#ts-topic-box-button").clone().attr("id","ts-"+s).text(k);$(v).append(r)}e(v);var p=$("#ts-col-"+z);if(p.length==0){p=$("#ts-column-template").clone();$(p).attr("id","ts-col-"+z);$(p).removeClass("hidden");$("#ts-columns").append(p)}$(p).append(x)}function a(r){var o=$("#"+r+"-data");var q=$(".title",o).text();var n=$(".short-desc",o).text();var p=$(".long-desc",o).text();var m=$(".content-size",o).text();var l=$(".tags",o).text();var k=$("#ts-view-topic-button").attr("href","/topic/"+r.substr(3)).removeClass("hidden");if(parseInt(m)>0){$(k).text("View All "+m+" "+q+" Resources");$(k).removeClass("btn-success").addClass("btn-primary")}else{$(k).text("View All Subtopics of "+q);$(k).removeClass("btn-primary").addClass("btn-success")}}function h(){$(".ts-stashed-col","#ts-columns").removeClass("ts-stashed-col").removeClass("ts-last-stashed");var m=3;if(window.outerWidth>=1200){m=4}var l=0;$(".col-lg-3","#ts-columns").each(function(){var n=false;$(".box",this).each(function(){if(!$(this).hasClass("hidden")){n=true}});if(n){l=l+1}});if(l>m){for(var k=1;k<=l-m;k++){$("#ts-col-"+k,"#ts-columns").addClass("ts-stashed-col");if(k==l-m){$("#ts-col-"+k,"#ts-columns").addClass("ts-last-stashed")}}}}}});$(function(){if($("#page-js").text().indexOf("tutorial")>-1){$(".large-input-group-button").click(function(){var c=$("#tags-input").val();var b="/search/"+c;window.open(b,"_blank")});var a=$(".achievement-badge");$(a).click(function(){$(this).toggleClass("completed")});$(".fa-bookmark-o.toggle-me").click(function(){$(this).toggleClass("fa-bookmark-o").toggleClass("fa-bookmark")})}});